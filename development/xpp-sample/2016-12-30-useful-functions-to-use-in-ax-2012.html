<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-development/xpp-sample/2016-12-30-useful-functions-to-use-in-ax-2012/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Useful functions to use in AX 2012 | Automaly</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://automaly.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://automaly.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://automaly.github.io/development/xpp-sample/2016-12-30-useful-functions-to-use-in-ax-2012"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Useful functions to use in AX 2012 | Automaly"><meta data-rh="true" name="description" content="Useful functions to use in AX 2012"><meta data-rh="true" property="og:description" content="Useful functions to use in AX 2012"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://automaly.github.io/development/xpp-sample/2016-12-30-useful-functions-to-use-in-ax-2012"><link data-rh="true" rel="alternate" href="https://automaly.github.io/development/xpp-sample/2016-12-30-useful-functions-to-use-in-ax-2012" hreflang="en"><link data-rh="true" rel="alternate" href="https://automaly.github.io/development/xpp-sample/2016-12-30-useful-functions-to-use-in-ax-2012" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://GQN6ITS7PP-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Automaly RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Automaly Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","367316606","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=	GTM-NDZH42N8"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","\tGTM-NDZH42N8",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Automaly" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.87ecc9f7.css">
<script src="/assets/js/runtime~main.5d3ed917.js" defer="defer"></script>
<script src="/assets/js/main.4fe0ea8b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo2.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo2.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Automaly</b></a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/ms-learning/lab">MS Labs</a><a href="https://automaly.com/finopsnews/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">FO RSS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://dynamics365.github.io/erd/default.htm" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Dynamics AX 2012 ERD<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/Dynamics365/One-stop-Dynamics-365-Finance-Operations" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://automaly.com/blog/rss.xml" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">RSS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo2.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo2.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>Automaly</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">One-stop Dynamics 365 Finance Operations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/category/integration">Integration</a><button aria-label="Collapse sidebar category &#x27;Integration&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/integration/odata">OData - Data Entity</a><button aria-label="Expand sidebar category &#x27;OData - Data Entity&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/integration/business-event">Business event Overview</a><button aria-label="Expand sidebar category &#x27;Business event Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/integration/aif-integration-ax12">AIF Integration</a><button aria-label="Expand sidebar category &#x27;AIF Integration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/category/development">Development</a><button aria-label="Collapse sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/category/x">X++</a><button aria-label="Collapse sidebar category &#x27;X++&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2015-02-04-create-and-write-to-xml-file-in-dynamics-ax">Create and write to XML file in Dynamics AX</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2015-05-12-execute-stored-procedure-from-x-code">Execute Stored Procedure from X++ code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2015-05-13-execute-external-database-stored-procedure-from-x-code-using-odbc-connectivity">Execute external database Stored Procedure from X++ code using ODBC connectivity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2015-06-09-list-page-interaction-class">List Page Interaction Class</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2015-11-03-defaultVale-combobox-in-x">Set default value for a comboBox in Dynamics AX 2012 with X++</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2015-11-13-how-to-use-like-operator-in-querybuildrange">How to use &quot;LIKE&quot; operator in QueryBuildRange</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2015-12-30-how-to-use-operator-in-querybuildrange">How to use operator &quot;or&quot; in QueryBuildRange</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2016-01-17-how-to-verify-active-inventory-dimensions-on-an-item">How to verify active inventory dimensions on an item</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2016-07-05-create-record-in-dimensionattributevaluecombination-manually">Create record in DimensionAttributeValueCombination table manually.</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2016-11-08-understanding-modifedField-table-method-finops">Understanding modifedField() Table method in fDynamics 365 Finance Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2016-12-26-posting-cust-payment-journal-using-x++">Posting cust payment journal using X++ Dynamics AX 2012</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/development/xpp-sample/2016-12-30-useful-functions-to-use-in-ax-2012">Useful functions to use in AX 2012</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2017-01-01-Difference-between-QUERYFILTER-and-QUERYBUILDRANGE">Difference between QueryFilter and QueryBuildRrange</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2017-01-02-Recalculate-InventSum">Recalculate InventSum in Dynamics AX</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2017-01-02-using-methods-in-table-filters-query-ranges-in-dynamics-ax-2012">Using Methods in Table Filters &amp; Query Ranges in Dynamics AX 2012</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2017-01-10-Block-vendor-and-send-email-for-notification-in-Dynamics-AX">How to block vendor and send email for notification.</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2017-01-19-Overview-delete-action-in-Dyanmics-AX-2012">Overview delete action in Dyanmics AX 2012</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2017-03-29-How-to-create-main-menu-in-Dynamics-AX-2012">How to create main menu in Dynamics AX 2012</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2017-08-07-Exception-Handling-in-Dynamics-365-For-Finance-and-Operation">Exception Handling in Dynamics 365 For Finance and Operation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2020-01-25-create-po-confirm-receipt-post">Create Purchase Orders - Confirm - Product receipt - Post using X++ in Dynamics 365 Finance &amp; Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2022-10-27-how-to-get-d365-azure-blob-storage-str">How to get FinOps Azure storage blob connection string</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/development/xpp-sample/2022-10-28-Disable-editing-of-specific-financial-dimensions-on-form">Disable editing of specific financial dimensions on form</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/business-documents">Business documents</a><button aria-label="Expand sidebar category &#x27;Business documents&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/aot">AOT</a><button aria-label="Expand sidebar category &#x27;AOT&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/framework">Framework</a><button aria-label="Expand sidebar category &#x27;Framework&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/power-platform-integration">Power Platform Integration</a><button aria-label="Expand sidebar category &#x27;Power Platform Integration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/non-development">Non development</a><button aria-label="Expand sidebar category &#x27;Non development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/dynamics-365-certificate">Dynamics 365 Certificate</a><button aria-label="Expand sidebar category &#x27;Dynamics 365 Certificate&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/dynamics-ax-2012-archive">Dynamics AX 2012 Archive</a><button aria-label="Expand sidebar category &#x27;Dynamics AX 2012 Archive&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/development"><span itemprop="name">Development</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/x"><span itemprop="name">X++</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Useful functions to use in AX 2012</span><meta itemprop="position" content="3"></li></ul></nav><div class="theme-doc-markdown markdown"><header><h1>Useful functions to use in AX 2012</h1></header><p>Useful functions to use in AX 2012</p>
<div class="language-C# language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static container list2Con (List _list)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    container con;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ListEnumerator listEnum;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    listEnum = _list.getEnumerator();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    while (listEnum.moveNext())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        con += listEnum.current();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return con;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">///Creates a file named _file with the content specified in _content parameter.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">//See the class SysImportUtil class for file related functions like get temfolder,tempfilename..etc.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static void createFile(str _file, str _content)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #File</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    TextIo file = null;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    new FileIOPermission(_file, #io_write).assert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // BP Deviation Documented</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    file = new TextIo(_file, #io_write);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    file.write(_content);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    file.finalize();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">///Creates an XML file named _file with the content specified in _content parameter. If the XML file</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">///can&#x27;t be created then it will try to create a normal file by calling createFile method.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static void createXmlFile(str _file, str _content)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #File</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    XmlDocument document = null;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    try</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        document = XmlDocument::newXml(_content, false);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        new FileIOPermission(_file, #io_write).assert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // BP Deviation Documented</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        document.save(_file);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    catch</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        SysImportUtil::createFile(_file, _content);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">///Reads an XML file specified by _file parameter.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static str readXmlFile(str _file)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #File</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    XmlDocument file = null;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    try</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        new FileIOPermission(_file, #io_read).assert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // BP Deviation Documented</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        file = XmlDocument::newFile(_file);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        return file.xml();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    catch</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        return &#x27;&#x27;;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Opens Bing maps with the address.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;param name=&quot;_address&quot;&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// The address to map.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/param&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static void mapIt(LogisticsPostalAddress _address)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #DEFINE.MapURL(&#x27;http://maps.bing.com/default.aspx?where1=\%1&#x27;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #DEFINE.comma(&#x27;,&#x27;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #DEFINE.newLine(&#x27;\n&#x27;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str     address;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (_address)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        address = _address.Street + #comma +</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                  _address.City + #comma +</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                  _address.State + #comma +</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                  _address.ZipCode + #comma +</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                  _address.CountryRegionId;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // Replace the newline with comma</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        address = strReplace(address, #newline, #comma);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // URL encode</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        address = System.Web.HttpUtility::UrlEncode(address);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // Add the address to the URL</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        infolog.urlLookup(strFmt(#MapURL, address));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Function to get the list of Tables in AOT</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// In case the table is derived its parent i.e. base table is appended to it delimited by comma (,)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Output example</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// :Table1,Table1&#x27;s Base Table : Table2 : Table3 : Table4 , Table4&#x27;s Base Table</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">static str getAOTTables()</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    TreeNode            node;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    TreeNode            childNode;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    TreeNodeIterator    nodeIt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    FilePath            path;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    TableId             tableId;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Dictionary      dict = new Dictionary();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str parentName;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str fieldArr;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    path        = @&#x27;\Data dictionary\Tables&#x27;;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    node        = TreeNode::findNode(path);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    nodeIt      = node.AOTiterator();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    childNode   = nodeIt.next();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    fieldArr =&#x27;&#x27;;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    while(childNode)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        tableId = tableName2id(childNode.treeNodeName());</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        if ( !dict.tableObject(tableId).isTmp()  &amp;&amp; !dict.tableObject(tableId).isMap() &amp;&amp; !dict.tableObject(tableId).isView())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            parentName = RetailUtils::getAOTTableParentName(tableId);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            if (parentName)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                //Creating formated output , refer explaination and example on header</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                fieldArr = fieldArr + &#x27;:&#x27; + strUpr(childNode.treeNodeName()) + &quot;,&quot; + strUpr(parentName);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            else</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                fieldArr = fieldArr + &#x27;:&#x27; + strUpr(childNode.treeNodeName());</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        childNode = nodeIt.next();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return fieldArr;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// This method receives a table id and find the corresponding Base Table from AOT</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// This method takes care of Multilevel inheritence</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;param name=&quot;tableid&quot;&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// tableid of derived table.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/param&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Name of parent table.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">static str getAOTTableParentName(TableId tableid)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Dictionary  dict = new Dictionary();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    TableId parentId, temp;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str result;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    parentId = dict.tableObject(tableid).extends();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // Loop until reached to the table for whcih Extends property is not defined</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    while (parentId)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        temp = dict.tableObject(parentId).extends();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        if (temp)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            parentId = temp;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        else</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            break;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (parentId)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        result = tableId2name(parentId);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        result = &#x27;&#x27;;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return result;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Function to accepts a table name and returns all its field</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;param name=&quot;tableName&quot;&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Table name for which field are to be retreived.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/param&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Field are arranged in a : delimited string and passed back</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Fields are read from AOT structure and defaults field are manually added</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// as those are not present in the tree structure</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Example =  :Field1:Field2:Field3:Field4</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">static str getAOTTableFields(str tableName)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    TreeNode            node;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    TreeNode            childNode;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    TreeNodeIterator    nodeIt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    FilePath            path;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    TableId             tableId;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str fieldArr;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Dictionary      dict = new Dictionary();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    fieldArr = &#x27;&#x27;;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (!tableName)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        return fieldArr;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // Construct the path till table fields node</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    path        = @&#x27;\Data dictionary\Tables\\&#x27; + tableName + &#x27;\\Fields&#x27; ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    node        = TreeNode::findNode(path);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    nodeIt      = node.AOTiterator();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    childNode   = nodeIt.next();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    while(childNode)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        fieldArr =  fieldArr + &#x27;:&#x27; + strUpr(childNode.treeNodeName());</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        childNode = nodeIt.next();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    tableId = tableName2id(tableName);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (dict.tableObject(tableId).dataPrCompany())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        //Append the default Fields</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        fieldArr =  fieldArr + &#x27;:&#x27; + &#x27;DATAAREAID&#x27;;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (dict.tableObject(tableId).dataPerPartition())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        fieldArr =  fieldArr + &#x27;:&#x27; + &#x27;PARTITION&#x27;;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return fieldArr;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// get enum values to container</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">static void Enum2container(Args _args)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">   </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int         i = 0;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    DictEnum    dimCode;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    container   ret;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    dimCode = new DictEnum(enumnum(SysDimension));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    while(i &lt; dimCode.values())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        ret += dimCode.index2Name(i);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        i++;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    info(strfmt(&quot;%1&quot;,con2Str(ret)));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static boolean checkDateIsInPeriod(TransDate _transDate,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                                            PeriodCode  _periodCode = PeriodCode::Regular)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return BudgetTransactionManager::validateTransactionDate(_transDate);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// New method for returning ledgerperiod last date</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">static transDate findLastOpenPeriod(transdate _ledgerTransDate)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    FiscalCalendarRecId     fiscalCalendarRecId;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    fiscalCalendarRecId = Ledger::fiscalCalendar(CompanyInfo::find().RecId);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return FiscalCalendars::findLastDayofPeriod( fiscalCalendarRecId, _ledgerTransDate);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// New method for returning first open ledgerperiod first date</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">static transDate findFirstOpenPeriod(transdate _ledgerTransDate)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    FiscalCalendarRecId     fiscalCalendarRecId;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    fiscalCalendarRecId = Ledger::fiscalCalendar(CompanyInfo::find().RecId);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return FiscalCalendars::findFirstDayofPeriod( fiscalCalendarRecId, _ledgerTransDate);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">//Calculate Hash for the string.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static str CalculateHash(str tb)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str s;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ClrObject obj;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ClrObject md5;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Text.StringBuilder sBuilder;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ClrObject clrStr;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ClrObject clrStrObject;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Exception clrException;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Array resultByteArray;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int i;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int arrayLength ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    InteropPermission perm;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    perm = new InteropPermission(InteropKind::ClrInterop);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    perm.assert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    try</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        obj = System.Text.Encoding::get_ASCII().GetBytes(tb);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        md5 = System.Security.Cryptography.MD5::Create();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        resultByteArray = md5.ComputeHash(obj);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        //BP deviation documented</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        sBuilder = new System.Text.StringBuilder();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        arrayLength = resultByteArray.get_Length() ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // Loop through each byte of the hashed data</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // and format each one as a hexadecimal string.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        for (i = 0; i &lt;arrayLength; i++)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            clrStrObject = resultByteArray.GetValue(i);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            clrStr = clrStrObject.ToString(&#x27;x2&#x27;);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            sBuilder.Append(clrStr);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // Return the hexadecimal string.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        s = sBuilder.ToString();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    catch (Exception::CLRError)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        //BP deviation documented</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        clrException = CLRInterop::getLastException();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        s = clrException.get_Message();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        error(s);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        throw error(&quot;@SYS106158&quot;);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    CodeAccessPermission::revertAssert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return s;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">//Transforms xml to another format of xml using xslt.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static str transform(str aifXml, str xsltResourceName)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #define.XsltArgumentList(&quot;System.Xml.Xsl.XsltArgumentList&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #AOT</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ResourceNode resourceNode;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    TreeNode resourcesNode;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    container data;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str xsltString;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str doXml;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Xml.Xsl.XslCompiledTransform transform;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Text.StringBuilder           stringBuilder;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.IO.StringWriter              stringWriter;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.IO.StringReader              stringReader;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Xml.XmlTextReader            xmlTextReader;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.IO.StringReader              stringReaderForXslt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Xml.XmlTextReader            xmlTextReaderForXslt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Xml.Xsl.XsltArgumentList     xsltArguments;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.IDisposable                  disposableObj;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // Get the top Resource node in the AOT</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    resourcesNode = infolog.findNode(#ResourcesPath);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (resourcesNode)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // Get the XML string holding the data from the resource item</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        resourceNode = resourcesNode.AOTfindChild(xsltResourceName);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        if (resourceNode)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            resourceNode.AOTload();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            data = SysResource::getResourceNodeData(resourceNode);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            xsltString = conpeek(data, 1);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    try</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        //Local XSLT</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        transform = new System.Xml.Xsl.XslCompiledTransform();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        stringReaderForXslt = new System.IO.StringReader(xsltString);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        xmlTextReaderForXslt = new System.Xml.XmlTextReader(stringReaderForXslt);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        transform.Load(xmlTextReaderForXslt);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        //Transform the input AIF XML</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        stringReader = new System.IO.StringReader(aifXml);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        xmlTextReader = new System.Xml.XmlTextReader(stringReader);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        stringBuilder = new System.Text.StringBuilder();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        stringWriter = new System.IO.StringWriter(stringBuilder);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        xsltArguments = ClrInterop::Null(#XsltArgumentList);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        transform.Transform(xmlTextReader, xsltArguments, stringWriter);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        doXml = stringBuilder.ToString();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    catch (Exception::CLRError)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        throw Global::error(ClrInterop::getLastException().toString());</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (!ClrInterop::isNull(xmlTextReaderForXslt))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        disposableObj = xmlTextReaderForXslt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        disposableObj.Dispose();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (!ClrInterop::isNull(stringReaderForXslt))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        disposableObj = stringReaderForXslt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        disposableObj.Dispose();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (!ClrInterop::isNull(xmlTextReader))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        disposableObj = xmlTextReader;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        disposableObj.Dispose();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (!ClrInterop::isNull(stringReader))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        disposableObj = stringReader;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        disposableObj.Dispose();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (!ClrInterop::isNull(stringWriter))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        disposableObj = stringWriter;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        disposableObj.Dispose();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return doXml;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">//Converts from string to Time.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">static int str2Time(str 8 _timeStr)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int     time;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    time += str2int(substr(_timeStr,0,2)) * 3600;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    time += str2int(substr(_timeStr,4,2)) * 60;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    time += str2int(substr(_timeStr,7,2));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return time;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">//This function is used to get xml string from xml file.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">static public str getXMLstringFromFile(str _filepath)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str xmlstring=&#x27;&#x27;;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    XmlDocument document=new XmlDocument();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    document.load(_filepath);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    xmlstring=document.innerXml();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return xmlstring;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// this function is used to convert string to array.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static Array str2array(str _inputString, str _delimiter = &#x27;&quot;,&quot;&#x27;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    List            list        = AmcBankFunctions::strSplit(_inputString, _delimiter);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ListEnumerator  enumerator  = list.getEnumerator();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Array           a           = new Array(Types::String);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int             i           = 1;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str             tmpString;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (strLen(_inputString) == 0 || strScan(_inputString, _delimiter, 1, strLen(_inputString)) == 0)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        return a; // this is not a XTL record</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    enumerator.reset();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    while (enumerator.moveNext())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        tmpString = enumerator.current();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // Removes first substring&#x27;s preceding &quot; and last substring&#x27;s succeeding &quot;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        if (strLen(tmpString) &gt; 0)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            if (i == 1 &amp;&amp; tmpString)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                tmpString = subStr(tmpString, 2, strLen(tmpString));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            if (i == list.elements())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                tmpString = subStr(tmpString, 1, strLen(tmpString)-1);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        a.value(i, tmpString);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        i++;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return a;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">///     Prefixes a string with a parameter provided character</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;param name=&quot;inputString&quot;&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">///     The integer that is to be converted into a string</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/param&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;param name=&quot;outputStringLength&quot;&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">///     The length of the final string being returned</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/param&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;param name=&quot;prefixWithChar&quot;&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">///     The character which to prefix the output string with</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/param&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">///     The converted integer as a string with the parameter provided length (possible prefixed with provided</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">char)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static str prefixString(str inputString, int outputStringLength, str 1 prefixWithChar)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str outputString = inputString;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (prefixWithChar == &#x27;&#x27;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        return outputString;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    while (strLen(outputString) &lt; outputStringLength)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        outputString = prefixWithChar + outputString;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return outputString;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// to test that we have access right for the the file or folder.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static client IO_Status writeFileAndClose(Filename filename)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    TextIo textIo;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    new FileIOPermission(filename,&#x27;rw&#x27;).assert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    textIo = new TextIo(filename,&#x27;w&#x27;);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (textIo!=null)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        textIo.write(&#x27;This is a test file for checking the access rights&#x27;);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    CodeAccessPermission::revertAssert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (textIo!=null)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        return textIo.status();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return IO_Status::WriteError;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// send email using smtp</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">//Please change the parameters accordingly for your client</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static boolean emailSmtpSend(str         _receiver,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                                    str         _subject,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                                    str         _body,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                                    Filename    _attachment = &#x27;&#x27;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    AmcBankParameters                       amcBankParameters;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Net.Mail.Attachment              attachment;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Net.Mail.AttachmentCollection    attachmentCollection;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Net.Mail.MailAddress             mailFrom;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Net.Mail.MailAddress             mailTo;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Net.Mail.MailMessage             mailMessage;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Net.Mail.SmtpClient              smtpClient;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (!_receiver)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        return checkFailed(&quot;@ABA32081&quot;);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    amcBankParameters = AmcBankParameters::find();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    try</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        mailFrom    = new System.Net.Mail.MailAddress(amcBankParameters.SmtpSenderAddress);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        mailTo      = new System.Net.Mail.MailAddress(_receiver);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        mailMessage = new System.Net.Mail.MailMessage(mailFrom, mailTo);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        mailmessage.set_Subject(_subject);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        mailmessage.set_Body(_body);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // Adding attachment</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        if (_attachment)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            attachment = new System.Net.Mail.Attachment(_attachment);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            attachmentCollection = mailMessage.get_Attachments();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            attachmentCollection.Add(attachment);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        smtpClient = new System.Net.Mail.SmtpClient(amcBankParameters.SmtpServerName,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">amcBankParameters.SmtpPortNumber);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        smtpClient.Send(mailmessage);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        info(strFmt(&quot;@SYS80635&quot;, _receiver));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        attachmentCollection.Dispose(); // Releases attachement resources (files)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    catch (Exception::CLRError)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // If a CLR exception occurs it is important that the exceptions is shown (which it is not per default)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        error(CLRInterop::getLastException());</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        attachmentCollection.Dispose(); // Releases attachement resources (files)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        return checkFailed(strFmt(&quot;@ABA32082&quot;,  _receiver));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    catch</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        attachmentCollection.Dispose(); // Releases attachement resources (files)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        return checkFailed(strFmt(&quot;@ABA32082&quot;,  _receiver));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return true;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// archive the files.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static void fileArchive(Filename _file, FilePath _archivePath)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Filename            filenameArchive;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    InteropPermission   interopPermission = new InteropPermission(InteropKind::ClrInterop);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Set                 interopPermissionSet = new Set(Types::Class);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (!_archivePath)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // Granting file permission rights</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    interopPermissionSet.add(interopPermission);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    CodeAccessPermission::assertMultiple(interopPermissionSet);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    filenameArchive = _archivePath + AmcBankFile::getFileNameAndExtension(_file);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.IO.File::Delete(filenameArchive);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.IO.File::Move(_file, filenameArchive);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // Reverting file permission rights</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    CodeAccessPermission::revertAssert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// getting the filename and extesion in container.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static Filename getFileNameAndExtension(Filename _filename)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (!_filename)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        return &#x27;&#x27;;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return strFmt(&#x27;%1%2&#x27;, conPeek(Global::fileNameSplit(_filename), 2),     // Filename</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                          conPeek(Global::fileNameSplit(_filename), 3));    // File extension (including</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">prefixed dot (.))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">//FolderExists</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static boolean folderExists(FilePath _directory)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    boolean             dirExists;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    InteropPermission   interopPermission = new InteropPermission(InteropKind::ClrInterop);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Set                 interopPermissionSet = new Set(Types::Class);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // Granting file permission rights</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    interopPermissionSet.add(interopPermission);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    CodeAccessPermission::assertMultiple(interopPermissionSet);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    dirExists = System.IO.Directory::Exists(_directory);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // Reverting file permission rights</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    CodeAccessPermission::revertAssert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return dirExists;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">///  internal use only.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;param name=&quot;text&quot;&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// A String value.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/param&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// A String value.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">private str trimLeadingTabs(str text)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int len = strlen(text);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int start = 1;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    while ((start &lt;= len) &amp;&amp; (substr(text, start, 1) == &#x27;\t&#x27;))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        start++;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    text = substr(text, start, len - start + 1);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return text;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">///  internal use only.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// A String value.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static str getClrErrorMessage()</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #File</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str exceptionMessage;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Exception exObject, innerException;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    new InteropPermission(InteropKind::ClrInterop).assert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // BP deviation documented</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    exObject = CLRInterop::getLastException();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if(exObject)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // We will ignore the first message since it is always a fixed message of</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // &quot;Exception has been thrown from target of invocation&quot;, this is from the reflection API being used</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // &quot;ClrObject could not be created.&quot; - This is also of no use in most cases</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        innerException = exObject.get_InnerException();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        while(innerException)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            // BP deviation documented</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            exceptionMessage = exceptionMessage + #delimiterSpace + CLRInterop::getAnyTypeForObject</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">(innerException.get_Message());</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            innerException = innerException.get_InnerException();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    CodeAccessPermission::revertAssert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return exceptionMessage;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">//Parse date from string</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static date parseDate(str dateText)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str dateTimeText;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ClrObject dateTimeObject;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    utcdatetime dateTimeValue;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    date dateValue;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    dateTimeText = strFmt(&#x27;%1T00:00:00Z&#x27;, dateText);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // BP Deviation Documented</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    dateTimeObject = Microsoft.Dynamics.IntegrationFramework.Util::ParseXmlDateTime(dateTimeText, false);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // If the returned object is null, then deserialization failed</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (CLRInterop::isNull(dateTimeObject))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        throw error(strfmt(&quot;@SYS112380&quot;, dateText, enum2str(Types::Date)));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    dateTimeValue = CLRInterop::getAnyTypeForObject(dateTimeObject);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // If the utcdatetime value is null, then the value is outside the valid range</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // unless the input was a null datetime</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (dateTimeValue == utcDateTimeNull() &amp;&amp; !AifUtil::isNullDateTime(dateTimeObject))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        throw error(strfmt(&quot;@SYS112380&quot;, dateText, enum2str(Types::Date)));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    dateValue = DateTimeUtil::date(dateTimeValue);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return dateValue;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">//Parse DateTime from string</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static utcdatetime parseDateTime(str dateTimeText, System.DateTimeKind expectedDateTimeKind)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ClrObject dateTimeObject;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    utcdatetime dateTimeValue;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.DateTime systemDateTimeValue;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // BP Deviation Documented</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    dateTimeObject = Microsoft.Dynamics.IntegrationFramework.Util::ParseXmlDateTime(dateTimeText, false);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // If the returned object is null, then deserialization failed</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (CLRInterop::isNull(dateTimeObject))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        throw error(strfmt(&quot;@SYS112380&quot;, dateTimeText, enum2str(Types::UtcDateTime)));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    dateTimeValue = CLRInterop::getAnyTypeForObject(dateTimeObject);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // If the utcdatetime value is null, then the value is outside the valid range</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // unless the input was a null datetime</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (dateTimeValue == utcDateTimeNull() &amp;&amp; !AifUtil::isNullDateTime(dateTimeObject))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        throw error(strfmt(&quot;@SYS112380&quot;, dateTimeText, enum2str(Types::UtcDateTime)));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // If the value is of unexpected kind, throw an error.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    systemDateTimeValue = dateTimeObject;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (systemDateTimeValue.get_Kind() != expectedDateTimeKind)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        throw error(strfmt(&quot;@SYS112380&quot;, dateTimeText, enum2str(Types::UtcDateTime)));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return dateTimeValue;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// get the sequence number for the dateformat.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static int getSequenceForDateFormat( DateFormat _dateFormat)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    switch (_dateFormat)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        case DateFormat::YMD:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            return 321;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        case DateFormat::DMY:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            return 123;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        case DateFormat::DYM:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            return 132;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        case DateFormat::MDY:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            return 213;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        case DateFormat::MYD:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            return 231;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        case DateFormat::YDM:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            return 312;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        default:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            return 123;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// returns time from str.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">static int str2Time(str 8 _timeStr)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int     time;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    time += str2int(substr(_timeStr,0,2)) * 3600;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    time += str2int(substr(_timeStr,4,2)) * 60;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    time += str2int(substr(_timeStr,7,2));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return time;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// &lt;CostCenter:Department&gt; _dimaatributesString,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// &lt;1010:MBS&gt; dimValueString</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static RecId generateDefaultDimension(Str                        _dimValueString,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                                             str                        _dimaatributesString,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                                             str                        _delimeter)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    container                           dimAttributeList,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                                        dimValueList;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int                                 j;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    RecId                               defDimRecId;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    DimensionAttributeValueSetStorage   storage;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (_dimaatributesString &amp;&amp; _dimValueString)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        dimAttributeList = str2con(_sourceProperties, _delimeter,false);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        dimValueList     = str2con(_dimValueString, _delimeter,false);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        if(!dimValueList)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            throw error(strFmt(&quot;This dimvalue string was not available&quot;));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        storage = new DimensionAttributeValueSetStorage();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        for (j=1;j&lt;=conLen(dimValueList);j++)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            if(conPeek(dimValueList,j))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                DMFDimensionHelper::dynamicDimensionCreation(dimAttributeList, dimValueList, j);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                storage.addItem(DimensionAttributeValue::findByDimensionAttributeAndValue(DimensionAttribute::findByName(conPeek(dimAttributeList,j)), conPeek(dimValueList,j), false, true));</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        defDimRecId = storage.save();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return defDimRecId;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">//Generate the Dimension String from default dimension</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// &lt;CostCenter:Department&gt; dimAttributeString</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// &lt;1010:MBS&gt; dimValueString</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static str generateDefaultDimensionStr(RefRecId  _defaultDimension,str _dimattrString,</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                                                  str _delimeter)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    DMFDefaultDimensionStr              defaultDimensionStr;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    DimensionAttributeValueSetItem      setItem;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    DimensionAttributeValue             dimAttrValue;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    DimensionAttribute                  dimAttr;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    container                           con;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Int                                 i;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    DimensionValue                      displayValue;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    con = str2con(_dimattrString,_delimeter,false);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (_dimattrString &amp;&amp; _defaultDimension)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        for( i = 1; i &lt;= conLen(con); i ++)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            displayValue = conPeek(con,i);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            select RecId, DisplayValue from setItem where setItem.DimensionAttributeValueSet == _defaultDimension</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                join RecId from dimAttrValue where</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                     dimAttrValue.RecId == setItem.DimensionAttributeValue &amp;&amp;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                     dimAttrValue.IsDeleted == false</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                 join RecId from dimAttr</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                    where  dimAttr.RecId == dimAttrValue.DimensionAttribute</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                       &amp;&amp;  dimAttr.Name  == displayValue;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                if (defaultDimensionStr)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                    defaultDimensionStr += _delimeter;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                defaultDimensionStr += setItem.DisplayValue;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return defaultDimensionStr;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">static int strLineCount(str freeTxt)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int  start  = 1;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int  end;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int  length;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int  lines  = 0;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    length=strLen(freeTxt);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    end = strScan(freeTxt, &#x27;\n&#x27;, start, length);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    while (start)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        lines+=1;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        if (end)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            start=end+1;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            end = strScan(freeTxt, &#x27;\n&#x27;, start, length);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        else</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            start=0;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (!lines)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        lines=1;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return lines;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Determines whether the specified string is a date time string.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;param name=&quot;_value&quot;&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// The string to check.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/param&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// true if it is date time; otherwise, false.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;remarks&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Input can have a format like &quot;5/7/2010 12:00:00 AM&quot; or &quot;2010-05-07T00:00:00. Both cases will be</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// handled.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/remarks&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static boolean isDateTimeStr(str _value)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    boolean isDateTime;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Text.RegularExpressions.Regex regex;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Text.RegularExpressions.Match regexMatch;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #define.MatchTimeRegex(@&quot;[\sT]\d{1,2}:\d{1,2}:\d{1,2}&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #define.ISODateTimeIdentifier(&quot;T&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #define.ZeroTime(&quot;00:00:00&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #define.DefaultLCID(1033)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // check if in ISO format.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    isDateTime = strFind(_value, #ISODateTimeIdentifier, 0, strLen(_value)) &gt; 0;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if(!isDateTime)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // search for a time on the value</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // BP deviation documented</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        regex = new System.Text.RegularExpressions.Regex(#MatchTimeRegex);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // BP deviation documented</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        regexMatch = regex.Match(_value);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        isDateTime = regexMatch.get_Success();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return isDateTime;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">//Swapping the key value from map</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Creates a &lt;c&gt;Map&lt;/c&gt; class with the value and key swapped.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;param name=&quot;_key2ValueMap&quot;&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// Map that has the keys and values swapped.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/param&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// A map that has the value switched with the keys.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static Map getValue2KeyMap(Map _key2ValueMap)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // reverses the valid values map. The original map contains &lt;key, label&gt;, we will create a &lt;label, key&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Map value2KeyMap;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    MapEnumerator mapEnum;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if(_key2ValueMap)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        value2KeyMap = new Map(_key2ValueMap.valueType(), _key2ValueMap.keyType());</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        mapEnum = _key2ValueMap.getEnumerator();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        while(mapEnum.moveNext())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            value2KeyMap.insert(mapEnum.currentValue(), mapEnum.currentKey());</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return value2KeyMap;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token plain">//Show viewhistory on form datasources if you have ValidaTimeState Enabled DateTime enabled on the tables of that form. </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">//create this method in Global class so you can call whereever you want in form button click as below.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">void clicked()</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    buttonHistoryClick(element, this);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Super();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">static public void buttonHistoryClick(FormRun _formRun, FormButtonControl _fbc)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    void changeDataSources(ValidTimeStateAutoQuery _from, ValidTimeStateAutoQuery _to, boolean _allowDelete)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        Counter         dataSourceNo;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        FormDataSource  formDataSource;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        for (dataSourceNo=1;_formRun.dataSourceCount()&gt;=dataSourceNo;dataSourceNo++)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            formDataSource = _formRun.dataSource(dataSourceNo) as FormDataSource;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            if (formDataSource.validTimeStateAutoQuery() == _from &amp;&amp; new DictTable(formDataSource.table()).isValidTimeStateTable())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                formDataSource.validTimeStateAutoQuery(_to);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                switch (_to)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                    case ValidTimeStateAutoQuery::AsOfDate:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                        formDataSource.validTimeStateAutoQuery(ValidTimeStateAutoQuery::AsOfDate);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                        formDataSource.query().resetValidTimeStateQueryType();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                        formDataSource.allowDelete(_allowDelete);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                        break;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                    case ValidTimeStateAutoQuery::DateRange:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                        formDataSource.validTimeStateAutoQuery(ValidTimeStateAutoQuery::DateRange);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                        formDataSource.query().validTimeStateDateTimeRange(DateTimeUtil::minValue(), DateTimeUtil::maxValue());</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                        formDataSource.allowDelete(_allowDelete);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                        break;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                formDataSource.executeQuery();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    if (_fbc.labelText() == &quot;@SYS110266&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        changeDataSources(ValidTimeStateAutoQuery::AsOfDate, ValidTimeStateAutoQuery::DateRange, false);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        _fbc.text(&quot;Stoping History&quot;);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        _fbc.normalImage(&quot;10006&quot;);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        changeDataSources(ValidTimeStateAutoQuery::DateRange, ValidTimeStateAutoQuery::AsOfDate, true);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        _fbc.Text(&quot;@SYS110266</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        _fbc.normalImage(&quot;10007&quot;);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// this method is used to create filenameTimeStamp.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">static FileName createFilenameTimeStamp()</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    FileName    ret;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Microsoft.Dynamics.IntegrationFramework.Adapter.FileSystem       fileSystem;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    #Aif</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    fileSystem      = AifUtil::getClrObject(#FileSystemProgId);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ret = fileSystem.GetCurrentTimestamp();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return ret;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">// This method is used to split the string, and returns the conatiner with the position defined in the parameter</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static str rsaStrSplit(str _splitString,str _splitchar,int _pos)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    List strlist=new List(Types::String);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ListIterator    iterator;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    container       packedList;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    strlist=strSplit(_splitString,_splitchar);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    iterator = new ListIterator(strlist);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    while(iterator.more())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        packedList += iterator.value();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        iterator.next();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return conPeek(packedList,_pos);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static str encrypt(str _input, str _salt = &#x27;&#x27;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Security.Cryptography.SHA512Managed  sha512managed = new System.Security.Cryptography.SHA512Managed();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Text.Encoding                        encoding = System.Text.Encoding::get_UTF8();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Byte[]                               inputBytes;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Byte[]                               resultBytes;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int                                         i;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str                                         returnString;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    new InteropPermission(InteropKind::ClrInterop).assert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    inputBytes = encoding.GetBytes(strLwr(_salt) + _input); // Convert lower case salt + input into byte array</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // The input is hashed 1024 times for attack resiliency</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    for (i = 0; i &lt; 1024; i++)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        resultBytes = resultBytes ? resultBytes : inputBytes; // First loop uses input for hashing</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        resultBytes = sha512managed.ComputeHash(resultBytes);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    returnString = System.Convert::ToBase64String(resultBytes);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    CodeAccessPermission::revertAssert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return returnString;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">private static Map fileGetList(FilePath            _filePathArchive)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Map                 mapFiles;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    InteropPermission   interopPermission = new InteropPermission(InteropKind::ClrInterop);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    Set                 interopPermissionSet = new Set(Types::Class);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    System.Array        arrayFiles;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    int                 i;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // Granting file permission rights</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    interopPermissionSet.add(interopPermission);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    CodeAccessPermission::assertMultiple(interopPermissionSet);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    mapFiles = new Map(Types::String, Types::String); // Key = return file | Value = archive path</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        if (!System.IO.Directory::Exists(_filePathArchive))</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">             throw  error(&quot;Path doesnt exist&quot;);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        arrayFiles = System.IO.Directory::GetFiles(_filePathArchive);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        // CLRInterop::getAnyTypeForObject method is used to handle difference in AX and System types (e.g. System.Int32 != int)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        for (i = 0; i &lt; CLRInterop::getAnyTypeForObject(arrayFiles.get_Length()); i++)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">       mapFiles.insert(CLRInterop::getAnyTypeForObject(arrayFiles.GetValue(i)), _filePathArchive);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    // Reverting file permission rights</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    CodeAccessPermission::revertAssert();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return mapFiles;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">///  Gets the SenderID from AIF xml .</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;param name=&quot;messagePartsXml&quot;&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// An &lt;c&gt;AifXml&lt;/c&gt; value.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/param&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// An instance of the &lt;c&gt;str document Namespace&lt;/c&gt; class.</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">/// &lt;/returns&gt;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">public static str getSenderIDValue(AifXml messagePartsXml)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">     XmlTextReader               xmlReader;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    str value,currentElement,pureElement;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">#Aif</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    xmlReader = XmlTextReader::newXml(messagePartsXml);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    while (xmlReader.Read())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        switch (xmlReader.nodeType())</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">             case XmlNodeType::Element:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                  currentElement = xmlReader.name();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                 break;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">             case XmlNodeType::Text:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                  pureElement = subStr(currentElement,strFind(currentElement,&#x27;:&#x27;,1,256)+1,256);</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                    switch (pureElement)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                       case &quot;SenderId&quot;:</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                        {</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                            value=xmlReader.value();</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                            return value;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                        break;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">              break;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    return value;</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/xpp">xpp</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/development/xpp-sample/2016-12-26-posting-cust-payment-journal-using-x++"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Posting cust payment journal using X++ Dynamics AX 2012</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/development/xpp-sample/2017-01-01-Difference-between-QUERYFILTER-and-QUERYBUILDRANGE"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Difference between QueryFilter and QueryBuildRrange</div></a></nav></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/X++" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://community.dynamics.com/forums/thread/?groupid=5b012a23-c24f-46fc-bfb6-45a1c401d526" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dynamics 365 Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.yammer.com/dynamicsaxfeedbackprograms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dynamics 365 &amp; Power Platform Preview Program<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/Dynamics365/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/about">About me</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright  2023 Automaly.com.</div></div></div></footer></div>
</body>
</html>