<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Blog title | Automaly | Dynamics 365 Finance Operations notes</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://automaly.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://automaly.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://automaly.github.io/page/2"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Blog title | Automaly | Dynamics 365 Finance Operations notes"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://automaly.github.io/page/2"><link data-rh="true" rel="alternate" href="https://automaly.github.io/page/2" hreflang="en"><link data-rh="true" rel="alternate" href="https://automaly.github.io/page/2" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://GQN6ITS7PP-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"Blog","@id":"https://automaly.github.io/page/2","mainEntityOfPage":"https://automaly.github.io/page/2","headline":"Blog title","description":"Blog","blogPost":[{"@type":"BlogPosting","@id":"https://automaly.github.io/2022/10/27/how-to-get-d365-azure-blob-storage-str","mainEntityOfPage":"https://automaly.github.io/2022/10/27/how-to-get-d365-azure-blob-storage-str","url":"https://automaly.github.io/2022/10/27/how-to-get-d365-azure-blob-storage-str","headline":"How to get FinOps Azure storage blob connection string","name":"How to get FinOps Azure storage blob connection string","description":"In Dynamics 365 for Finance and Operations Azure storage is used to","datePublished":"2022-10-27T00:00:00.000Z","dateModified":"2023-12-21T03:13:52.000Z","author":{"@type":"Person","name":"Max Nguyen","description":"FinOps Ranger","url":"/about","image":"https://github.com/Dynamics365.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://automaly.github.io/2020/04/09/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations","mainEntityOfPage":"https://automaly.github.io/2020/04/09/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations","url":"https://automaly.github.io/2020/04/09/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations","headline":"How to skip standard code in Dynamics 365 finance and operations","name":"How to skip standard code in Dynamics 365 finance and operations","description":"Disclaimers: Try at your own risk, this is consider as a bug and it will be fixed soon.","datePublished":"2020-04-09T00:00:00.000Z","dateModified":"2023-12-03T20:50:14.000Z","author":{"@type":"Person","name":"Max Nguyen","description":"FinOps Ranger","url":"/about","image":"https://github.com/Dynamics365.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine","mainEntityOfPage":"https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine","url":"https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine","headline":"Set up a VHD for finance and operations apps","name":"Set up a VHD for finance and operations apps","description":"1. Download Dynamics 365 finance and operations VHD files","datePublished":"2020-04-06T00:00:00.000Z","dateModified":"2023-12-12T00:00:00.000Z","author":{"@type":"Person","name":"Max Nguyen","description":"FinOps Ranger","url":"/about","image":"https://github.com/Dynamics365.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://automaly.github.io/2020/01/25/create-po-confirm-receipt-post","mainEntityOfPage":"https://automaly.github.io/2020/01/25/create-po-confirm-receipt-post","url":"https://automaly.github.io/2020/01/25/create-po-confirm-receipt-post","headline":"Create Purchase Orders - Confirm - Product receipt - Post using X++ in Dynamics 365 Finance & Operations","name":"Create Purchase Orders - Confirm - Product receipt - Post using X++ in Dynamics 365 Finance & Operations","description":"The script will work for Dynamics 365 Finance & Operations version","datePublished":"2020-01-25T00:00:00.000Z","dateModified":"2023-12-21T03:13:52.000Z","author":{"@type":"Person","name":"Max Nguyen","description":"FinOps Ranger","url":"/about","image":"https://github.com/Dynamics365.png"},"keywords":[]}]}</script><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Automaly | Dynamics 365 Finance Operations notes RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Automaly | Dynamics 365 Finance Operations notes Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","367316606","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=	GTM-NDZH42N8"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","\tGTM-NDZH42N8",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Automaly | Dynamics 365 Finance Operations notes" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.95e1e37e.css">
<script src="/assets/js/runtime~main.d5fa2788.js" defer="defer"></script>
<script src="/assets/js/main.786eae30.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo2.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo2.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Automaly</b></a><a class="navbar__item navbar__link" href="/docs">Notes</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/ms-learning/lab">MS Labs</a><a href="https://automaly.com/finopsnews/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">FinOps blogs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://dynamics365.github.io/erd/default.htm" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">AX 2012 ERD<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/Dynamics365/One-stop-Dynamics-365-Finance-Operations" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://automaly.com/rss.xml" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">RSS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All our posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2024/05/11/truncate-a-table-Xpp">Truncate a table using X++</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2024/05/12/sql-cheat-sheet">SQL cheatsheet</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2024/05/05/Import-a-bacpac-file-into-a-Tier1-environment">SqlPackage - The Element or Annotation class SqlStatistic does not contain the Property class AutoDrop</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2024/05/02/Self-Update-to-latest-quality-update">Self-Update to latest quality update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2024/01/07/ThrowBehaviour">Throw behaviour in X++</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2024/01/02/TrickXppPrePostArg">Using XppPrePostArgs to pass parameters through a method</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2024/01/04/KustoVsPBI">Using Kusto functions in Power BI datasource</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2024/01/04/NoDataInTmpTableForPreProcessReport">No data is inserted/modified in temporary table when processing an SRS report using Pre-process</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2023/12/26/set-default-model-for-d365-project">Set default model for Dynamics 365 Finance Operations project</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2023/12/21/How-to-hide-New-and-Delete-buttons-in-form-1">How to hide New and Delete buttons (command buttons) in form</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2022/10/27/how-to-get-d365-azure-blob-storage-str">How to get FinOps Azure storage blob connection string</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2020</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2020/04/09/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations">How to skip standard code in Dynamics 365 finance and operations</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine">Set up a VHD for finance and operations apps</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2020/01/25/create-po-confirm-receipt-post">Create Purchase Orders - Confirm - Product receipt - Post using X++ in Dynamics 365 Finance &amp; Operations</a></li></ul></div></nav></aside><main class="col col--7"><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/2022/10/27/how-to-get-d365-azure-blob-storage-str">How to get FinOps Azure storage blob connection string</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-10-27T00:00:00.000Z">October 27, 2022</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/about"><img class="avatar__photo authorImage_XqGP" src="https://github.com/Dynamics365.png" alt="Max Nguyen"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/about"><span class="authorName_yefp">Max Nguyen</span></a></div><small class="authorTitle_nd0D" title="FinOps Ranger">FinOps Ranger</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>In Dynamics 365 for Finance and Operations Azure storage is used to</p>
<ul>
<li>Store files for <a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management" target="_blank" rel="noopener noreferrer">Attachments</a></li>
<li><a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/data-entities/data-import-export-job" target="_blank" rel="noopener noreferrer">Data import and export jobs</a></li>
<li>When FinOps prints a report via <a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/analytics/document-reporting-services?context=%2Fdynamics365%2Fcontext%2Fcommerce" target="_blank" rel="noopener noreferrer">Document Reporting Services</a>, SSRS Reporting Services generates an <a href="https://ax.docentric.com/printing-reports-with-custom-fonts-in-dynamics-365-for-finance-and-operations/" target="_blank" rel="noopener noreferrer">EMF image</a> for each page of the generated document. FinOps then temporarily saves the generated EMF files to Azure Blob storage.</li>
<li><a href="https://learn.microsoft.com/en-us/dynamicsax-2012/appuser-itpro/print-a-report-from-the-archive" target="_blank" rel="noopener noreferrer">Printing archive</a></li>
</ul>
<p>And more!</p>
<p>If you are using tier 1 Cloud-Hosted environment, you can find the azure storage from the Azure resource group in Azure portal.</p>
<p>For tier 1, UAT tier 2, and PROD Tier 3, you can create a runnable class and execute to get the Azure storage connection string.</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">Microsoft</span><span class="token namespace punctuation" style="opacity:0.7;color:#b6ad9a">.</span><span class="token namespace" style="opacity:0.7">Dynamics</span><span class="token namespace punctuation" style="opacity:0.7;color:#b6ad9a">.</span><span class="token namespace" style="opacity:0.7">Clx</span><span class="token namespace punctuation" style="opacity:0.7;color:#b6ad9a">.</span><span class="token namespace" style="opacity:0.7">ServicesWrapper</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">GetAzureBlob</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">Args</span><span class="token plain"> _args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token function" style="color:#b29762">info</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">&#x27;AzureStorageConnectionString </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> &#x27; </span><span class="token operator" style="color:#063289">+</span><span class="token plain"> CloudInfrastructure</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">GetCsuStorageConnectionString</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token function" style="color:#b29762">info</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">&#x27;ClientCertificateThumbprint </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> &#x27; </span><span class="token operator" style="color:#063289">+</span><span class="token plain"> CloudInfrastructure</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">GetCsuClientCertificateThumbprint</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Once you have the connection string, you can connect it to <a href="https://docs.microsoft.com/en-us/azure/vs-azure-tools-storage-manage-with-storage-explorer?tabs=windows" target="_blank" rel="noopener noreferrer">MS Azure Storage Explorer</a>, Power Automate, or consuming in any framwork/language for integration/backup purposes.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure-storage-connection-string">Azure storage connection string</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/2020/04/09/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations">How to skip standard code in Dynamics 365 finance and operations</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2020-04-09T00:00:00.000Z">April 9, 2020</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/about"><img class="avatar__photo authorImage_XqGP" src="https://github.com/Dynamics365.png" alt="Max Nguyen"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/about"><span class="authorName_yefp">Max Nguyen</span></a></div><small class="authorTitle_nd0D" title="FinOps Ranger">FinOps Ranger</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Disclaimers: Try at your own risk, this is consider as a bug and it will be fixed soon.</p></div></div>
<p>According to this MS article about Chain Of Command <a href="https://docs.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/extensibility/method-wrapping-coc#wrapper-methods-must-always-call-next" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/extensibility/method-wrapping-coc#wrapper-methods-must-always-call-next</a></p>
<blockquote>
<p>&quot;Wrapper methods must always call next Wrapper methods in an extension class must always call next, so that the next method in the chain and, finally, the original implementation are always called. This restriction helps guarantee that every method in the chain contributes to the result. In the current implementation of this restriction, the call to next must be in the first-level statements in the method body.&quot;</p>
</blockquote>
<p>So as described in the article, the Chain Of Command in Dynamics 365 finance and operations is used to add the logic before or after a method of a class is invoked and the original method will always be executed due to the compulsory of the next statement.
When doing some implementations, we found out that there is a tricky way to completely <strong>ignore</strong> the execution of the original method of the class that is extended.</p>
<p>Please see below for more details:
For example, I created a project and add a new runnable class named Alex:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">TestClass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">Args</span><span class="token plain"> _args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">throw</span><span class="token plain"> error </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&quot;Hello World&quot;</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When this class runs, a <em>Hello World</em> info message will be displayed in the FinOps UI. Then I used chain of command to create Alex_Extension class that extends this class and &quot;override&quot; the main method of the Alex&#x27;s class by putting the next call into another method and never call it like this:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">ExtensionOf</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">classStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">TestClass</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">final </span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">Alex_Extension</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">Args</span><span class="token plain"> _args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">//Implement something here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        info </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&quot;Ok&quot;</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">ignore</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token return-type class-name">next</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When I run the <em>AlexExtension</em>, the original main method of the Alex class will be ignored and only the additional block of code that I wrote in the <em>AlexExtension</em> class will be executed, so only the <strong>OK</strong> info will appear.</p>
<p>Now we will try with a sample scenario from D365 Finance and Operation. In <strong>General Ledger</strong> Module, we have <strong>General journals</strong> form</p>
<p><img decoding="async" loading="lazy" alt="Image" src="/assets/images/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations-66c51bb573c0657ebc959a0ad40005b7.png" width="975" height="407" class="img_ev3q"></p>
<p>When you click the button for <strong>Journal Print</strong>, the menu item will be triggered and point to the controller name: <em>LedgerJournalController</em> with <em>LedgerJournalController</em> class and the report will be generated.</p>
<p>I will use COC to “override” the main method of <em>LedgerJournalController</em> class by applying the method above:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">ExtensionOf</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">classStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">LedgerJournalController</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">final </span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">Alex_LedgerJournalController_Extension</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">Args</span><span class="token plain"> _args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token function" style="color:#b29762">info</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&quot;ok&quot;</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">ignore_first</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token return-type class-name">next</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain">  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Using this I will ignore the the main method of <em>LedgerJournalController</em> class and instead of generate the report, the result will be only the <strong>OK</strong> info line in the extension class:</p>
<p><img decoding="async" loading="lazy" alt="Image" src="/assets/images/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations-1-eea78f76c5b15f296a3f509856449709.png" width="975" height="408" class="img_ev3q"></p>
<p>This is a little bit tricky because we still call next in our extension class as per the requirement of COC, but as we never call the method that &quot;wrap&quot; the next call so it will not be executed. You can try this to simply ignore or rewrite a method of a class in FinOps.</p>
<p>Thank you for reading.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/chain-of-command">Chain of Command</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/dynamics-365-finance-and-operations">Dynamics 365 finance and operations</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/skip-standard-code">skip standard code</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine">Set up a VHD for finance and operations apps</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2020-04-06T00:00:00.000Z">April 6, 2020</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/about"><img class="avatar__photo authorImage_XqGP" src="https://github.com/Dynamics365.png" alt="Max Nguyen"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/about"><span class="authorName_yefp">Max Nguyen</span></a></div><small class="authorTitle_nd0D" title="FinOps Ranger">FinOps Ranger</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-download-dynamics-365-finance-and-operations-vhd-files">1. Download Dynamics 365 finance and operations VHD files<a href="#1-download-dynamics-365-finance-and-operations-vhd-files" class="hash-link" aria-label="Direct link to 1. Download Dynamics 365 finance and operations VHD files" title="Direct link to 1. Download Dynamics 365 finance and operations VHD files">​</a></h2>
<ul>
<li>
<p>Go to the LCS main page and select <strong>Shared asset library</strong> or go to Shared Asset Library.</p>
</li>
<li>
<p>Select the asset type <strong>Downloadable VHD</strong>.</p>
</li>
<li>
<p>Find the VHD you are looking for based on the desired Finance and Operation version. The VHD is divided into multiple file parts that you need to download. For example, the asset files that start with &quot;VHD - 10.0.5&quot; are the different files you need in order to install version 10.0.5.</p>
</li>
<li>
<p>Download all files (parts) associated with the desired VHD to a local folder.</p>
</li>
<li>
<p>After the download is complete, run the executable file that you downloaded, accept the software license agreement, and choose a file path to extract the VHD to.</p>
</li>
<li>
<p>This creates a local VHD file that you can use to run a local virtual machine.</p>
</li>
<li>
<p>Sign in to the VM by using the following credentials:</p>
<ul>
<li>User name: <strong>Administrator</strong></li>
<li>Password: <strong>pass@word1</strong></li>
</ul>
</li>
</ul></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/onebox-vhd">onebox vhd</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/dynamics-365-finance-and-operations">Dynamics 365 finance and operations</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/upgrade">upgrade</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/lcs">LCS</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/one-box">OneBox</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Set up a VHD for finance and operations apps" href="/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine"><b>Read more</b></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/2020/01/25/create-po-confirm-receipt-post">Create Purchase Orders - Confirm - Product receipt - Post using X++ in Dynamics 365 Finance &amp; Operations</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2020-01-25T00:00:00.000Z">January 25, 2020</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/about"><img class="avatar__photo authorImage_XqGP" src="https://github.com/Dynamics365.png" alt="Max Nguyen"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/about"><span class="authorName_yefp">Max Nguyen</span></a></div><small class="authorTitle_nd0D" title="FinOps Ranger">FinOps Ranger</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><blockquote>
<p>The script will work for Dynamics 365 Finance &amp; Operations version</p>
</blockquote>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">MaxGeneratePO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">Args</span><span class="token plain"> _args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name keyword" style="color:#728fcb">int</span><span class="token plain"> i </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token number" style="color:#063289">0</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> </span><span class="token comment" style="color:#b6ad9a">// number of purchase orders</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">NumberSeq</span><span class="token plain"> numberSeq</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">PurchTable</span><span class="token plain"> purchTable</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">PurchLine</span><span class="token plain"> purchLine</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">InventDim</span><span class="token plain"> inventDim</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">i </span><span class="token operator" style="color:#063289">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#063289">3</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            ttsBegin</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token class-name">MaxGeneratePO</span><span class="token plain"> createPO </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">MaxGeneratePO</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            numberSeq </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> NumberSeq</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">newGetNum</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">PurchParameters</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">numRefPurchId</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            numberSeq</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">used</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> numberSeq</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">num</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">initValue</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">initFromVendTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">VendTable</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">find</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">&#x27;US</span><span class="token operator" style="color:#063289">-</span><span class="token number" style="color:#063289">101</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token keyword" style="color:#728fcb">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token operator" style="color:#063289">!</span><span class="token plain">purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">validateWrite</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                </span><span class="token keyword" style="color:#728fcb">throw</span><span class="token plain"> Exception</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Error</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">insert</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            inventDim</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">clear</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">clear</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">initValue</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ItemId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> &#x27;D0002&#x27;</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            inventDim</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">InventSiteId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&quot;1&quot;</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            inventDim</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">InventLocationId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&quot;11&quot;</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">InventDimId</span><span class="token operator" style="color:#063289">=</span><span class="token plain">InventDim</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">findOrCreate</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">inventDim</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">inventDimId </span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">createLine</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchQty </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token number" style="color:#063289">5</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchUnit </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&quot;ea&quot;</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchPrice </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> createPO</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">randomAmount</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> </span><span class="token comment" style="color:#b6ad9a">// get random amount nubmer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">LineAmount </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">calcLineAmount</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">update</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token comment" style="color:#b6ad9a">//PO confirm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token class-name">PurchFormLetter</span><span class="token plain"> purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token class-name">PurchFormLetter</span><span class="token plain"> purchFormLetterPack</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchFormLetter </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> PurchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">construct</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">DocumentStatus</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">PurchaseOrder</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">update</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">purchTable</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token function" style="color:#b29762">strFmt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&quot;ConNum_%1&quot;</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token function" style="color:#b29762">systemDateGet</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token named-parameter punctuation" style="color:#b6ad9a">PurchUpdate</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">All</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token named-parameter punctuation" style="color:#b6ad9a">AccountOrder</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">None</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token named-parameter punctuation" style="color:#b6ad9a">NoYes</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">No</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token named-parameter punctuation" style="color:#b6ad9a">NoYes</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">no</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token comment" style="color:#b6ad9a">//Product receipt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            createPO</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">proceed</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ItemId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain">purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">InventDimId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain">purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchQty</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token function" style="color:#b29762">strFmt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&quot;RptNum_%1&quot;</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token comment" style="color:#b6ad9a">//Post PO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            createPO</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">postPOInvoice</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token function" style="color:#b29762">strFmt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&quot;RptNum_%1&quot;</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token function" style="color:#b29762">info</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">strFmt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&quot;Purchase order &#x27;%1&#x27; has been created&quot;</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            ttsCommit</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            i</span><span class="token operator" style="color:#063289">++</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name">boolean</span><span class="token plain"> </span><span class="token function" style="color:#b29762">proceed</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">PurchId</span><span class="token plain"> _purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">ItemId</span><span class="token plain"> _itemId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token class-name">inventDimId</span><span class="token plain"> _inventDimId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">PurchQty</span><span class="token plain"> _qty</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">PackingSlipId</span><span class="token plain"> _productReceiptNumber</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">generateProductReceipt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">addToPurchLineList</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _itemId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _inventDimId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _qty</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _productReceiptNumber</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name">boolean</span><span class="token plain"> </span><span class="token function" style="color:#b29762">generateProductReceipt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">PurchId</span><span class="token plain"> _purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token plain"> _purchLineList</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">PackingSlipId</span><span class="token plain"> _productReceiptNumber</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">boolean</span><span class="token plain"> ret </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">PurchFormLetter</span><span class="token plain"> purchFromLetter</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">PurchTable</span><span class="token plain"> purchTable </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> PurchTable</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">find</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_purchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">try</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            ttsbegin</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchFromLetter </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> PurchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">construct</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">DocumentStatus</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">PackingSlip</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchFromLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">createFromLines</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchFromLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">parmLineList</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_purchLineList</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">pack</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchFromLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">update</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">purchTable</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _productReceiptNumber</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token named-parameter punctuation" style="color:#b6ad9a">DateTimeUtil</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">getToday</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">DateTimeUtil</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">getUserPreferredTimeZone</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token named-parameter punctuation" style="color:#b6ad9a">PurchUpdate</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">All</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            ttscommit</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">catch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            ret </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">false</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">return</span><span class="token plain"> ret</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name">List</span><span class="token plain"> </span><span class="token function" style="color:#b29762">addToPurchLineList</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">PurchId</span><span class="token plain"> _purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">ItemId</span><span class="token plain"> _itemId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token class-name">inventDimId</span><span class="token plain"> _inventDimId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">PurchQty</span><span class="token plain"> _qty</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">List</span><span class="token plain"> purchLineList </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">List</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">Types</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Record</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">PurchLine</span><span class="token plain"> purchLine </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> PurchLine</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">findItemIdInventDimId</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _itemId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _inventDimId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">if</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">purchLine </span><span class="token operator" style="color:#063289">&amp;&amp;</span><span class="token plain"> _qty </span><span class="token operator" style="color:#063289">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#063289">0</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchReceivedNow </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> _qty</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchline</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">modifiedField</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">fieldNum</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">PurchLine</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> PurchReceivedNow</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLineList</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">addEnd</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">purchLine</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">return</span><span class="token plain"> purchLineList</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">postPOInvoice</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">PurchId</span><span class="token plain"> purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">PackingSlipId</span><span class="token plain"> packingSlipId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">TmpFrmVirtual</span><span class="token plain">               tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">PurchFormLetter_Invoice</span><span class="token plain">     purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">VendPackingSlipJour</span><span class="token plain">         vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">SysQueryRun</span><span class="token plain">                 chooseLinesQuery</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">SysQueryRun</span><span class="token plain">                 chooseLinesPendingInvoiceQuery</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">container</span><span class="token plain">                   conTmpFrmVirtual</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">List</span><span class="token plain">                        selectedList    </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">List</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">Types</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Record</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">select</span><span class="token plain"> firstonly vendPackingSlipJour</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                    </span><span class="token keyword" style="color:#728fcb">where</span><span class="token plain"> </span><span class="token class-name">vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId </span><span class="token operator" style="color:#063289">==</span><span class="token plain"> purchId</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token operator" style="color:#063289">&amp;&amp;</span><span class="token plain"> vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PackingSlipId </span><span class="token operator" style="color:#063289">==</span><span class="token plain"> packingSlipId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">clear</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">TableNum  </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">TableId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">RecordNo  </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">RecId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">NoYes     </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> NoYes</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Yes</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Id        </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">insert</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        chooseLinesQuery </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">SysQueryRun</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">queryStr</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">PurchUpdate</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        chooseLinesQuery</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">query</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">addDataSource</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">tableNum</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">VendInvoiceInfoTable</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">enabled</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token boolean" style="color:#728fcb">false</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// chooseLinesPendingInvoiceQuery needs to be initialized, although it will not be used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        chooseLinesPendingInvoiceQuery </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">SysQueryRun</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">queryStr</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">PurchUpdatePendingInvoice</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        chooseLinesPendingInvoiceQuery</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">query</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">dataSourceTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">tableNum</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">PurchTable</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">addRange</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">fieldNum</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">PurchTable</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token keyword" style="color:#728fcb">value</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">queryValue</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">&#x27;&#x27;</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">           </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> PurchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">construct</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">DocumentStatus</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Invoice</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">chooseLinesQuery </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">chooseLinesQuery</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">parmQueryChooseLinesPendingInvoice</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">chooseLinesPendingInvoiceQuery</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">purchTable </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">PurchTable</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">find</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">transDate </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">systemDateGet</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">parmParmTableNum </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">strFmt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&quot;%1&quot;</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain">packingSlipId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> </span><span class="token comment" style="color:#b6ad9a">//This is invoice number</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">printFormLetter </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">NoYes</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">No</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">sumBy </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">AccountOrder</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Auto</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">specQty </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">PurchUpdate</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">PackingSlip</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">while</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">select</span><span class="token plain"> tmpFrmVirtualVend</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            selectedList</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">addEnd</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            conTmpFrmVirtual </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> selectedList</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">pack</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">selectFromJournal</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">conTmpFrmVirtual</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">reArrangeNow</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">run</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">int</span><span class="token plain"> </span><span class="token function" style="color:#b29762">randomAmount</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">RandomGenerate</span><span class="token plain"> randomGenerate</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        randomGenerate </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> RandomGenerate</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">construct</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        randomGenerate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">parmSeed</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">Random</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">nextInt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">return</span><span class="token plain"> RandomGenerate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">randomInt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token number" style="color:#063289">100</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token number" style="color:#063289">800</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Thank you for reading.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/create-purchase-order-x">Create Purchase order X++</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/coding">Coding</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/integration">integration</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/"><div class="pagination-nav__label">Newer entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">One stop FO</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/X++" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://community.dynamics.com/forums/thread/?groupid=5b012a23-c24f-46fc-bfb6-45a1c401d526" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dynamics 365 Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.yammer.com/dynamicsaxfeedbackprograms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dynamics 365 &amp; Power Platform Preview Program<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Dynamics365/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/about">Maintainer of Automaly</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Automaly.com.</div></div></div></footer></div>
</body>
</html>