<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://automaly.github.io</id>
    <title>Automaly | Dynamics 365 Finance Operations notes Blog</title>
    <updated>2024-05-11T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://automaly.github.io"/>
    <subtitle>Automaly | Dynamics 365 Finance Operations notes Blog</subtitle>
    <icon>https://automaly.github.io/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Truncate a table using X++]]></title>
        <id>https://automaly.github.io/2024/05/11/truncate-a-table-Xpp</id>
        <link href="https://automaly.github.io/2024/05/11/truncate-a-table-Xpp"/>
        <updated>2024-05-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[We can use the tableTruncate method from SqlDataDictionary to truncate a table in FinOps, useful for a huge SQL table.]]></summary>
        <content type="html"><![CDATA[<p>We can use the <code>tableTruncate</code> method from <code>SqlDataDictionary</code> to truncate a table in FinOps, useful for a huge SQL table.</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">Args</span><span class="token plain"> _args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token class-name">DictTable</span><span class="token plain"> dictTable </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">DictTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">tablenum</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">KA_TBYTDStaging</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"> </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">dictTable </span><span class="token operator" style="color:#063289">&amp;&amp;</span><span class="token plain"> dictTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">enabled</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">str</span><span class="token plain"> sqlTableName </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> dictTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">name</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">DbBackend</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Sql</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">SqlDataDictionary</span><span class="token plain"> sqlTable </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">SqlDataDictionary</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"> </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">sqlTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">tableExist</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">sqlTableName</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">SqlDataDictionaryPermission</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">methodstr</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">SqlDataDictionary</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> tableTruncate</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">assert</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            sqlTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">tableTruncate</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">tablenum</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">KA_TBYTDStaging</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">false</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            CodeAccessPermission</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">revertAssert</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>Max Nguyen</name>
            <uri>/about</uri>
        </author>
        <category label="xpp" term="xpp"/>
        <category label="Development" term="Development"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[SQL cheatsheet]]></title>
        <id>https://automaly.github.io/2024/05/12/sql-cheat-sheet</id>
        <link href="https://automaly.github.io/2024/05/12/sql-cheat-sheet"/>
        <updated>2024-05-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[SQL Datatype]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sql-datatype">SQL Datatype<a href="https://automaly.github.io/2024/05/12/sql-cheat-sheet#sql-datatype" class="hash-link" aria-label="Direct link to SQL Datatype" title="Direct link to SQL Datatype">​</a></h2>
<table><thead><tr><th style="text-align:center"></th><th>SQL Datatype</th><th>Description</th></tr></thead><tbody><tr><td style="text-align:center">String</td><td>CHAR(size)</td><td>A fixed-length string containing numbers, letters or special characters.   Length may vary from 0-255.</td></tr><tr><td style="text-align:center"></td><td>VARCHAR(size)</td><td>Variable-length string where the length may vary from 0-65535. Similar to   CHAR.</td></tr><tr><td style="text-align:center"></td><td>TEXT(size)</td><td>Can contain a string of size up to 65536 bytes.</td></tr><tr><td style="text-align:center"></td><td>TINY TEXT</td><td>Can contain a string of up to 255 characters.</td></tr><tr><td style="text-align:center"></td><td>MEDIUM TEXT</td><td>Can contain a string of up to 16777215 characters.</td></tr><tr><td style="text-align:center"></td><td>LONG TEXT</td><td>Can contain a string of up to 4294967295 characters.</td></tr><tr><td style="text-align:center"></td><td>BINARY(size)</td><td>Similar to CHAR() but stores binary byte strings.</td></tr><tr><td style="text-align:center"></td><td>VARBINARY(size)</td><td>Similar to VARCHAR() but stores binary byte strings.</td></tr><tr><td style="text-align:center"></td><td>BLOB(size)</td><td>Holds blobs up to 65536 bytes.</td></tr><tr><td style="text-align:center"></td><td>TINYBLOB</td><td>It is used for Binary Large Objects and has a maximum size of 255bytes.</td></tr><tr><td style="text-align:center"></td><td>MEDIUMBLOB</td><td>Holds blobs up to 16777215 bytes.</td></tr><tr><td style="text-align:center"></td><td>LONGBLOB</td><td>Holds blobs up to 4294967295 bytes.</td></tr><tr><td style="text-align:center"></td><td></td><td></td></tr><tr><td style="text-align:center">Numberic</td><td>BIT(size)</td><td>Bit-value type, where size varies from 1 to 64. Default value: 1</td></tr><tr><td style="text-align:center"></td><td>INT(size)</td><td>Integer with values in the signed range of -2147483648 to 2147483647 and   values in the unsigned range of 0 to 4294967295.</td></tr><tr><td style="text-align:center"></td><td>TINYINT(size)</td><td>Integer with values in the signed range of -128 to 127 and values in the   unsigned range of 0 to 255.</td></tr><tr><td style="text-align:center"></td><td>SMALLINT(size)</td><td>Integer with values in the signed range of -32768 to 32767 and values in   the unsigned range of 0 to 65535.</td></tr><tr><td style="text-align:center"></td><td>MEDIUMINT(size)</td><td>Integer with values in the signed range of -8388608 to 8388607 and values   in the unsigned range of 0 to 16777215.</td></tr><tr><td style="text-align:center"></td><td>BIGINT(size)</td><td>Integer with values in the signed range of 9223372036854775808 to   9223372036854775807 and values in the unsigned range of 0 to   18446744073709551615.</td></tr><tr><td style="text-align:center"></td><td>BOOLEAN</td><td>Boolean values where 0 is considered as FALSE and non-zero values are   considered TRUE.</td></tr><tr><td style="text-align:center"></td><td>FLOAT (p)</td><td>The floating-point number is stored. If the precision parameter is set   between 0 to 24, the type is FLOAT() else if it lies between 25 to 53, the   datatype is DOUBLE()</td></tr><tr><td style="text-align:center"></td><td></td><td></td></tr><tr><td style="text-align:center">Date &amp; Time</td><td>DATE</td><td>Stores date in YYYY-MM-DD format with dates in the range of '1000-01-01'   to '9999-12-31'.</td></tr><tr><td style="text-align:center"></td><td>TIME(fsp)</td><td>Stores time in hh:mm<!-- -->:ss<!-- --> format with times in the range of '-838:59:59' to   '838:59:59'.</td></tr><tr><td style="text-align:center"></td><td>DATETIME(fsp)</td><td>Stores a combination of date and time in YYYY-MM-DD and hh:mm<!-- -->:ss<!-- --> format,   with values in the range of '1000-01-01 00:00:00' to '9999-12-31 23:59:59'.</td></tr><tr><td style="text-align:center"></td><td>TIMESTAMP(fsp)</td><td>It stores values relative to the UnixEpoch, basically a Unix Timestamp.   Values lie in the range of '1970-01-01 00:00:01' UTC to '2038-01-09 03:14:07'   UTC.</td></tr><tr><td style="text-align:center"></td><td>YEAR</td><td>Stores values of years as a 4digit number format, with a range lying   between -1901 to 2155.</td></tr></tbody></table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sql-command">SQL Command<a href="https://automaly.github.io/2024/05/12/sql-cheat-sheet#sql-command" class="hash-link" aria-label="Direct link to SQL Command" title="Direct link to SQL Command">​</a></h2>
<!-- -->
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sql-constraints">SQL Constraints<a href="https://automaly.github.io/2024/05/12/sql-cheat-sheet#sql-constraints" class="hash-link" aria-label="Direct link to SQL Constraints" title="Direct link to SQL Constraints">​</a></h2>
<ul>
<li><code>NOT NULL</code>: Specifies that this column cannot store a NULL value.</li>
</ul>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">TABLE</span><span class="token plain"> student</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">     id      </span><span class="token keyword" style="color:#728fcb">INT</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token number" style="color:#063289">8</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> </span><span class="token operator" style="color:#063289">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">NULL</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">     name    </span><span class="token keyword" style="color:#728fcb">VARCHAR</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token number" style="color:#063289">30</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> </span><span class="token operator" style="color:#063289">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">NULL</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">     address </span><span class="token keyword" style="color:#728fcb">VARCHAR</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token number" style="color:#063289">50</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">  </span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><code>UNIQUE</code>: Specifies that this column can have only Unique values, i.e the values cannot be repeated in the column.</li>
</ul>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">TABLE</span><span class="token plain"> Student</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">ID </span><span class="token keyword" style="color:#728fcb">int</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token number" style="color:#063289">8</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">UNIQUE</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">NAME </span><span class="token keyword" style="color:#728fcb">varchar</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token number" style="color:#063289">10</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> </span><span class="token operator" style="color:#063289">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">NULL</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">ADDRESS </span><span class="token keyword" style="color:#728fcb">varchar</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token number" style="color:#063289">20</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>Max Nguyen</name>
            <uri>/about</uri>
        </author>
        <category label="SQL" term="SQL"/>
        <category label="cheatsheet" term="cheatsheet"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[SqlPackage - The Element or Annotation class SqlStatistic does not contain the Property class AutoDrop]]></title>
        <id>https://automaly.github.io/2024/05/05/Import-a-bacpac-file-into-a-Tier1-environment</id>
        <link href="https://automaly.github.io/2024/05/05/Import-a-bacpac-file-into-a-Tier1-environment"/>
        <updated>2024-05-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[If you are using d365fo.tools to Import a bacpac file into a Tier1 environment and you got an error]]></summary>
        <content type="html"><![CDATA[<p>If you are using <a href="https://github.com/d365collaborative/d365fo.tools" target="_blank" rel="noopener noreferrer">d365fo.tools</a> to <a href="https://github.com/d365collaborative/d365fo.tools/wiki/How-To-Import-Bacpac-Into-Tier1" target="_blank" rel="noopener noreferrer">Import a bacpac file into a Tier1 environment</a> and you got an error</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Error output was</div><div class="admonitionContent_BuS1"><p><em>Error importing database<!-- -->:An<!-- --> error occurred during deployment plan generation. Deployment cannot continue. The Element or Annotation class SqlStatistic does not contain the Property class AutoDrop.</em></p></div></div>
<p>The d365fo.tools use <code>Invoke-D365InstallSqlPackage</code> to install SqlPackage, but its version is not up to date, compare to the bacpac files generated from LCS database export.
To solve the issue, we need to downlaod <a href="https://learn.microsoft.com/en-us/sql/tools/sqlpackage/sqlpackage-download?view=sql-server-ver16#installation-file-download-alternative" target="_blank" rel="noopener noreferrer">the latest version as a zip file</a>, unblock, unzip and replace files in the SqlPackage folder <code>C:\Temp\d365fo.tools\SqlPackage</code> with the new version.</p>]]></content>
        <author>
            <name>Max Nguyen</name>
            <uri>/about</uri>
        </author>
        <category label="SqlPackage" term="SqlPackage"/>
        <category label="troubleshoot" term="troubleshoot"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Self-Update to latest quality update]]></title>
        <id>https://automaly.github.io/2024/05/02/Self-Update-to-latest-quality-update</id>
        <link href="https://automaly.github.io/2024/05/02/Self-Update-to-latest-quality-update"/>
        <updated>2024-05-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[1. Login to LCS – and select the F&O environment that is enabled for Synapse Link]]></summary>
        <content type="html"><![CDATA[<ol>
<li>Login to LCS – and select the F&amp;O environment that is enabled for Synapse Link</li>
<li>Validate the platform version of the environment under Environment version information as shown bellow.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Platform version" src="https://automaly.github.io/assets/images/2024-05-04_16h10_59-2534f767816b06001d4eeddf05cecbe0.png" width="1190" height="506" class="img_ev3q"></p>
<ol start="3">
<li>If the platform version of your environment is lower than corresponding rows bellow – for example above environment platform version is 7.0.7036.113 and required version is 7.0.7036.133 or Higher. The above environment must be updated to the latest quality update.</li>
</ol>
<table><thead><tr><th>Application   (Platform)</th><th>Required platform version</th><th>PQU schedule</th></tr></thead><tbody><tr><td>10.0.36 (PU 60)</td><td>7.0.7036.133 or Higher</td><td>10.0.36 PQU-3     (January 22, 2023 to February 25, 2024)</td></tr><tr><td>10.0.37 (PU 61)</td><td>7.0.7068.109   or Higher</td><td>10.0.37 PQU-2     January 8, 2024 to February 11, 2024</td></tr><tr><td>10.0.38 (PU 62)</td><td>7.0.7120.59 or   Higher</td><td></td></tr></tbody></table>
<ol start="4">
<li>
<p>There are two ways to update the F&amp;O environment with quality update. Self-update using the latest quality update and second wait for the PQU (Proactive quality update) to be pushed to your environment by Microsoft</p>
</li>
<li>
<p>Above table list out the PQU schedule when your environment will receive the PQU, based on the PQU schedule <a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/get-started/quality-updates-schedule?context=%2Fdynamics365%2Fcontext%2Fcommerce#high-level-pqu-train-schedule" target="_blank" rel="noopener noreferrer">Release schedule for PQU</a></p>
</li>
<li>
<p>Customer can also self-update the environment by self-applying the latest quality update instead of waiting for PQU, follow the steps bellow to self-update to latest quality update <a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/migration-upgrade/download-hotfix-lcs#finance-and-operations-apps" target="_blank" rel="noopener noreferrer">Reference documentation</a></p>
<ul>
<li>In the LCS environment page, go to Available updates section and click on view update.
<img decoding="async" loading="lazy" alt="alt text" src="https://automaly.github.io/assets/images/2024-05-04_16h20_36-8da1da793b29434d9264dbb028f2bb51.png" width="1260" height="395" class="img_ev3q"></li>
<li>Click on save package.
<img decoding="async" loading="lazy" alt="alt text" src="https://automaly.github.io/assets/images/2024-05-04_16h21_13-659a06dcb33be52268c54568e5febfa6.png" width="1186" height="223" class="img_ev3q"></li>
<li>Click on Save package, on the Save package to asset library dialog opens, give a name and click on Save package. This action will save the latest cumulative version to your LCS project Asset library.
<img decoding="async" loading="lazy" alt="alt text" src="https://automaly.github.io/assets/images/image-a94f70f4e09075ee2b880b695fadaa95.png" width="1134" height="465" class="img_ev3q"></li>
<li>Follow the steps to apply update to cloud environment <a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/deployment/apply-deployable-package-system?context=%2Fdynamics365%2Fcontext%2Fcommerce#apply-a-package-to-a-non-production-environment-by-using-lcs" target="_blank" rel="noopener noreferrer">Apply updates to cloud environments - Finance &amp; Operations | Dynamics 365 | Microsoft Learn</a></li>
</ul>
</li>
</ol>]]></content>
        <author>
            <name>Max Nguyen</name>
            <uri>/about</uri>
        </author>
        <category label="Self-Update" term="Self-Update"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Throw behaviour in X++]]></title>
        <id>https://automaly.github.io/2024/01/07/ThrowBehaviour</id>
        <link href="https://automaly.github.io/2024/01/07/ThrowBehaviour"/>
        <updated>2024-01-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[References]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="references">References<a href="https://automaly.github.io/2024/01/07/ThrowBehaviour#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/dev-ref/xpp-exceptions" target="_blank" rel="noopener noreferrer">X++ exception handling</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-to">How to<a href="https://automaly.github.io/2024/01/07/ThrowBehaviour#how-to" class="hash-link" aria-label="Direct link to How to" title="Direct link to How to">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="prerequisite">Prerequisite<a href="https://automaly.github.io/2024/01/07/ThrowBehaviour#prerequisite" class="hash-link" aria-label="Direct link to Prerequisite" title="Direct link to Prerequisite">​</a></h3>
<p>For the purpose of testing, I had this data set of CustGroup. This can also be found on Legal Entity <code>USRT</code> of demo data comes with a new environment of Dynamics 365 Finance.</p>
<table><thead><tr><th>Customer group</th><th>Description</th></tr></thead><tbody><tr><td>10</td><td>Wholesale customers</td></tr><tr><td>20</td><td>Major customers</td></tr><tr><td>30</td><td>Retail customers</td></tr><tr><td>40</td><td>Internet customers</td></tr><tr><td>50</td><td>Employees</td></tr><tr><td>80</td><td>Wholesale customers</td></tr><tr><td>90</td><td>Wholesale customers</td></tr></tbody></table>
<p>I added two new buttons on <code>CustGroup</code> form:</p>
<ul>
<li><code>Bulk update Desc</code>: This button will loop through each and all records in the above table and update the Description to Description + <code>+ Updated</code> except one containing "Employee". They will become like below.</li>
</ul>
<table><thead><tr><th>Customer group</th><th>Description</th></tr></thead><tbody><tr><td>10</td><td>Wholesale customers + Updated</td></tr><tr><td>20</td><td>Major customers + Updated</td></tr><tr><td>30</td><td>Retail customers + Updated</td></tr><tr><td>40</td><td>Internet customers + Updated</td></tr><tr><td>50</td><td>Employees</td></tr><tr><td>80</td><td>Wholesale customers + Updated</td></tr><tr><td>90</td><td>Wholesale customers + Updated</td></tr></tbody></table>
<ul>
<li><code>Reverse Bulk update Desc</code>: This button will update all Description back to its original by removing the word <code>+ Updated</code>.</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="lets-do-it">Let's do it<a href="https://automaly.github.io/2024/01/07/ThrowBehaviour#lets-do-it" class="hash-link" aria-label="Direct link to Let's do it" title="Direct link to Let's do it">​</a></h3>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="when-we-dont-use-throw">When we don't use <code>throw</code><a href="https://automaly.github.io/2024/01/07/ThrowBehaviour#when-we-dont-use-throw" class="hash-link" aria-label="Direct link to when-we-dont-use-throw" title="Direct link to when-we-dont-use-throw">​</a></h3>
<p>In the extension class named <code>CustGroup_ButtonHandlers</code>, I put these codes which will handle the event of clicking those two buttons.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>This type of <code>FormControlEventHandler</code> will only be needed when you are extending a standard form. For a totally custom form, you can add a <a href="https://learn.microsoft.com/en-us/dotnet/api/dynamics.ax.application.formbuttoncontrol.clicked" target="_blank" rel="noopener noreferrer">Clicked() method</a> method for any buttons on the form.</p></div></div>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">internal</span><span class="token plain"> final </span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">CustGroup_ButtonHandlers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">FormControlEventHandler</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">formControlStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">CustGroup</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">,</span><span class="token attribute attribute-arguments"> BulkUpdateDesc</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">,</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments named-parameter punctuation" style="color:#b6ad9a">FormControlEventType</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">::</span><span class="token attribute attribute-arguments">Clicked</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">BulkUpdateDesc_OnClicked</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">FormControl</span><span class="token plain"> sender</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">FormControlEventArgs</span><span class="token plain"> e</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">FormDataSource</span><span class="token plain"> custGroupDS </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> sender</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">formRun</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">dataSource</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">formDataSourceStr</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">CustGroup</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> CustGroup</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        ttsbegin</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">for</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token class-name">CustGroup</span><span class="token plain"> custGroup </span><span class="token operator" style="color:#063289">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                custGroupDS</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">getFirst</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                custGroupDS</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">getFirst</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                custGroupDS</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">cursor</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> custGroup</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> custGroup </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> custGroupDS</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">getNext</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token keyword" style="color:#728fcb">if</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">strContains</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"Employees"</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                </span><span class="token comment" style="color:#b6ad9a">// Show an error here but do not stop the loop</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                </span><span class="token function" style="color:#b29762">error</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"This group's name contains \"Employees\". Operation skipped but continue until the end of loop."</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                </span><span class="token comment" style="color:#b6ad9a">// Continue the loop by (1) skipping below code and (2) getting the next record from the DS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                </span><span class="token keyword" style="color:#728fcb">continue</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name </span><span class="token operator" style="color:#063289">+</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">" + Updated"</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">doUpdate</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        ttscommit</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        custGroupDS</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">research</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">FormControlEventHandler</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">formControlStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">CustGroup</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">,</span><span class="token attribute attribute-arguments"> BulkRevUpdateDesc</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">,</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments named-parameter punctuation" style="color:#b6ad9a">FormControlEventType</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">::</span><span class="token attribute attribute-arguments">Clicked</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">BulkRevUpdateDesc_OnClicked</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">FormControl</span><span class="token plain"> sender</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">FormControlEventArgs</span><span class="token plain"> e</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">FormDataSource</span><span class="token plain"> custGroupDS </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> sender</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">formRun</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">dataSource</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">formDataSourceStr</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">CustGroup</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> CustGroup</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        ttsbegin</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">for</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token class-name">CustGroup</span><span class="token plain"> custGroup </span><span class="token operator" style="color:#063289">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                custGroupDS</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">getFirst</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                custGroupDS</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">getFirst</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                custGroupDS</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">cursor</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> custGroup</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> custGroup </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> custGroupDS</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">getNext</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token function" style="color:#b29762">strReplace</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">" + Updated"</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">""</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">doUpdate</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        ttscommit</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        custGroupDS</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">research</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Notice the part</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">if</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">strContains</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"Employees"</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">// Show an error here but do not stop the loop</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token function" style="color:#b29762">error</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"This group's name contains \"Employees\". Operation skipped but continue until the end of loop."</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">// Continue the loop by (1) skipping below code and (2) getting the next record from the DS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">continue</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This part will do the job of updating the Description of the CustGroup record. Yet, I am calling <code>error</code> to display a message (which is speicifed as an "error") to users.</p>
<p>Now, let's click the <code>Bulk update Desc</code> button. You will see the error message and the updated description. We can tell that the loop was not stopped.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="https://automaly.github.io/assets/images/image-a63ff1cd1928ab2665c5316fb58c5a99.png" width="686" height="369" class="img_ev3q"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="when-we-use-throw">When we use <code>throw</code><a href="https://automaly.github.io/2024/01/07/ThrowBehaviour#when-we-use-throw" class="hash-link" aria-label="Direct link to when-we-use-throw" title="Direct link to when-we-use-throw">​</a></h3>
<p>Let's change the part mentioned above to this one. Notice that we now will use <code>throw</code> before <code>error</code>.</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">if</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">strContains</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"Employees"</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">// Show an error here and break the loop</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">throw</span><span class="token plain"> </span><span class="token function" style="color:#b29762">error</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"This group's name contains \"Employees\". Operation broken."</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">// Below code line is actually never called because the throw will stop the code execution immediately</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">continue</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Clicking <code>Bulk update Desc</code> will result in this.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="https://automaly.github.io/assets/images/image-1-209c0bb4db028b19e6b9d77a0e477efe.png" width="799" height="379" class="img_ev3q"></p>
<p>Yet, upon refreshing the form, we will see that no transaction within the same <code>tts</code> level was actually committed.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="https://automaly.github.io/assets/images/image-2-9b99948692ef5fe69b8ef8707b68ac34.png" width="802" height="380" class="img_ev3q"></p>
<p>Now if we bring the <code>tts</code> inside the loop.</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">if</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">strContains</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"Employees"</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// Show an error here and break the loop</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">throw</span><span class="token plain"> </span><span class="token function" style="color:#b29762">error</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"This group's name contains \"Employees\". Operation broken."</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// Below code line is actually never called because the throw will stop the code execution immediately</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">continue</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    ttsbegin</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name </span><span class="token operator" style="color:#063289">+</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">" + Updated"</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">doUpdate</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    ttscommit</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Upop refreshing the form, we will see what transaction were commited and what part of the loop was broken.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="https://automaly.github.io/assets/images/image-3-ce59dc84f39ef376679d2cfcd822eaad.png" width="793" height="371" class="img_ev3q"></p>
<p>So, that's how <code>throw</code> works in X++.</p>]]></content>
        <author>
            <name>Kome Hoang</name>
            <uri>https://www.linkedin.com/in/khahgm7</uri>
        </author>
        <category label="throw" term="throw"/>
        <category label="error" term="error"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Using XppPrePostArgs to pass parameters through a method]]></title>
        <id>https://automaly.github.io/2024/01/02/TrickXppPrePostArg</id>
        <link href="https://automaly.github.io/2024/01/02/TrickXppPrePostArg"/>
        <updated>2024-01-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[References]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="references">References<a href="https://automaly.github.io/2024/01/02/TrickXppPrePostArg#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.dynamics.ax.xpp.xppprepostargs" target="_blank" rel="noopener noreferrer">XppPrePostArgs Class (Microsoft.Dynamics.Ax.Xpp)</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-to">How to<a href="https://automaly.github.io/2024/01/02/TrickXppPrePostArg#how-to" class="hash-link" aria-label="Direct link to How to" title="Direct link to How to">​</a></h2>
<p>Take a very safe table to play around: <code>CustGroup</code> (Customer Group), we will see how we can utilise <code>XppPrePostArgs</code> here to save a parameter before the update is commited to the database and then take it out for us to execute futher logic.</p>
<p><em>The tricky part is that such table does not even have an <code>update</code> method.</em></p>
<p>Normally saying, if a method is available on the common, we can navigate to the design of it and copy the <code>Pre-</code> and <code>Post-Event Handler</code> from here.</p>
<p><img decoding="async" loading="lazy" alt="Alt text" src="https://automaly.github.io/assets/images/image-9ac49196845ea45d8044d5affb926a03.png" width="1324" height="721" class="img_ev3q"></p>
<p>Yet, in our example here, such method - <code>update</code> - is not available. So, we can simply make a <a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/extensibility/method-wrapping-coc" target="_blank" rel="noopener noreferrer">Class extension</a> to wrap the <code>common.update()</code> method. The code can be as simple as below.</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">ExtensionOf</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">tableStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">CustGroup</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">final </span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">CustGroup_Extension</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">update</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token return-type class-name">next</span><span class="token plain"> </span><span class="token function" style="color:#b29762">update</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We will then take the original value of <code>CustGroup.Name</code> and save it to the instance of <code>XppPrePostArgs</code>. This part will be under the <code>Pre-Event</code> method. The code is as below.</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">const</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token class-name">str</span><span class="token plain"> OrigNameFld </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"OrigName"</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">PreHandlerFor</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">classStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">CustGroup_Extension</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">,</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments function" style="color:#b29762">methodStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">CustGroup_Extension</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">,</span><span class="token attribute attribute-arguments"> update</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">CustGroup_Extension_Pre_update</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">XppPrePostArgs</span><span class="token plain"> args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">// Get custGroup buffer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">// No super() has been called, so the changes have not been committed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token class-name">CustGroup</span><span class="token plain"> custGroup </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> args</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">getThis</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">// Get original value of field Name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token class-name">Description</span><span class="token plain"> origName </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">orig</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">// Save the value to args</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    args</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">setArg</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        OrigNameFld</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> origName</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After the changes are commited to the database, we will take the saved parm out and execute our logic. In this case, I will assess if the new <code>CustGroup.Name</code> contains <code>"Kome"</code>, if it does, revert it back to its original value and throw message. This part will be under <code>Post-Event</code> method. The code is as below (I will show the whole class so we can see how the parm is passed by using <code>setArg</code> and <code>getArg</code>)</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">internal</span><span class="token plain"> final </span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">CustGroup_EventHandlers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">const</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token class-name">str</span><span class="token plain"> OrigNameFld </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"OrigName"</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">PreHandlerFor</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">classStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">CustGroup_Extension</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">,</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments function" style="color:#b29762">methodStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">CustGroup_Extension</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">,</span><span class="token attribute attribute-arguments"> update</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">CustGroup_Extension_Pre_update</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">XppPrePostArgs</span><span class="token plain"> args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// Get custGroup buffer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// No super() has been called, so the changes have not been committed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">CustGroup</span><span class="token plain"> custGroup </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> args</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">getThis</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// Get original value of field Name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">Description</span><span class="token plain"> origName </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> custGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">orig</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// Save the value to args</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        args</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">setArg</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            OrigNameFld</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> origName</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">PostHandlerFor</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">classStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">CustGroup_Extension</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">,</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments function" style="color:#b29762">methodStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">CustGroup_Extension</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">,</span><span class="token attribute attribute-arguments"> update</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">CustGroup_Extension_Post_update</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">XppPrePostArgs</span><span class="token plain"> args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// Get custGroup buffer and its column Name after updated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">CustGroup</span><span class="token plain"> newCustGroup </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> args</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">getThis</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">Description</span><span class="token plain"> newName </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> newCustGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// Assess and revert</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">if</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">Global</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">strContains</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">newName</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"Kome"</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            ttsbegin</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                </span><span class="token comment" style="color:#b6ad9a">// Get the saved parm here and set it to the field value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                newCustGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Name </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> args</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">getArg</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">OrigNameFld</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                newCustGroup</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">doUpdate</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            ttscommit</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            Global</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">info</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">strFmt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"New description - \"%1\" - contains \"Kome\". Reverted to its original."</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> newName</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And, so, we can test it out by setting a new <code>Description</code> for a <code>Customer group</code>...</p>
<p><img decoding="async" loading="lazy" alt="Alt text" src="https://automaly.github.io/assets/images/image-1-f8ac2eb0903aef13b35084402fdd836f.png" width="696" height="365" class="img_ev3q"></p>
<p>...upon clicking on button <code>Save</code>, the original value will be updated and a message will be thrown.</p>
<p><img decoding="async" loading="lazy" alt="Alt text" src="https://automaly.github.io/assets/images/image-2-8fab8a3dbf53969cdaf8cea7caed87de.png" width="673" height="372" class="img_ev3q"></p>]]></content>
        <author>
            <name>Kome Hoang</name>
            <uri>https://www.linkedin.com/in/khahgm7</uri>
        </author>
        <category label="XppPrePostArgs" term="XppPrePostArgs"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Using Kusto functions in Power BI datasource]]></title>
        <id>https://automaly.github.io/2024/01/04/KustoVsPBI</id>
        <link href="https://automaly.github.io/2024/01/04/KustoVsPBI"/>
        <updated>2024-01-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[References]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="references">References<a href="https://automaly.github.io/2024/01/04/KustoVsPBI#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/data-explorer/power-bi-data-connector?tabs=web-ui" target="_blank" rel="noopener noreferrer">Use Azure Data Explorer data in Power BI</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/data-explorer/kusto/management/create-function" target="_blank" rel="noopener noreferrer">.create function command</a></li>
<li><a href="https://dataexplorer.azure.com/home" target="_blank" rel="noopener noreferrer">Azure Data Explorer</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/" target="_blank" rel="noopener noreferrer">Kusto Query Language (KQL)</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-to">How to<a href="https://automaly.github.io/2024/01/04/KustoVsPBI#how-to" class="hash-link" aria-label="Direct link to How to" title="Direct link to How to">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="lets-create-demo-data-for-testing">Let's create demo data for testing<a href="https://automaly.github.io/2024/01/04/KustoVsPBI#lets-create-demo-data-for-testing" class="hash-link" aria-label="Direct link to Let's create demo data for testing" title="Direct link to Let's create demo data for testing">​</a></h3>
<p>For the purpose of testing and demonstrating, I will create a new table in my testing ADX cluster (everyone can create their own free cluster following <a href="https://learn.microsoft.com/en-us/azure/data-explorer/start-for-free-web-ui" target="_blank" rel="noopener noreferrer">Create a free Azure Data Explorer cluster</a>). Let's call it <code>UserAsset</code>.</p>
<p>The table will have two fields:</p>
<ul>
<li><code>User</code> - type <code>string</code></li>
<li><code>NumberOfLaptop</code> - type <code>integer</code></li>
</ul>
<p>The script is as below.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token keyword" style="color:#728fcb">create</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">table</span><span class="token plain"> UserAsset </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">User</span><span class="token plain">: string</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> NumberOfLaptop: </span><span class="token keyword" style="color:#728fcb">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then, we will put some demo data into the table.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ingest inline </span><span class="token keyword" style="color:#728fcb">into</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">table</span><span class="token plain"> UserAsset </span><span class="token operator" style="color:#063289">&lt;</span><span class="token operator" style="color:#063289">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">Max</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token number" style="color:#063289">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">Kome</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token number" style="color:#063289">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We will have the table and its data like below.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">UserAsset</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token operator" style="color:#063289">|</span><span class="token plain"> project</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">User</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> NumberOfLaptop</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> IngestedOn </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> ingestion_time</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token operator" style="color:#063289">|</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">order</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">by</span><span class="token plain"> NumberOfLaptop </span><span class="token keyword" style="color:#728fcb">desc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="Kusto table and data" src="https://automaly.github.io/assets/images/image-cddcf7e80e46384a2e6d7435472c16e0.png" width="588" height="336" class="img_ev3q"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="get-data-from-azure-data-explorer-adx-to-power-bi-pbi">Get data from Azure Data Explorer (ADX) to Power BI (PBI)<a href="https://automaly.github.io/2024/01/04/KustoVsPBI#get-data-from-azure-data-explorer-adx-to-power-bi-pbi" class="hash-link" aria-label="Direct link to Get data from Azure Data Explorer (ADX) to Power BI (PBI)" title="Direct link to Get data from Azure Data Explorer (ADX) to Power BI (PBI)">​</a></h3>
<p>Simple enough, we then can use the very Kusto query (KQ) in PBI Desktop to get such data.</p>
<p><img decoding="async" loading="lazy" alt="Add new datasource in PBID" src="https://automaly.github.io/assets/images/image-1-c29f624585460bf259a436820d09ff91.png" width="941" height="746" class="img_ev3q"></p>
<p>We can copy the query here.</p>
<p><img decoding="async" loading="lazy" alt="Add query to datasource" src="https://automaly.github.io/assets/images/image-2-7bf59f241f0d2ca88b42cd62a7141ce4.png" width="700" height="557" class="img_ev3q"></p>
<p>Upon clicking OK and transform the data, we will have the data available. Notice that whole KQ will be put as plain text in the source.</p>
<p><img decoding="async" loading="lazy" alt="Alt text" src="https://automaly.github.io/assets/images/image-3-7f798d5e223bffda62d5253d65eacbc9.png" width="1659" height="378" class="img_ev3q"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-kusto-function-to-simplify-the-process">Using Kusto function to simplify the process<a href="https://automaly.github.io/2024/01/04/KustoVsPBI#using-kusto-function-to-simplify-the-process" class="hash-link" aria-label="Direct link to Using Kusto function to simplify the process" title="Direct link to Using Kusto function to simplify the process">​</a></h3>
<p>Now, we can create a function to get data from ADX to PBI Desktop.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token keyword" style="color:#728fcb">create</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">function</span><span class="token plain"> GetDataForPBI</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    UserAsset</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token operator" style="color:#063289">|</span><span class="token plain"> project</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">User</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> NumberOfLaptop</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> IngestedOn </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> ingestion_time</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token operator" style="color:#063289">|</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">order</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">by</span><span class="token plain"> NumberOfLaptop </span><span class="token keyword" style="color:#728fcb">desc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="Create function" src="https://automaly.github.io/assets/images/image-4-d7cf06d1a8cd6aba90fff8002d58e30c.png" width="1411" height="341" class="img_ev3q"></p>
<p>Then, we can simply call the function from PBI to get the data instead of calling the whole query.</p>
<p><img decoding="async" loading="lazy" alt="Getting data using function" src="https://automaly.github.io/assets/images/image-5-b0b03146315759c18e1c6e5d0ac0fa96.png" width="1487" height="203" class="img_ev3q"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="enhacing-data-by-altering-the-function">Enhacing data by altering the function<a href="https://automaly.github.io/2024/01/04/KustoVsPBI#enhacing-data-by-altering-the-function" class="hash-link" aria-label="Direct link to Enhacing data by altering the function" title="Direct link to Enhacing data by altering the function">​</a></h3>
<p>We can even passing parameters to the functions to alter the data. In this case, let's try adding some texts to User. My function would become as below:</p>
<ul>
<li>Taking a boolean input <code>_addText</code>, it is defaulted to <code>false</code></li>
<li>If <code>_addText</code> is true, add some text to <code>User</code></li>
<li>Else, leave <code>User</code> as it is</li>
</ul>
<p><em>Notice that we will need to use <code>create-or-alter</code> because the function is existing already.</em></p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token keyword" style="color:#728fcb">create</span><span class="token operator" style="color:#063289">-</span><span class="token operator" style="color:#063289">or</span><span class="token operator" style="color:#063289">-</span><span class="token keyword" style="color:#728fcb">alter</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">function</span><span class="token plain"> GetDataForPBI</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_addText:</span><span class="token keyword" style="color:#728fcb">bool</span><span class="token plain"> </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">false</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">UserAsset</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token operator" style="color:#063289">|</span><span class="token plain"> extend</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">User</span><span class="token plain"> </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> iff</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        _addText</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> strcat</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token keyword" style="color:#728fcb">User</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"-AddedText"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">User</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token operator" style="color:#063289">|</span><span class="token plain"> project</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">User</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> NumberOfLaptop</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> IngestedOn </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> ingestion_time</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token operator" style="color:#063289">|</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">order</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">by</span><span class="token plain"> NumberOfLaptop </span><span class="token keyword" style="color:#728fcb">desc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then, we can call the function from PBI and add the parameter to see how the data is reflected.</p>
<p><img decoding="async" loading="lazy" alt="Function with parameters" src="https://automaly.github.io/assets/images/image-6-95bc3715135de749a43a20ea10c94af7.png" width="1303" height="219" class="img_ev3q"></p>
<p>We can even add new columns from ADX and the new data will be reflected on PBI. For example, I will add a column (with emoji) to indicate someone is owning more than one laptop.</p>
<p>My function will become as below.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token keyword" style="color:#728fcb">create</span><span class="token operator" style="color:#063289">-</span><span class="token operator" style="color:#063289">or</span><span class="token operator" style="color:#063289">-</span><span class="token keyword" style="color:#728fcb">alter</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">function</span><span class="token plain"> GetDataForPBI</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_addText:</span><span class="token keyword" style="color:#728fcb">bool</span><span class="token plain"> </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">false</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    UserAsset</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token operator" style="color:#063289">|</span><span class="token plain"> extend</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">User</span><span class="token plain"> </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> iff</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            _addText</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> strcat</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                </span><span class="token keyword" style="color:#728fcb">User</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"-AddedText"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">User</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token operator" style="color:#063289">|</span><span class="token plain"> project</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">User</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> NumberOfLaptop</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> IngestedOn </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> ingestion_time</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> OwningMoreThanOneLaptop </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> iff</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            NumberOfLaptop </span><span class="token operator" style="color:#063289">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#063289">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"💻+"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">""</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token operator" style="color:#063289">|</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">order</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">by</span><span class="token plain"> NumberOfLaptop </span><span class="token keyword" style="color:#728fcb">desc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Upon refreshing the source, we can see the new column coming up.</p>
<p><img decoding="async" loading="lazy" alt="New column from Kusto" src="https://automaly.github.io/assets/images/image-7-1bb6ec8dcfa51fae453aa3ae76fa7f3f.png" width="1306" height="230" class="img_ev3q"></p>]]></content>
        <author>
            <name>Kome Hoang</name>
            <uri>https://www.linkedin.com/in/khahgm7</uri>
        </author>
        <category label="Kusto" term="Kusto"/>
        <category label="Power BI" term="Power BI"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[No data is inserted/modified in temporary table when processing an SRS report using Pre-process]]></title>
        <id>https://automaly.github.io/2024/01/04/NoDataInTmpTableForPreProcessReport</id>
        <link href="https://automaly.github.io/2024/01/04/NoDataInTmpTableForPreProcessReport"/>
        <updated>2024-01-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[References]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="references">References<a href="https://automaly.github.io/2024/01/04/NoDataInTmpTableForPreProcessReport#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/dynamicsax-2012/appuser-itpro/tips-to-help-prevent-long-running-reports-from-timing-out#use-pre-processed-rdp-classes" target="_blank" rel="noopener noreferrer">Use pre-processed RDP classes</a></li>
<li><a href="https://www.microsoft.com/en-us/download/details.aspx?id=27725" target="_blank" rel="noopener noreferrer">Microsoft Dynamics AX 2012 White Paper: Report Programming Model</a></li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-to">How to<a href="https://automaly.github.io/2024/01/04/NoDataInTmpTableForPreProcessReport#how-to" class="hash-link" aria-label="Direct link to How to" title="Direct link to How to">​</a></h2>
<p>Pre-process RDP has become very commonplace these days, especially to ones who work with SSRS reports on Dynamics 365 FO a lot.</p>
<p>Recently, I faced an issue when no data was inserted into or modififed in my temporary table during run-time despite the fact that RDP class (and its related ones within the same framework) was executed successfully. Even debugging did not show me what was going wrong. There was simply no SQL statements in the trace that I captured.</p>
<p>Turned out that I will need to take ownership of the temp table instance before manipulating any data in it.</p>
<p>My code used to be (when it did not work):</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">internal</span><span class="token plain"> final </span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">CSG_PostedServiveOrderWithoutInvDP</span><span class="token plain"> </span><span class="token return-type class-name">extends</span><span class="token plain"> SrsReportDataProviderPreProcessTempDB</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token class-name">CSG_PostedServiveOrderWithoutInvTmp</span><span class="token plain">           tmpTable</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">SRSReportDataSetAttribute</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">tableStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">CSG_PostedServiveOrderWithoutInvTmp</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name">CSG_PostedServiveOrderWithoutInvTmp</span><span class="token plain"> </span><span class="token function" style="color:#b29762">getTmpTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">select</span><span class="token plain"> tmpTable</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">return</span><span class="token plain"> tmpTable</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">processReport</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        ttsbegin</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">populateTmpTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        ttscommit</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">populateTmpTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// Insert data to tmp table here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I would need to call out to <code>SrsReportDataProviderPreProcessTempDB.takeOwnershipOfTempTable()</code> to have it work.</p>
<p>My code then became:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">internal</span><span class="token plain"> final </span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">CSG_PostedServiveOrderWithoutInvDP</span><span class="token plain"> </span><span class="token return-type class-name">extends</span><span class="token plain"> SrsReportDataProviderPreProcessTempDB</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token class-name">CSG_PostedServiveOrderWithoutInvTmp</span><span class="token plain">           tmpTable</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">SRSReportDataSetAttribute</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">tableStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">CSG_PostedServiveOrderWithoutInvTmp</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name">CSG_PostedServiveOrderWithoutInvTmp</span><span class="token plain"> </span><span class="token function" style="color:#b29762">getTmpTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">select</span><span class="token plain"> tmpTable</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">return</span><span class="token plain"> tmpTable</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">processReport</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        ttsbegin</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// Take ownership of each and all tmpTable before using them in the RDP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">takeOwnershipTmp</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// Data manipulation then can be conducted without an issue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">populateTmpTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        ttscommit</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">takeOwnershipTmp</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// Take ownership of the current instance of tmpTable here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">takeOwnershipOfTempTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">tmpTable</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">populateTmpTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// Insert data to tmp table here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The code behind the <code>SrsReportDataProviderPreProcessTempDB.takeOwnershipOfTempTable()</code> is as below (for ones who might want to implement their own framework):</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token comment" style="color:#b6ad9a">/// &lt;summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">/// Takes ownership of the given temp table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">/// &lt;/summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">/// &lt;param name="_tempDbTable"&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">/// The table to take ownership of.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">/// &lt;/param&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">takeOwnershipOfTempTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">Common</span><span class="token plain"> _tempDbTable</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">DictTable</span><span class="token plain"> dictTable</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">TableId</span><span class="token plain"> tableId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token preprocessor property" style="color:#b29762">#SRSFramework</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token operator" style="color:#063289">!</span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">parmUseDefaultTransactionOnly</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            _tempDbTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">setConnection</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">parmUserConnection</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        tableId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> _tempDbTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">TableId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        dictTable </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">DictTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">tableId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">if</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token operator" style="color:#063289">!</span><span class="token plain">dictTable</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token keyword" style="color:#728fcb">throw</span><span class="token plain"> </span><span class="token function" style="color:#b29762">error</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">strFmt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"@SYS4007193"</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token function" style="color:#b29762">tableId2name</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">tableId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">ExecutePermission</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">assert</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        dictTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">callObject</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">#TempDBMethodName_TakeOwnership</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _tempDbTable</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        CodeAccessPermission</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">revertAssert</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>Kome Hoang</name>
            <uri>https://www.linkedin.com/in/khahgm7</uri>
        </author>
        <category label="SRS" term="SRS"/>
        <category label="Pre-process" term="Pre-process"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Set default model for Dynamics 365 Finance Operations project]]></title>
        <id>https://automaly.github.io/2023/12/26/set-default-model-for-d365-project</id>
        <link href="https://automaly.github.io/2023/12/26/set-default-model-for-d365-project"/>
        <updated>2023-12-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Open Run]]></summary>
        <content type="html"><![CDATA[<p>Open <strong>Run</strong></p>
<p>VS2017 and prior <code>%UserProfile%/Documents/Visual Studio 2015\settings\</code></p>
<p>VS2019 and later <code>%UserProfile%/Documents/Visual Studio Dynamics 365</code></p>
<p>Open <code>DynamicsDevConfig.XML</code>, change the default model in <code>DefaultModelForNewProjects</code> property</p>
<div class="language-XML language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockTitle_Ktv7">DynamicsDevConfig.XML</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token prolog" style="color:#b6ad9a">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">DynamicsDevConfig</span><span class="token tag" style="color:#063289"> </span><span class="token tag attr-name namespace" style="color:#896724;opacity:0.7">xmlns:</span><span class="token tag attr-name" style="color:#896724">i</span><span class="token tag attr-value punctuation attr-equals" style="color:#b6ad9a">=</span><span class="token tag attr-value punctuation" style="color:#b6ad9a">"</span><span class="token tag attr-value" style="color:#728fcb">http://www.w3.org/2001/XMLSchema-instance</span><span class="token tag attr-value punctuation" style="color:#b6ad9a">"</span><span class="token tag" style="color:#063289"> </span><span class="token tag attr-name" style="color:#896724">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:#b6ad9a">=</span><span class="token tag attr-value punctuation" style="color:#b6ad9a">"</span><span class="token tag attr-value" style="color:#728fcb">http://schemas.microsoft.com/dynamics/2012/03/development/configuration</span><span class="token tag attr-value punctuation" style="color:#b6ad9a">"</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">AddInPaths</span><span class="token tag" style="color:#063289"> </span><span class="token tag attr-name namespace" style="color:#896724;opacity:0.7">xmlns:</span><span class="token tag attr-name" style="color:#896724">d2p1</span><span class="token tag attr-value punctuation attr-equals" style="color:#b6ad9a">=</span><span class="token tag attr-value punctuation" style="color:#b6ad9a">"</span><span class="token tag attr-value" style="color:#728fcb">http://schemas.microsoft.com/2003/10/Serialization/Arrays</span><span class="token tag attr-value punctuation" style="color:#b6ad9a">"</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">		</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag namespace" style="color:#063289;opacity:0.7">d2p1:</span><span class="token tag" style="color:#063289">string</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain">T:\Bin\AddInExtensions</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag namespace" style="color:#063289;opacity:0.7">d2p1:</span><span class="token tag" style="color:#063289">string</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	........</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">DBSyncInBuild</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">DBSyncInBuild</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">DatabaseServer</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain">localhost</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">DatabaseServer</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">DefaultCompany</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">DefaultCompany</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line theme-code-block-highlighted-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">DefaultModelForNewProjects</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain">FleetManagement</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">DefaultModelForNewProjects</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">DefaultWebBrowser</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain">Google Chrome</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">DefaultWebBrowser</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">DisableBPCheck</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain">false</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">DisableBPCheck</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">DisableFormStaticCompile</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain">false</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">DisableFormStaticCompile</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">EmitTraceEvents</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">EmitTraceEvents</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">EnableNativeDebugging</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain">false</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">EnableNativeDebugging</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">EnableOfflineAuthentication</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">EnableOfflineAuthentication</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">EnableSymbolLoadingForSolutionOnly</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain">true</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">EnableSymbolLoadingForSolutionOnly</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;</span><span class="token tag" style="color:#063289">FallbackToNativeSync</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain">false</span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">FallbackToNativeSync</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">	.......</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token tag punctuation" style="color:#b6ad9a">&lt;/</span><span class="token tag" style="color:#063289">DynamicsDevConfig</span><span class="token tag punctuation" style="color:#b6ad9a">&gt;</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>Max Nguyen</name>
            <uri>/about</uri>
        </author>
        <category label="Development tools" term="Development tools"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[How to hide New and Delete buttons (command buttons) in form]]></title>
        <id>https://automaly.github.io/2023/12/21/How-to-hide-New-and-Delete-buttons-in-form-1</id>
        <link href="https://automaly.github.io/2023/12/21/How-to-hide-New-and-Delete-buttons-in-form-1"/>
        <updated>2023-12-21T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[We can change the form design property Show Delete Button, Show New Button  to No.]]></summary>
        <content type="html"><![CDATA[<p>We can change the form design property <code>Show Delete Button</code>, <code>Show New Button</code>  to <code>No</code>.</p>
<p><img decoding="async" loading="lazy" alt="Alt text" src="https://automaly.github.io/assets/images/image-b93de342b1bb7666979755d23d42f29f.png" width="1468" height="531" class="img_ev3q"></p>
<p>Or using X++ code in form's init method</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">Form</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">DEV_TestForm</span><span class="token plain"> </span><span class="token return-type class-name">extends</span><span class="token plain"> FormRun</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">init</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">form</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">design</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">showNewButton</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token number" style="color:#063289">0</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">form</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">design</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">showDeleteButton</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token number" style="color:#063289">0</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token function" style="color:#b29762">super</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For COC Extension</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">ExtensionOf</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">formStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">SMAServiceOrderTable</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">final </span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">SMAServiceOrderTable_Form_DEV_Extension</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">init</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">form</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">design</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">showNewButton</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token number" style="color:#063289">0</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">form</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">design</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">showDeleteButton</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token number" style="color:#063289">0</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token return-type class-name">next</span><span class="token plain"> </span><span class="token function" style="color:#b29762">init</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>Max Nguyen</name>
            <uri>/about</uri>
        </author>
        <category label="Self-Update" term="Self-Update"/>
        <category label="quality update" term="quality update"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[How to get FinOps Azure storage blob connection string]]></title>
        <id>https://automaly.github.io/2022/10/27/how-to-get-d365-azure-blob-storage-str</id>
        <link href="https://automaly.github.io/2022/10/27/how-to-get-d365-azure-blob-storage-str"/>
        <updated>2022-10-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In Dynamics 365 for Finance and Operations Azure storage is used to]]></summary>
        <content type="html"><![CDATA[<p>In Dynamics 365 for Finance and Operations Azure storage is used to</p>
<ul>
<li>Store files for <a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management" target="_blank" rel="noopener noreferrer">Attachments</a></li>
<li><a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/data-entities/data-import-export-job" target="_blank" rel="noopener noreferrer">Data import and export jobs</a></li>
<li>When FinOps prints a report via <a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/analytics/document-reporting-services?context=%2Fdynamics365%2Fcontext%2Fcommerce" target="_blank" rel="noopener noreferrer">Document Reporting Services</a>, SSRS Reporting Services generates an <a href="https://ax.docentric.com/printing-reports-with-custom-fonts-in-dynamics-365-for-finance-and-operations/" target="_blank" rel="noopener noreferrer">EMF image</a> for each page of the generated document. FinOps then temporarily saves the generated EMF files to Azure Blob storage.</li>
<li><a href="https://learn.microsoft.com/en-us/dynamicsax-2012/appuser-itpro/print-a-report-from-the-archive" target="_blank" rel="noopener noreferrer">Printing archive</a></li>
</ul>
<p>And more!</p>
<p>If you are using tier 1 Cloud-Hosted environment, you can find the azure storage from the Azure resource group in Azure portal.</p>
<p>For tier 1, UAT tier 2, and PROD Tier 3, you can create a runnable class and execute to get the Azure storage connection string.</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">Microsoft</span><span class="token namespace punctuation" style="opacity:0.7;color:#b6ad9a">.</span><span class="token namespace" style="opacity:0.7">Dynamics</span><span class="token namespace punctuation" style="opacity:0.7;color:#b6ad9a">.</span><span class="token namespace" style="opacity:0.7">Clx</span><span class="token namespace punctuation" style="opacity:0.7;color:#b6ad9a">.</span><span class="token namespace" style="opacity:0.7">ServicesWrapper</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">GetAzureBlob</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">Args</span><span class="token plain"> _args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token function" style="color:#b29762">info</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">'AzureStorageConnectionString </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> ' </span><span class="token operator" style="color:#063289">+</span><span class="token plain"> CloudInfrastructure</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">GetCsuStorageConnectionString</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token function" style="color:#b29762">info</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">'ClientCertificateThumbprint </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> ' </span><span class="token operator" style="color:#063289">+</span><span class="token plain"> CloudInfrastructure</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">GetCsuClientCertificateThumbprint</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Once you have the connection string, you can connect it to <a href="https://docs.microsoft.com/en-us/azure/vs-azure-tools-storage-manage-with-storage-explorer?tabs=windows" target="_blank" rel="noopener noreferrer">MS Azure Storage Explorer</a>, Power Automate, or consuming in any framwork/language for integration/backup purposes.</p>]]></content>
        <author>
            <name>Max Nguyen</name>
            <uri>/about</uri>
        </author>
        <category label="Azure storage connection string" term="Azure storage connection string"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[How to skip standard code in Dynamics 365 finance and operations]]></title>
        <id>https://automaly.github.io/2020/04/09/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations</id>
        <link href="https://automaly.github.io/2020/04/09/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations"/>
        <updated>2020-04-09T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Disclaimers: Try at your own risk, this is consider as a bug and it will be fixed soon.]]></summary>
        <content type="html"><![CDATA[<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Disclaimers: Try at your own risk, this is consider as a bug and it will be fixed soon.</p></div></div>
<p>According to this MS article about Chain Of Command <a href="https://docs.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/extensibility/method-wrapping-coc#wrapper-methods-must-always-call-next" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/extensibility/method-wrapping-coc#wrapper-methods-must-always-call-next</a></p>
<blockquote>
<p>"Wrapper methods must always call next Wrapper methods in an extension class must always call next, so that the next method in the chain and, finally, the original implementation are always called. This restriction helps guarantee that every method in the chain contributes to the result. In the current implementation of this restriction, the call to next must be in the first-level statements in the method body."</p>
</blockquote>
<p>So as described in the article, the Chain Of Command in Dynamics 365 finance and operations is used to add the logic before or after a method of a class is invoked and the original method will always be executed due to the compulsory of the next statement.
When doing some implementations, we found out that there is a tricky way to completely <strong>ignore</strong> the execution of the original method of the class that is extended.</p>
<p>Please see below for more details:
For example, I created a project and add a new runnable class named Alex:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">TestClass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">Args</span><span class="token plain"> _args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">throw</span><span class="token plain"> error </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"Hello World"</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When this class runs, a <em>Hello World</em> info message will be displayed in the FinOps UI. Then I used chain of command to create Alex_Extension class that extends this class and "override" the main method of the Alex's class by putting the next call into another method and never call it like this:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">ExtensionOf</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">classStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">TestClass</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">final </span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">Alex_Extension</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">Args</span><span class="token plain"> _args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">//Implement something here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        info </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"Ok"</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">ignore</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token return-type class-name">next</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When I run the <em>AlexExtension</em>, the original main method of the Alex class will be ignored and only the additional block of code that I wrote in the <em>AlexExtension</em> class will be executed, so only the <strong>OK</strong> info will appear.</p>
<p>Now we will try with a sample scenario from D365 Finance and Operation. In <strong>General Ledger</strong> Module, we have <strong>General journals</strong> form</p>
<p><img decoding="async" loading="lazy" alt="Image" src="https://automaly.github.io/assets/images/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations-66c51bb573c0657ebc959a0ad40005b7.png" width="975" height="407" class="img_ev3q"></p>
<p>When you click the button for <strong>Journal Print</strong>, the menu item will be triggered and point to the controller name: <em>LedgerJournalController</em> with <em>LedgerJournalController</em> class and the report will be generated.</p>
<p>I will use COC to “override” the main method of <em>LedgerJournalController</em> class by applying the method above:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token attribute class-name">ExtensionOf</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments function" style="color:#b29762">classStr</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">(</span><span class="token attribute attribute-arguments">LedgerJournalController</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token attribute attribute-arguments punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">final </span><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">Alex_LedgerJournalController_Extension</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">Args</span><span class="token plain"> _args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token function" style="color:#b29762">info</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"ok"</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">ignore_first</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token return-type class-name">next</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain">  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Using this I will ignore the the main method of <em>LedgerJournalController</em> class and instead of generate the report, the result will be only the <strong>OK</strong> info line in the extension class:</p>
<p><img decoding="async" loading="lazy" alt="Image" src="https://automaly.github.io/assets/images/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations-1-eea78f76c5b15f296a3f509856449709.png" width="975" height="408" class="img_ev3q"></p>
<p>This is a little bit tricky because we still call next in our extension class as per the requirement of COC, but as we never call the method that "wrap" the next call so it will not be executed. You can try this to simply ignore or rewrite a method of a class in FinOps.</p>
<p>Thank you for reading.</p>]]></content>
        <author>
            <name>Max Nguyen</name>
            <uri>/about</uri>
        </author>
        <category label="Chain of Command" term="Chain of Command"/>
        <category label="Dynamics 365 finance and operations" term="Dynamics 365 finance and operations"/>
        <category label="skip standard code" term="skip standard code"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Set up a VHD for finance and operations apps]]></title>
        <id>https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine</id>
        <link href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine"/>
        <updated>2020-04-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[1. Download Dynamics 365 finance and operations VHD files]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-download-dynamics-365-finance-and-operations-vhd-files">1. Download Dynamics 365 finance and operations VHD files<a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#1-download-dynamics-365-finance-and-operations-vhd-files" class="hash-link" aria-label="Direct link to 1. Download Dynamics 365 finance and operations VHD files" title="Direct link to 1. Download Dynamics 365 finance and operations VHD files">​</a></h2>
<ul>
<li>
<p>Go to the LCS main page and select <strong>Shared asset library</strong> or go to Shared Asset Library.</p>
</li>
<li>
<p>Select the asset type <strong>Downloadable VHD</strong>.</p>
</li>
<li>
<p>Find the VHD you are looking for based on the desired Finance and Operation version. The VHD is divided into multiple file parts that you need to download. For example, the asset files that start with "VHD - 10.0.5" are the different files you need in order to install version 10.0.5.</p>
</li>
<li>
<p>Download all files (parts) associated with the desired VHD to a local folder.</p>
</li>
<li>
<p>After the download is complete, run the executable file that you downloaded, accept the software license agreement, and choose a file path to extract the VHD to.</p>
</li>
<li>
<p>This creates a local VHD file that you can use to run a local virtual machine.</p>
</li>
<li>
<p>Sign in to the VM by using the following credentials:</p>
<ul>
<li>User name: <strong>Administrator</strong></li>
<li>Password: <strong>pass@word1</strong></li>
</ul>
</li>
</ul>
<ul>
<li>Provision the administrator user.</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>For security reasons the reply URL setup for AAD was changed, The <code>Admin user provisioning tool</code> is deleted from 10.0.24 <strong>cloud hosted</strong> VM. More info here <a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/dev-tools/access-instances#frequently-asked-questions" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/dev-tools/access-instances#frequently-asked-questions</a>.</p><p>You still have it in the VHD machine.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-extend-the-evaluattion-license">2. Extend the Evaluattion license<a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#2-extend-the-evaluattion-license" class="hash-link" aria-label="Direct link to 2. Extend the Evaluattion license" title="Direct link to 2. Extend the Evaluattion license">​</a></h2>
<ul>
<li>Run cmd with Admin right.</li>
<li>Run <code>slmgr -dli</code> to check the current period status.</li>
</ul>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockTitle_Ktv7">slmgr -dli</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">Name: Windows</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">R</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> ServerDatacenterEval edition</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">Description: Windows</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">R</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> Operating System</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> TIMEBASED_EVAL channel</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">Partial Product Key: H6F8M</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">License Status: Licensed</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">Timebased activation expiration: 259199 minute</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">180 day</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Run <code>slmgr –rearm</code> to extend the evaluation period.</li>
<li>Run <code>slmgr –dlv</code> to see how many extensions do you have left. You can only extend the license a limited number of times.</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-rename-vm">3. Rename VM<a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#3-rename-vm" class="hash-link" aria-label="Direct link to 3. Rename VM" title="Direct link to 3. Rename VM">​</a></h2>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Update 2023</div><div class="admonitionContent_BuS1"><p>From the VHD 10.0.29 version, the VHD name named with the version of it own, before that the computer name always <strong>MININT-F36S5EH</strong>. So we don't have to remane the VM everytime we deploy a new VHD.
<img decoding="async" loading="lazy" alt="VHD 10.0.29" src="https://automaly.github.io/assets/images/DVHD10029-aa84e7dce39e7502f67e24b0c6199853.png" title="VHD 10.0.29" width="524" height="277" class="img_ev3q"></p></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Reference</div><div class="admonitionContent_BuS1"><p><a href="https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/migration-upgrade/vso-machine-renaming" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/migration-upgrade/vso-machine-renaming</a></p></div></div>
<ul>
<li>
<p>Rename and restart the machine before you start development or connect to Azure DevOps.</p>
</li>
<li>
<p>Update the server name in SQL Server</p>
<ul>
<li>The default credential for SQL server is <strong>axdbadmin</strong> and password <strong>AOSWebSite@12</strong></li>
</ul>
</li>
</ul>
<p>You can also see the password (<code>DataAccess.AxAdminSqlPwd</code>) in the <code>C:\AOSService\webroot\web.config</code></p>
<p>To decrypt run this command:</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">C:\AOSService\webroot\bin\Microsoft</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Dynamics</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">AX</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Framework</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ConfigEncryptor</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">exe </span><span class="token operator" style="color:#063289">-</span><span class="token plain">decrypt C:\AOSService\webroot\web</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To encrypt run this command:</p>
<p><code>C:\AOSService\webroot\bin\Microsoft.Dynamics.AX.Framework.ConfigEncryptor.exe -encrypt C:\AOSService\webroot\web.config</code></p>
<p>If you see the error</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>error</div><div class="admonitionContent_BuS1"><p>No certificate found for id '7366E25DC94FA8A400FA0037FFF3BB300D9482D4'</p></div></div>
<p>Please follow <a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#7-for-vhd-that-was-released-for-versions-10024-and-later">this step</a> first.</p>
<ul>
<li>
<p>Run following query</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockTitle_Ktv7">MININT-57EHFHJ</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token plain">sp_dropserver </span><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token plain">old_name</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">sp_addserver </span><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token plain">new_name</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">local</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p>In these commands, be sure to replace old_name with the old name of the server and new_name with the new name. By default, the old name is <code>MININT-F36S5EH</code>, but you can run select @@servername to get the old name. Additionally, be sure to restart the SQL Server service after the commands have finished running.</p>
<ul>
<li>
<p>Restart SQL service</p>
</li>
<li>
<p>Open Reporting Services Configuration Manager for SQL Server 2016, then <strong>Select Database</strong>, select <strong>Change Database</strong>, and use the new server name.</p>
</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="update-financial-reporting">Update financial reporting<a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#update-financial-reporting" class="hash-link" aria-label="Direct link to Update financial reporting" title="Direct link to Update financial reporting">​</a></h3>
<p>Go to LCS portal and download a one version package, we will need the scripts from it. Open a Microsoft Windows PowerShell command window as an admin, and run the following command. This command contains the default passwords that might have to be updated. Be sure to replace <strong>new_name</strong> with the new name.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">cd &lt;update folder&gt;\MROneBox\Scripts\Update\ConfigureMRDatabase</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ps1 </span><span class="token operator" style="color:#063289">-</span><span class="token plain">NewAosDatabaseName AxDB </span><span class="token operator" style="color:#063289">-</span><span class="token plain">NewAosDatabaseServerName new_name </span><span class="token operator" style="color:#063289">-</span><span class="token plain">NewMRDatabaseName ManagementReporter </span><span class="token operator" style="color:#063289">-</span><span class="token plain">NewAxAdminUserPassword AOSWebSite@123 </span><span class="token operator" style="color:#063289">-</span><span class="token plain">NewMRAdminUserName MRUser </span><span class="token operator" style="color:#063289">-</span><span class="token plain">NewMRAdminUserPassword MRWebSite@123 </span><span class="token operator" style="color:#063289">-</span><span class="token plain">NewMRRuntimeUserName MRUSer </span><span class="token operator" style="color:#063289">-</span><span class="token plain">NewMRRuntimeUserPassword MRWebSite@123 </span><span class="token operator" style="color:#063289">-</span><span class="token plain">NewAxMRRuntimeUserName MRUser </span><span class="token operator" style="color:#063289">-</span><span class="token plain">NewAxMRRuntimeUserPassword MRWebSite@123</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token console class-name">console</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">log</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">'Every repo must come with a mascot.'</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token class-name">CustTable</span><span class="token plain"> custTable </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> CustTable</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">find</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">serviceOrderTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">CustAccount</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token class-name">CSG_CorrigoProUpdate</span><span class="token plain"> corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">if</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">custTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">AccountNum </span><span class="token operator" style="color:#063289">==</span><span class="token plain"> serviceOrderTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">CustAccount</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token operator" style="color:#063289">&amp;&amp;</span><span class="token plain"> CSG_CorrigoProTable</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">Exist</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">custTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">CSGMasterAccount</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token operator" style="color:#063289">&amp;&amp;</span><span class="token plain"> serviceOrderTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">CSGCustomerPO </span><span class="token operator" style="color:#063289">!=</span><span class="token plain"> ''</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token operator" style="color:#063289">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">serviceOrderReason</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">StageId </span><span class="token operator" style="color:#063289">==</span><span class="token plain"> 'Started'</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token operator" style="color:#063289">||</span><span class="token plain"> serviceOrderReason</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">StageId </span><span class="token operator" style="color:#063289">==</span><span class="token plain"> 'Susp</span><span class="token operator" style="color:#063289">-</span><span class="token plain">Other'</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token operator" style="color:#063289">||</span><span class="token plain"> serviceOrderReason</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">StageId </span><span class="token operator" style="color:#063289">==</span><span class="token plain"> 'Susp</span><span class="token operator" style="color:#063289">-</span><span class="token plain">Parts'</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token operator" style="color:#063289">||</span><span class="token plain"> serviceOrderReason</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">StageId </span><span class="token operator" style="color:#063289">==</span><span class="token plain"> 'Susp</span><span class="token operator" style="color:#063289">-</span><span class="token plain">Sched'</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token operator" style="color:#063289">||</span><span class="token plain"> serviceOrderReason</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">StageId </span><span class="token operator" style="color:#063289">==</span><span class="token plain"> 'Complete'</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token operator" style="color:#063289">&amp;&amp;</span><span class="token plain"> serviceOrderReason</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Description </span><span class="token operator" style="color:#063289">!=</span><span class="token plain"> 'Travel Back'</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    ttsbegin</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">selectForUpdate</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">AccountNum </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> serviceOrderTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">CustAccount</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">CSGMasterAccount </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> custTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">CSGMasterAccount</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ServiceOrderId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> serviceOrderReason</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ServiceOrderId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">CustomerPO </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> serviceOrderTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">CSGCustomerPO</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ObjectName </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> #ObjectName</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">StageId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> serviceOrderReason</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">StageId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Progress </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> serviceOrderTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Progress</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Technician </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> HcmWorker</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">find</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">serviceOrderTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">WorkerResponsible</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">name</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:#b6ad9a">//With condition already in the custom method docuRef.Name = 'Tech Notes'</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Notes </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> DocuRef</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">csgFirstonly1Note</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">'csg'</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token number" style="color:#063289">287</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> serviceOrderTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">RecId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> 'Tech Notes'</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ServiceDateUtc </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> serviceOrderTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ServiceDateTime</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ActionDateUtc </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> serviceOrderReason</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">CSGDateTimeExecuted</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    corrigoProUpdate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">insert</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    ttscommit</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#728fcb"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="update-the-azure-storage-emulator">Update the Azure Storage Emulator<a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#update-the-azure-storage-emulator" class="hash-link" aria-label="Direct link to Update the Azure Storage Emulator" title="Direct link to Update the Azure Storage Emulator">​</a></h3>
<ul>
<li>
<p>From the Start menu, open Microsoft Azure Storage Emulator - v4.0, and run the following commands.</p>
<p><code>AzureStorageEmulator.exe start</code></p>
<blockquote>
<p>If you got an error <strong><em>Port conflict with existing application</em></strong>, please check this <a href="https://automaly.github.io/docs/operation/troubleshooting/2020-04-05-azure-storage-emulator-port-conflict-with-existing-application">post</a>.</p>
</blockquote>
</li>
<li>
<p>This command verifies that the emulator is running.</p>
<p><code>AzureStorageEmulator.exe status</code></p>
</li>
<li>
<p>Update the server name</p>
<p><code>AzureStorageEmulator.exe init -server new_name</code></p>
</li>
</ul>
<p>For more information about Azure storage emulator please follow <a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-use-emulator" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/azure/storage/common/storage-use-emulator</a></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-location-of-packages-source-code-and-other-aos-configurations">4. Location of packages, source code, and other AOS configurations<a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#4-location-of-packages-source-code-and-other-aos-configurations" class="hash-link" aria-label="Direct link to 4. Location of packages, source code, and other AOS configurations" title="Direct link to 4. Location of packages, source code, and other AOS configurations">​</a></h2>
<p>On a VM, you can find most of the application configuration by opening the web.config file of AOSWebApplication.</p>
<ol>
<li>
<p>Start IIS.</p>
</li>
<li>
<p>Go to <em>Sites &gt; AOSWebApplication</em>.</p>
</li>
<li>
<p>Right-click, and then click <strong>Explore</strong> to open File Explorer.</p>
</li>
<li>
<p>Open the <strong>web.config</strong> file in Notepad or another text editor. The following keys are of interest to many developers and administrators:</p>
<ul>
<li>
<p><strong>Aos.MetadataDirectory</strong> – This key points to the location of the packages folder that contains platform and application binaries, and also source code. (Source code is available only in development environments.) Typical values are: <code>c:\packages</code>, <code>c:\AosServicePackagesLocalDirectory</code>, and <code>J:AosServicePackagesLocalDirectory</code>.</p>
</li>
<li>
<p><strong>DataAccess.Database</strong> – This key holds the name of the database.</p>
</li>
<li>
<p><strong>Aos.AppRoot</strong> – This key points to the root folder of the Application Object Server (AOS) web application.</p>
</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5-redeploying-or-restarting-the-runtime-on-the-vm">5. Redeploying or restarting the runtime on the VM<a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#5-redeploying-or-restarting-the-runtime-on-the-vm" class="hash-link" aria-label="Direct link to 5. Redeploying or restarting the runtime on the VM" title="Direct link to 5. Redeploying or restarting the runtime on the VM">​</a></h2>
<p>To restart the local runtime and redeploy all the packages, follow these steps.</p>
<ol>
<li>
<p>Open File Explorer, and go to <code>C:\CustomerServiceUnit</code>.</p>
</li>
<li>
<p>Right-click <strong>AOSDeploy.cmd</strong>, and then click <strong>Run as administrator</strong>.</p>
</li>
</ol>
<p>This process might take a while. The process is completed when the cmd.exe window closes. If you just want to restart AOS (without redeploying the runtime), run iisreset from an administrator Command Prompt window, or restart AOSWebApplication from IIS.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6-update-to-the-latest-version">6. Update to the latest version<a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#6-update-to-the-latest-version" class="hash-link" aria-label="Direct link to 6. Update to the latest version" title="Direct link to 6. Update to the latest version">​</a></h2>
<p>Please check this <a href="https://docs.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/deployment/install-deployable-package" target="_blank" rel="noopener noreferrer">document</a> for versions 10.0.24</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="7-for-vhd-that-was-released-for-versions-10024-and-later">7. For (VHD) that was released for versions 10.0.24 and later<a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#7-for-vhd-that-was-released-for-versions-10024-and-later" class="hash-link" aria-label="Direct link to 7. For (VHD) that was released for versions 10.0.24 and later" title="Direct link to 7. For (VHD) that was released for versions 10.0.24 and later">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="71-register-a-new-application-in-azure-active-directory">7.1 Register a new application in Azure Active Directory<a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#71-register-a-new-application-in-azure-active-directory" class="hash-link" aria-label="Direct link to 7.1 Register a new application in Azure Active Directory" title="Direct link to 7.1 Register a new application in Azure Active Directory">​</a></h3>
<p>To register a new application in Microsoft Azure Active Directory (Azure AD), follow the steps outlined in <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app" target="_blank" rel="noopener noreferrer">Register app or web API</a>. The new app registration should be for a web application, and the following redirect URIs should be added:</p>
<ul>
<li><code>https://usnconeboxax1aos.cloud.onebox.dynamics.com/</code></li>
<li><code>https://usnconeboxax1aos.cloud.onebox.dynamics.com/oauth/</code></li>
</ul>
<p>Once created, make note of the <strong>Application (client) ID</strong>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="72-run-the-setup-script">7.2 Run the setup script<a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#72-run-the-setup-script" class="hash-link" aria-label="Direct link to 7.2 Run the setup script" title="Direct link to 7.2 Run the setup script">​</a></h3>
<p>After you sign in with the <strong>Administrator</strong> account, right-click the desktop shortcut <strong>Generate Self-Signed Certificates</strong>, and select <strong>Run as administrator</strong>. When the script prompts for the application ID, provide the <strong>Application (client) ID</strong> created in Azure Active Directory.</p>
<p>When the script finishes, the environment is ready for use. At this time, you can run the Admin Provisioning tool to set the administrator account, permissions, and tenant. Make sure that the email provided is for the Azure Active Directory tenant in which the application registration was created.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="8-for-vhd-that-was-released-for-versions-10039">8. For (VHD) that was released for versions 10.0.39<a href="https://automaly.github.io/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine#8-for-vhd-that-was-released-for-versions-10039" class="hash-link" aria-label="Direct link to 8. For (VHD) that was released for versions 10.0.39" title="Direct link to 8. For (VHD) that was released for versions 10.0.39">​</a></h2>
<p>You will get this error when starting the Dynamics 365 client.</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>error</div><div class="admonitionContent_BuS1"><p>AADSTS700016: Application with identifier 'b0cdba4e-ada9-4ef7-83ba-590322d2c529' was not found in the directory 'Test_Test_ContosoAX'. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You may have sent your authentication request to the wrong tenant.</p></div></div>
<p>You can locate the <strong>admin provisioning tool</strong> from <code>C:\AOSService\PackagesLocalDirectory\bin</code>, run it with admin right and polulate your email account, once it's done, you will be able to access the client.
More about <strong>admin provisioning tool</strong> <a href="https://automaly.github.io/docs/operation/tools/2022-09-18-admin-provisioning-tools">here</a>.</p>]]></content>
        <author>
            <name>Max Nguyen</name>
            <uri>/about</uri>
        </author>
        <category label="onebox vhd" term="onebox vhd"/>
        <category label="Dynamics 365 finance and operations" term="Dynamics 365 finance and operations"/>
        <category label="upgrade" term="upgrade"/>
        <category label="LCS" term="LCS"/>
        <category label="OneBox" term="OneBox"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Create Purchase Orders - Confirm - Product receipt - Post using X++ in Dynamics 365 Finance & Operations]]></title>
        <id>https://automaly.github.io/2020/01/25/create-po-confirm-receipt-post</id>
        <link href="https://automaly.github.io/2020/01/25/create-po-confirm-receipt-post"/>
        <updated>2020-01-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[The script will work for Dynamics 365 Finance & Operations version]]></summary>
        <content type="html"><![CDATA[<blockquote>
<p>The script will work for Dynamics 365 Finance &amp; Operations version</p>
</blockquote>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#faf8f5;--prism-color:#728fcb"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#728fcb"><span class="token keyword" style="color:#728fcb">class</span><span class="token plain"> </span><span class="token class-name">MaxGeneratePO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">main</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">Args</span><span class="token plain"> _args</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name keyword" style="color:#728fcb">int</span><span class="token plain"> i </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token number" style="color:#063289">0</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> </span><span class="token comment" style="color:#b6ad9a">// number of purchase orders</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">NumberSeq</span><span class="token plain"> numberSeq</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">PurchTable</span><span class="token plain"> purchTable</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">PurchLine</span><span class="token plain"> purchLine</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">InventDim</span><span class="token plain"> inventDim</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">i </span><span class="token operator" style="color:#063289">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#063289">3</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            ttsBegin</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token class-name">MaxGeneratePO</span><span class="token plain"> createPO </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">MaxGeneratePO</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            numberSeq </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> NumberSeq</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">newGetNum</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">PurchParameters</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">numRefPurchId</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            numberSeq</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">used</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> numberSeq</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">num</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">initValue</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">initFromVendTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">VendTable</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">find</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">'US</span><span class="token operator" style="color:#063289">-</span><span class="token number" style="color:#063289">101</span><span class="token plain">'</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token keyword" style="color:#728fcb">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token operator" style="color:#063289">!</span><span class="token plain">purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">validateWrite</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                </span><span class="token keyword" style="color:#728fcb">throw</span><span class="token plain"> Exception</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Error</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">insert</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            inventDim</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">clear</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">clear</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">initValue</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ItemId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> 'D0002'</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            inventDim</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">InventSiteId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"1"</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            inventDim</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">InventLocationId </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"11"</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">InventDimId</span><span class="token operator" style="color:#063289">=</span><span class="token plain">InventDim</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">findOrCreate</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">inventDim</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">inventDimId </span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">createLine</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchQty </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token number" style="color:#063289">5</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchUnit </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">"ea"</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchPrice </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> createPO</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">randomAmount</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> </span><span class="token comment" style="color:#b6ad9a">// get random amount nubmer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">LineAmount </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">calcLineAmount</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">update</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token comment" style="color:#b6ad9a">//PO confirm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token class-name">PurchFormLetter</span><span class="token plain"> purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token class-name">PurchFormLetter</span><span class="token plain"> purchFormLetterPack</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchFormLetter </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> PurchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">construct</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">DocumentStatus</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">PurchaseOrder</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">update</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">purchTable</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token function" style="color:#b29762">strFmt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"ConNum_%1"</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token function" style="color:#b29762">systemDateGet</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token named-parameter punctuation" style="color:#b6ad9a">PurchUpdate</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">All</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token named-parameter punctuation" style="color:#b6ad9a">AccountOrder</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">None</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token named-parameter punctuation" style="color:#b6ad9a">NoYes</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">No</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token named-parameter punctuation" style="color:#b6ad9a">NoYes</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">no</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token comment" style="color:#b6ad9a">//Product receipt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            createPO</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">proceed</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">ItemId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain">purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">InventDimId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain">purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchQty</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token function" style="color:#b29762">strFmt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"RptNum_%1"</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token comment" style="color:#b6ad9a">//Post PO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            createPO</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">postPOInvoice</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token function" style="color:#b29762">strFmt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"RptNum_%1"</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token function" style="color:#b29762">info</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">strFmt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"Purchase order '%1' has been created"</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> purchTable</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            ttsCommit</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            i</span><span class="token operator" style="color:#063289">++</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name">boolean</span><span class="token plain"> </span><span class="token function" style="color:#b29762">proceed</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">PurchId</span><span class="token plain"> _purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">ItemId</span><span class="token plain"> _itemId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token class-name">inventDimId</span><span class="token plain"> _inventDimId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">PurchQty</span><span class="token plain"> _qty</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">PackingSlipId</span><span class="token plain"> _productReceiptNumber</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">generateProductReceipt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">this</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">addToPurchLineList</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _itemId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _inventDimId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _qty</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _productReceiptNumber</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name">boolean</span><span class="token plain"> </span><span class="token function" style="color:#b29762">generateProductReceipt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">PurchId</span><span class="token plain"> _purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token plain"> _purchLineList</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">PackingSlipId</span><span class="token plain"> _productReceiptNumber</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">boolean</span><span class="token plain"> ret </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">PurchFormLetter</span><span class="token plain"> purchFromLetter</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">PurchTable</span><span class="token plain"> purchTable </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> PurchTable</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">find</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_purchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">try</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            ttsbegin</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchFromLetter </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> PurchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">construct</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">DocumentStatus</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">PackingSlip</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchFromLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">createFromLines</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchFromLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">parmLineList</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_purchLineList</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">pack</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchFromLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">update</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">purchTable</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _productReceiptNumber</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token named-parameter punctuation" style="color:#b6ad9a">DateTimeUtil</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">getToday</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">DateTimeUtil</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">getUserPreferredTimeZone</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                                </span><span class="token named-parameter punctuation" style="color:#b6ad9a">PurchUpdate</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">All</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            ttscommit</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">catch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            ret </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">false</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">return</span><span class="token plain"> ret</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name">List</span><span class="token plain"> </span><span class="token function" style="color:#b29762">addToPurchLineList</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">PurchId</span><span class="token plain"> _purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">ItemId</span><span class="token plain"> _itemId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token class-name">inventDimId</span><span class="token plain"> _inventDimId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">PurchQty</span><span class="token plain"> _qty</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">List</span><span class="token plain"> purchLineList </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">List</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">Types</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Record</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">PurchLine</span><span class="token plain"> purchLine </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> PurchLine</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">findItemIdInventDimId</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">_purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _itemId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> _inventDimId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">if</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">purchLine </span><span class="token operator" style="color:#063289">&amp;&amp;</span><span class="token plain"> _qty </span><span class="token operator" style="color:#063289">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#063289">0</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLine</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchReceivedNow </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> _qty</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchline</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">modifiedField</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">fieldNum</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">PurchLine</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> PurchReceivedNow</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            purchLineList</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">addEnd</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">purchLine</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">return</span><span class="token plain"> purchLineList</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">void</span><span class="token plain"> </span><span class="token function" style="color:#b29762">postPOInvoice</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token class-name">PurchId</span><span class="token plain"> purchId</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token class-name">PackingSlipId</span><span class="token plain"> packingSlipId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">TmpFrmVirtual</span><span class="token plain">               tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">PurchFormLetter_Invoice</span><span class="token plain">     purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">VendPackingSlipJour</span><span class="token plain">         vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">SysQueryRun</span><span class="token plain">                 chooseLinesQuery</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">SysQueryRun</span><span class="token plain">                 chooseLinesPendingInvoiceQuery</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">container</span><span class="token plain">                   conTmpFrmVirtual</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">List</span><span class="token plain">                        selectedList    </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">List</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">Types</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Record</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">select</span><span class="token plain"> firstonly vendPackingSlipJour</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">                    </span><span class="token keyword" style="color:#728fcb">where</span><span class="token plain"> </span><span class="token class-name">vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId </span><span class="token operator" style="color:#063289">==</span><span class="token plain"> purchId</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            </span><span class="token operator" style="color:#063289">&amp;&amp;</span><span class="token plain"> vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PackingSlipId </span><span class="token operator" style="color:#063289">==</span><span class="token plain"> packingSlipId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">clear</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">TableNum  </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">TableId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">RecordNo  </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">RecId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">NoYes     </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> NoYes</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Yes</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">Id        </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> vendPackingSlipJour</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">insert</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        chooseLinesQuery </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">SysQueryRun</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">queryStr</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">PurchUpdate</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        chooseLinesQuery</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">query</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">addDataSource</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">tableNum</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">VendInvoiceInfoTable</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">enabled</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token boolean" style="color:#728fcb">false</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token comment" style="color:#b6ad9a">// chooseLinesPendingInvoiceQuery needs to be initialized, although it will not be used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        chooseLinesPendingInvoiceQuery </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">SysQueryRun</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">queryStr</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">PurchUpdatePendingInvoice</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        chooseLinesPendingInvoiceQuery</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">query</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">dataSourceTable</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">tableNum</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">PurchTable</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">addRange</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">fieldNum</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">PurchTable</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token keyword" style="color:#728fcb">value</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">queryValue</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">''</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">           </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> PurchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">construct</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">DocumentStatus</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Invoice</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">chooseLinesQuery </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">chooseLinesQuery</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">parmQueryChooseLinesPendingInvoice</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">chooseLinesPendingInvoiceQuery</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">purchTable </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">PurchTable</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">find</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">PurchId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">transDate </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">systemDateGet</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">parmParmTableNum </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token function" style="color:#b29762">strFmt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">"%1"</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain">packingSlipId</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"> </span><span class="token comment" style="color:#b6ad9a">//This is invoice number</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">printFormLetter </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">NoYes</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">No</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">sumBy </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">AccountOrder</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">Auto</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token plain">specQty </span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token named-parameter punctuation" style="color:#b6ad9a">PurchUpdate</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token plain">PackingSlip</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">      </span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">while</span><span class="token plain"> </span><span class="token keyword" style="color:#728fcb">select</span><span class="token plain"> tmpFrmVirtualVend</span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            selectedList</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">addEnd</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">tmpFrmVirtualVend</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">            conTmpFrmVirtual </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> selectedList</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">pack</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">selectFromJournal</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">conTmpFrmVirtual</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">reArrangeNow</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token boolean" style="color:#728fcb">true</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        purchFormLetter</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">run</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token keyword" style="color:#728fcb">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#728fcb">int</span><span class="token plain"> </span><span class="token function" style="color:#b29762">randomAmount</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token class-name">RandomGenerate</span><span class="token plain"> randomGenerate</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        randomGenerate </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> RandomGenerate</span><span class="token punctuation" style="color:#b6ad9a">::</span><span class="token function" style="color:#b29762">construct</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        randomGenerate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">parmSeed</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token keyword" style="color:#728fcb">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">Random</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">nextInt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">        </span><span class="token keyword" style="color:#728fcb">return</span><span class="token plain"> RandomGenerate</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token function" style="color:#b29762">randomInt</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token number" style="color:#063289">100</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token number" style="color:#063289">800</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain">    </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Thank you for reading.</p>]]></content>
        <author>
            <name>Max Nguyen</name>
            <uri>/about</uri>
        </author>
        <category label="Create Purchase order X++" term="Create Purchase order X++"/>
        <category label="Coding" term="Coding"/>
        <category label="integration" term="integration"/>
    </entry>
</feed>