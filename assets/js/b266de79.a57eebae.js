"use strict";(self.webpackChunknuxulutest=self.webpackChunknuxulutest||[]).push([[3518],{34369:e=>{e.exports=JSON.parse('{"archive":{"blogPosts":[{"id":"/2024/05/11/truncate-a-table-Xpp","metadata":{"permalink":"/2024/05/11/truncate-a-table-Xpp","source":"@site/blog/2024-05-11-truncate-a-table-Xpp.mdx","title":"Truncate a table using X++","description":"We can use the tableTruncate method from SqlDataDictionary to truncate a table in FinOps, useful for a huge SQL table.","date":"2024-05-11T00:00:00.000Z","tags":[{"inline":true,"label":"xpp","permalink":"/tags/xpp"},{"inline":true,"label":"Development","permalink":"/tags/development"}],"readingTime":0.19666666666666666,"hasTruncateMarker":false,"authors":[{"name":"Max Nguyen","title":"FinOps Ranger","url":"/about","imageURL":"https://github.com/Dynamics365.png","key":"max","page":null}],"frontMatter":{"date":"2024-05-11","title":"Truncate a table using X++","categories":["xpp"],"tags":["xpp","Development"],"authors":"max"},"unlisted":false,"lastUpdatedAt":1719470948000,"lastUpdatedBy":"Dynamics365","nextItem":{"title":"SQL cheatsheet","permalink":"/2024/05/12/sql-cheat-sheet"}},"content":"We can use the `tableTruncate` method from `SqlDataDictionary` to truncate a table in FinOps, useful for a huge SQL table.\\n\\n```cs\\npublic static void main(Args _args)\\n{\\n    DictTable dictTable = new DictTable(tablenum(KA_TBYTDStaging));\\n \\n    if (dictTable && dictTable.enabled())\\n    {\\n        str sqlTableName = dictTable.name(DbBackend::Sql);\\n        SqlDataDictionary sqlTable = new SqlDataDictionary();\\n \\n        if (sqlTable.tableExist(sqlTableName))\\n        {\\n            new SqlDataDictionaryPermission(methodstr(SqlDataDictionary, tableTruncate)).assert();\\n            sqlTable.tableTruncate(tablenum(KA_TBYTDStaging), false);\\n            CodeAccessPermission::revertAssert();\\n        }\\n    }\\n}\\n```"},{"id":"/2024/05/12/sql-cheat-sheet","metadata":{"permalink":"/2024/05/12/sql-cheat-sheet","source":"@site/blog/2024-05-12-sql-cheat-sheet.mdx","title":"SQL cheatsheet","description":"SQL Datatype","date":"2024-05-11T00:00:00.000Z","tags":[{"inline":true,"label":"SQL","permalink":"/tags/sql"},{"inline":true,"label":"cheatsheet","permalink":"/tags/cheatsheet"}],"readingTime":2.0833333333333335,"hasTruncateMarker":false,"authors":[{"name":"Max Nguyen","title":"FinOps Ranger","url":"/about","imageURL":"https://github.com/Dynamics365.png","key":"max","page":null}],"frontMatter":{"date":"2024-05-11","title":"SQL cheatsheet","categories":["cheatsheet"],"tags":["SQL","cheatsheet"],"authors":"max"},"unlisted":false,"lastUpdatedAt":1726432998000,"lastUpdatedBy":"Max Nguyen","prevItem":{"title":"Truncate a table using X++","permalink":"/2024/05/11/truncate-a-table-Xpp"},"nextItem":{"title":"SqlPackage - The Element or Annotation class SqlStatistic does not contain the Property class AutoDrop","permalink":"/2024/05/05/Import-a-bacpac-file-into-a-Tier1-environment"}},"content":"## SQL Datatype\\n|             \\t| SQL Datatype    \\t| Description                                                                                                                                                                \\t|\\n|:-----------:\\t|-----------------\\t|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\t|\\n|    String   \\t| CHAR(size)      \\t| A fixed-length string containing numbers, letters or special characters.   Length may vary from 0-255.                                                                     \\t|\\n|             \\t| VARCHAR(size)   \\t| Variable-length string where the length may vary from 0-65535. Similar to   CHAR.                                                                                          \\t|\\n|             \\t| TEXT(size)      \\t| Can contain a string of size up to 65536 bytes.                                                                                                                            \\t|\\n|             \\t| TINY TEXT       \\t| Can contain a string of up to 255 characters.                                                                                                                              \\t|\\n|             \\t| MEDIUM TEXT     \\t| Can contain a string of up to 16777215 characters.                                                                                                                         \\t|\\n|             \\t| LONG TEXT       \\t| Can contain a string of up to 4294967295 characters.                                                                                                                       \\t|\\n|             \\t| BINARY(size)    \\t| Similar to CHAR() but stores binary byte strings.                                                                                                                          \\t|\\n|             \\t| VARBINARY(size) \\t| Similar to VARCHAR() but stores binary byte strings.                                                                                                                       \\t|\\n|             \\t| BLOB(size)      \\t| Holds blobs up to 65536 bytes.                                                                                                                                             \\t|\\n|             \\t| TINYBLOB        \\t| It is used for Binary Large Objects and has a maximum size of 255bytes.                                                                                                    \\t|\\n|             \\t| MEDIUMBLOB      \\t| Holds blobs up to 16777215 bytes.                                                                                                                                          \\t|\\n|             \\t| LONGBLOB        \\t| Holds blobs up to 4294967295 bytes.                                                                                                                                        \\t|\\n|             \\t|                 \\t|                                                                                                                                                                            \\t|\\n|   Numberic  \\t| BIT(size)       \\t| Bit-value type, where size varies from 1 to 64. Default value: 1                                                                                                           \\t|\\n|             \\t| INT(size)       \\t| Integer with values in the signed range of -2147483648 to 2147483647 and   values in the unsigned range of 0 to 4294967295.                                                \\t|\\n|             \\t| TINYINT(size)   \\t| Integer with values in the signed range of -128 to 127 and values in the   unsigned range of 0 to 255.                                                                     \\t|\\n|             \\t| SMALLINT(size)  \\t| Integer with values in the signed range of -32768 to 32767 and values in   the unsigned range of 0 to 65535.                                                               \\t|\\n|             \\t| MEDIUMINT(size) \\t| Integer with values in the signed range of -8388608 to 8388607 and values   in the unsigned range of 0 to 16777215.                                                        \\t|\\n|             \\t| BIGINT(size)    \\t| Integer with values in the signed range of 9223372036854775808 to   9223372036854775807 and values in the unsigned range of 0 to   18446744073709551615.                   \\t|\\n|             \\t| BOOLEAN         \\t| Boolean values where 0 is considered as FALSE and non-zero values are   considered TRUE.                                                                                   \\t|\\n|             \\t| FLOAT (p)       \\t| The floating-point number is stored. If the precision parameter is set   between 0 to 24, the type is FLOAT() else if it lies between 25 to 53, the   datatype is DOUBLE() \\t|\\n|             \\t|                 \\t|                                                                                                                                                                            \\t|\\n| Date & Time \\t| DATE            \\t| Stores date in YYYY-MM-DD format with dates in the range of \'1000-01-01\'   to \'9999-12-31\'.                                                                                \\t|\\n|             \\t| TIME(fsp)       \\t| Stores time in hh:mm:ss format with times in the range of \'-838:59:59\' to   \'838:59:59\'.                                                                                   \\t|\\n|             \\t| DATETIME(fsp)   \\t| Stores a combination of date and time in YYYY-MM-DD and hh:mm:ss format,   with values in the range of \'1000-01-01 00:00:00\' to \'9999-12-31 23:59:59\'.                     \\t|\\n|             \\t| TIMESTAMP(fsp)  \\t| It stores values relative to the UnixEpoch, basically a Unix Timestamp.   Values lie in the range of \'1970-01-01 00:00:01\' UTC to \'2038-01-09 03:14:07\'   UTC.             \\t|\\n|             \\t| YEAR            \\t| Stores values of years as a 4digit number format, with a range lying   between -1901 to 2155.                                                                              \\t|\\n\\n## SQL Command\\n\\n```mermaid\\nmindmap\\n  root[SQL Command]\\n    id[Data Definition<br/> Language]\\n      CREATE\\n      DROP\\n      ALTER\\n      TRUNCATE\\n    id[Data Manipulation Language]\\n      INSERT\\n      UPDATE\\n      DELETE\\n    [Transaction Control Language]\\n      COMMIT\\n      ROLLBACK\\n      SAVEPOINT\\n    [Data Query Language]\\n     SELECT\\n    [Data Control Language]\\n     Grant\\n     Revoke\\n```\\n\\n## SQL Constraints\\n\\n    * `NOT NULL`: Specifies that this column cannot store a NULL value.\\n```sql\\nCREATE TABLE student\\n  (\\n     id      INT(8) NOT NULL,\\n     name    VARCHAR(30) NOT NULL,\\n     address VARCHAR(50)\\n  ); \\n```\\n\\n    * `UNIQUE`: Specifies that this column can have only Unique values, i.e the values cannot be repeated in the column.\\n\\n```sql\\nCREATE TABLE Student\\n(\\nID int(8) UNIQUE,\\nNAME varchar(10) NOT NULL,\\nADDRESS varchar(20)\\n);\\n```"},{"id":"/2024/05/05/Import-a-bacpac-file-into-a-Tier1-environment","metadata":{"permalink":"/2024/05/05/Import-a-bacpac-file-into-a-Tier1-environment","source":"@site/blog/2024-05-05-Import-a-bacpac-file-into-a-Tier1-environment/index.md","title":"SqlPackage - The Element or Annotation class SqlStatistic does not contain the Property class AutoDrop","description":"If you are using d365fo.tools to Import a bacpac file into a Tier1 environment and you got an error","date":"2024-05-05T00:00:00.000Z","tags":[{"inline":true,"label":"SqlPackage","permalink":"/tags/sql-package"},{"inline":true,"label":"troubleshoot","permalink":"/tags/troubleshoot"}],"readingTime":0.3433333333333333,"hasTruncateMarker":false,"authors":[{"name":"Max Nguyen","title":"FinOps Ranger","url":"/about","imageURL":"https://github.com/Dynamics365.png","key":"max","page":null}],"frontMatter":{"date":"2024-05-05","title":"SqlPackage - The Element or Annotation class SqlStatistic does not contain the Property class AutoDrop","categories":["d365fo.tools"],"tags":["SqlPackage","troubleshoot"],"authors":"max"},"unlisted":false,"lastUpdatedAt":1714883722000,"lastUpdatedBy":"Dynamics365","prevItem":{"title":"SQL cheatsheet","permalink":"/2024/05/12/sql-cheat-sheet"},"nextItem":{"title":"Self-Update to latest quality update","permalink":"/2024/05/02/Self-Update-to-latest-quality-update"}},"content":"If you are using [d365fo.tools](https://github.com/d365collaborative/d365fo.tools) to [Import a bacpac file into a Tier1 environment](https://github.com/d365collaborative/d365fo.tools/wiki/How-To-Import-Bacpac-Into-Tier1) and you got an error\\n\\n:::danger Error output was\\n*Error importing database:An error occurred during deployment plan generation. Deployment cannot continue. The Element or Annotation class SqlStatistic does not contain the Property class AutoDrop.*\\n:::\\n\\nThe d365fo.tools use `Invoke-D365InstallSqlPackage` to install SqlPackage, but its version is not up to date, compare to the bacpac files generated from LCS database export.\\nTo solve the issue, we need to downlaod [the latest version as a zip file](https://learn.microsoft.com/en-us/sql/tools/sqlpackage/sqlpackage-download?view=sql-server-ver16#installation-file-download-alternative), unblock, unzip and replace files in the SqlPackage folder `C:\\\\Temp\\\\d365fo.tools\\\\SqlPackage` with the new version."},{"id":"/2024/05/02/Self-Update-to-latest-quality-update","metadata":{"permalink":"/2024/05/02/Self-Update-to-latest-quality-update","source":"@site/blog/2024-05-02-Self-Update-to-latest-quality-update/index.md","title":"Self-Update to latest quality update","description":"1. Login to LCS \u2013 and select the F&O environment that is enabled for Synapse Link","date":"2024-05-02T00:00:00.000Z","tags":[{"inline":true,"label":"Self-Update","permalink":"/tags/self-update"}],"readingTime":1.05,"hasTruncateMarker":false,"authors":[{"name":"Max Nguyen","title":"FinOps Ranger","url":"/about","imageURL":"https://github.com/Dynamics365.png","key":"max","page":null}],"frontMatter":{"date":"2024-05-02","title":"Self-Update to latest quality update","categories":["Update"],"tags":["Self-Update"],"authors":"max"},"unlisted":false,"lastUpdatedAt":1714883722000,"lastUpdatedBy":"Dynamics365","prevItem":{"title":"SqlPackage - The Element or Annotation class SqlStatistic does not contain the Property class AutoDrop","permalink":"/2024/05/05/Import-a-bacpac-file-into-a-Tier1-environment"},"nextItem":{"title":"Throw behaviour in X++","permalink":"/2024/01/07/ThrowBehaviour"}},"content":"1. Login to LCS \u2013 and select the F&O environment that is enabled for Synapse Link\\n2. Validate the platform version of the environment under Environment version information as shown bellow.\\n\\n![Platform version](2024-05-04_16h10_59.png)\\n\\n3. If the platform version of your environment is lower than corresponding rows bellow \u2013 for example above environment platform version is 7.0.7036.113 and required version is 7.0.7036.133 or Higher. The above environment must be updated to the latest quality update.\\n\\n| Application   (Platform) \\t| Required platform version \\t| PQU schedule                                                  \\t|\\n|--------------------------\\t|---------------------------\\t|---------------------------------------------------------------\\t|\\n| 10.0.36 (PU 60)          \\t| 7.0.7036.133 or Higher    \\t| 10.0.36 PQU-3     (January 22, 2023 to February 25, 2024) \\t|\\n| 10.0.37 (PU 61)        \\t| 7.0.7068.109   or Higher  \\t| 10.0.37 PQU-2     January 8, 2024 to February 11, 2024    \\t|\\n| 10.0.38 (PU 62)          \\t| 7.0.7120.59 or   Higher   \\t|                                                               \\t|\\n\\n4. There are two ways to update the F&O environment with quality update. Self-update using the latest quality update and second wait for the PQU (Proactive quality update) to be pushed to your environment by Microsoft\\n\\n5. Above table list out the PQU schedule when your environment will receive the PQU, based on the PQU schedule [Release schedule for PQU](https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/get-started/quality-updates-schedule?context=%2Fdynamics365%2Fcontext%2Fcommerce#high-level-pqu-train-schedule)\\n\\n6. Customer can also self-update the environment by self-applying the latest quality update instead of waiting for PQU, follow the steps bellow to self-update to latest quality update [Reference documentation](https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/migration-upgrade/download-hotfix-lcs#finance-and-operations-apps)\\n   \\n    * In the LCS environment page, go to Available updates section and click on view update.\\n    ![alt text](2024-05-04_16h20_36.png)\\n    * Click on save package.\\n    ![alt text](2024-05-04_16h21_13.png)\\n    * Click on Save package, on the Save package to asset library dialog opens, give a name and click on Save package. This action will save the latest cumulative version to your LCS project Asset library.\\n    ![alt text](image.png)\\n    * Follow the steps to apply update to cloud environment [Apply updates to cloud environments - Finance & Operations | Dynamics 365 | Microsoft Learn](https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/deployment/apply-deployable-package-system?context=%2Fdynamics365%2Fcontext%2Fcommerce#apply-a-package-to-a-non-production-environment-by-using-lcs)"},{"id":"/2024/01/07/ThrowBehaviour","metadata":{"permalink":"/2024/01/07/ThrowBehaviour","source":"@site/blog/2024-01-07-ThrowBehaviour/index.md","title":"Throw behaviour in X++","description":"References","date":"2024-01-07T00:00:00.000Z","tags":[{"inline":true,"label":"throw","permalink":"/tags/throw"},{"inline":true,"label":"error","permalink":"/tags/error"}],"readingTime":2.3866666666666667,"hasTruncateMarker":true,"authors":[{"name":"Kome Hoang","title":"Maintainer of Automaly","url":"https://www.linkedin.com/in/khahgm7","imageURL":"https://github.com/khahgm7.png","key":"kome","page":null}],"frontMatter":{"date":"2024-01-07","title":"Throw behaviour in X++","categories":["X++"],"tags":["throw","error"],"authors":"kome"},"unlisted":false,"lastUpdatedAt":1704706993000,"lastUpdatedBy":"Dynamics365","prevItem":{"title":"Self-Update to latest quality update","permalink":"/2024/05/02/Self-Update-to-latest-quality-update"},"nextItem":{"title":"Using XppPrePostArgs to pass parameters through a method","permalink":"/2024/01/02/TrickXppPrePostArg"}},"content":"## References\\n\\n- [X++ exception handling](https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/dev-ref/xpp-exceptions)\\n\\n## How to\\n\\n### Prerequisite\\n\\nFor the purpose of testing, I had this data set of CustGroup. This can also be found on Legal Entity ```USRT``` of demo data comes with a new environment of Dynamics 365 Finance.\\n\\n| Customer group | Description |\\n|----------------|-------------|\\n| 10 | Wholesale customers|\\n| 20 | Major customers|\\n| 30 | Retail customers|\\n| 40 | Internet customers|\\n| 50 | Employees|\\n| 80 | Wholesale customers|\\n| 90 | Wholesale customers|\\n\\nI added two new buttons on ```CustGroup``` form:\\n\\n- ```Bulk update Desc```: This button will loop through each and all records in the above table and update the Description to Description + ```+ Updated``` except one containing \\"Employee\\". They will become like below.\\n\\n| Customer group | Description |\\n|----------------|-------------|\\n| 10 | Wholesale customers + Updated|\\n| 20 | Major customers + Updated|\\n| 30 | Retail customers + Updated|\\n| 40 | Internet customers + Updated|\\n| 50 | Employees|\\n| 80 | Wholesale customers + Updated|\\n| 90 | Wholesale customers + Updated|\\n\\n- ```Reverse Bulk update Desc```: This button will update all Description back to its original by removing the word ```+ Updated```.\\n\\n### Let\'s do it\\n\\n### When we don\'t use ```throw```\\n\\nIn the extension class named ```CustGroup_ButtonHandlers```, I put these codes which will handle the event of clicking those two buttons.\\n\\n:::tip\\nThis type of ```FormControlEventHandler``` will only be needed when you are extending a standard form. For a totally custom form, you can add a [Clicked() method](https://learn.microsoft.com/en-us/dotnet/api/dynamics.ax.application.formbuttoncontrol.clicked) method for any buttons on the form. \\n:::\\n\\n\x3c!-- truncate --\x3e\\n\\n```cs\\ninternal final class CustGroup_ButtonHandlers\\n{\\n    [FormControlEventHandler(formControlStr(CustGroup, BulkUpdateDesc), FormControlEventType::Clicked)]\\n    public static void BulkUpdateDesc_OnClicked(FormControl sender, FormControlEventArgs e)\\n    {\\n        FormDataSource custGroupDS = sender.formRun().dataSource(formDataSourceStr(CustGroup, CustGroup));\\n        \\n        ttsbegin;\\n\\n        for(\\n            CustGroup custGroup =\\n                custGroupDS.getFirst() ?\\n                custGroupDS.getFirst() :\\n                custGroupDS.cursor()\\n            ; custGroup\\n            ; custGroup = custGroupDS.getNext()\\n        )\\n        {\\n            if(strContains(custGroup.Name, \\"Employees\\"))\\n            {\\n                // Show an error here but do not stop the loop\\n                error(\\"This group\'s name contains \\\\\\"Employees\\\\\\". Operation skipped but continue until the end of loop.\\");\\n\\n                // Continue the loop by (1) skipping below code and (2) getting the next record from the DS\\n                continue;\\n            }\\n\\n            custGroup.Name = custGroup.Name + \\" + Updated\\";\\n            custGroup.doUpdate();\\n        }\\n\\n        ttscommit;\\n\\n        custGroupDS.research(true);\\n    }\\n    \\n    [FormControlEventHandler(formControlStr(CustGroup, BulkRevUpdateDesc), FormControlEventType::Clicked)]\\n    public static void BulkRevUpdateDesc_OnClicked(FormControl sender, FormControlEventArgs e)\\n    {\\n        FormDataSource custGroupDS = sender.formRun().dataSource(formDataSourceStr(CustGroup, CustGroup));\\n\\n        ttsbegin;\\n\\n        for(\\n            CustGroup custGroup =\\n                custGroupDS.getFirst() ?\\n                custGroupDS.getFirst() :\\n                custGroupDS.cursor()\\n            ; custGroup\\n            ; custGroup = custGroupDS.getNext()\\n        )\\n        {\\n            custGroup.Name = strReplace(custGroup.Name, \\" + Updated\\", \\"\\");\\n            custGroup.doUpdate();\\n        }\\n\\n        ttscommit;\\n\\n        custGroupDS.research(true);\\n    }\\n}\\n```\\n\\nNotice the part\\n\\n```cs\\nif(strContains(custGroup.Name, \\"Employees\\"))\\n{\\n    // Show an error here but do not stop the loop\\n    error(\\"This group\'s name contains \\\\\\"Employees\\\\\\". Operation skipped but continue until the end of loop.\\");\\n\\n    // Continue the loop by (1) skipping below code and (2) getting the next record from the DS\\n    continue;\\n}\\n```\\n\\nThis part will do the job of updating the Description of the CustGroup record. Yet, I am calling ```error``` to display a message (which is speicifed as an \\"error\\") to users.\\n\\nNow, let\'s click the ```Bulk update Desc``` button. You will see the error message and the updated description. We can tell that the loop was not stopped.\\n\\n![alt text](image.png)\\n\\n### When we use ```throw```\\n\\nLet\'s change the part mentioned above to this one. Notice that we now will use ```throw``` before ```error```.\\n\\n```cs\\nif(strContains(custGroup.Name, \\"Employees\\"))\\n{\\n    // Show an error here and break the loop\\n    throw error(\\"This group\'s name contains \\\\\\"Employees\\\\\\". Operation broken.\\");\\n\\n    // Below code line is actually never called because the throw will stop the code execution immediately\\n    continue;\\n}\\n```\\n\\nClicking ```Bulk update Desc``` will result in this.\\n\\n![alt text](image-1.png)\\n\\nYet, upon refreshing the form, we will see that no transaction within the same ```tts``` level was actually committed.\\n\\n![alt text](image-2.png)\\n\\nNow if we bring the ```tts``` inside the loop.\\n\\n```cs\\n{\\n    if(strContains(custGroup.Name, \\"Employees\\"))\\n    {\\n        // Show an error here and break the loop\\n        throw error(\\"This group\'s name contains \\\\\\"Employees\\\\\\". Operation broken.\\");\\n\\n        // Below code line is actually never called because the throw will stop the code execution immediately\\n        continue;\\n    }\\n\\n    ttsbegin;\\n\\n    custGroup.Name = custGroup.Name + \\" + Updated\\";\\n    custGroup.doUpdate();\\n\\n    ttscommit;\\n}\\n```\\n\\nUpop refreshing the form, we will see what transaction were commited and what part of the loop was broken.\\n\\n![alt text](image-3.png)\\n\\nSo, that\'s how ```throw``` works in X++."},{"id":"/2024/01/02/TrickXppPrePostArg","metadata":{"permalink":"/2024/01/02/TrickXppPrePostArg","source":"@site/blog/2024-01-02-TrickXppPrePostArg/index.md","title":"Using XppPrePostArgs to pass parameters through a method","description":"References","date":"2024-01-02T00:00:00.000Z","tags":[{"inline":true,"label":"XppPrePostArgs","permalink":"/tags/xpp-pre-post-args"}],"readingTime":1.6233333333333333,"hasTruncateMarker":true,"authors":[{"name":"Kome Hoang","title":"Maintainer of Automaly","url":"https://www.linkedin.com/in/khahgm7","imageURL":"https://github.com/khahgm7.png","key":"kome","page":null}],"frontMatter":{"date":"2024-01-02","title":"Using XppPrePostArgs to pass parameters through a method","categories":["X++"],"tags":["XppPrePostArgs"],"authors":"kome"},"unlisted":false,"lastUpdatedAt":1704706993000,"lastUpdatedBy":"Dynamics365","prevItem":{"title":"Throw behaviour in X++","permalink":"/2024/01/07/ThrowBehaviour"},"nextItem":{"title":"Using Kusto functions in Power BI datasource","permalink":"/2024/01/04/KustoVsPBI"}},"content":"## References\\n\\n- [XppPrePostArgs Class (Microsoft.Dynamics.Ax.Xpp)](https://learn.microsoft.com/en-us/dotnet/api/microsoft.dynamics.ax.xpp.xppprepostargs)\\n\\n## How to\\n\\nTake a very safe table to play around: ```CustGroup``` (Customer Group), we will see how we can utilise ```XppPrePostArgs``` here to save a parameter before the update is commited to the database and then take it out for us to execute futher logic.\\n\\n*The tricky part is that such table does not even have an ```update``` method.*\\n\\nNormally saying, if a method is available on the common, we can navigate to the design of it and copy the ```Pre-``` and ```Post-Event Handler``` from here.\\n\\n\x3c!-- truncate --\x3e\\n\\n![Alt text](image.png)\\n\\nYet, in our example here, such method - ```update``` - is not available. So, we can simply make a [Class extension](https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/extensibility/method-wrapping-coc) to wrap the ```common.update()``` method. The code can be as simple as below.\\n\\n```cs\\n[ExtensionOf(tableStr(CustGroup))]\\nfinal class CustGroup_Extension\\n{\\n    public void update()\\n    {\\n        next update();\\n    }\\n}\\n```\\n\\nWe will then take the original value of ```CustGroup.Name``` and save it to the instance of ```XppPrePostArgs```. This part will be under the ```Pre-Event``` method. The code is as below.\\n\\n```cs\\nconst static str OrigNameFld = \\"OrigName\\";\\n\\n[PreHandlerFor(classStr(CustGroup_Extension), methodStr(CustGroup_Extension, update))]\\npublic static void CustGroup_Extension_Pre_update(XppPrePostArgs args)\\n{\\n    // Get custGroup buffer\\n    // No super() has been called, so the changes have not been committed\\n    CustGroup custGroup = args.getThis();\\n\\n    // Get original value of field Name\\n    Description origName = custGroup.orig().Name;\\n\\n    // Save the value to args\\n    args.setArg(\\n        OrigNameFld\\n        , origName\\n    );\\n}\\n```\\n\\nAfter the changes are commited to the database, we will take the saved parm out and execute our logic. In this case, I will assess if the new ```CustGroup.Name``` contains ```\\"Kome\\"```, if it does, revert it back to its original value and throw message. This part will be under ```Post-Event``` method. The code is as below (I will show the whole class so we can see how the parm is passed by using ```setArg``` and ```getArg```)\\n\\n```cs\\ninternal final class CustGroup_EventHandlers\\n{\\n    const static str OrigNameFld = \\"OrigName\\";\\n\\n    [PreHandlerFor(classStr(CustGroup_Extension), methodStr(CustGroup_Extension, update))]\\n    public static void CustGroup_Extension_Pre_update(XppPrePostArgs args)\\n    {\\n        // Get custGroup buffer\\n        // No super() has been called, so the changes have not been committed\\n        CustGroup custGroup = args.getThis();\\n\\n        // Get original value of field Name\\n        Description origName = custGroup.orig().Name;\\n\\n        // Save the value to args\\n        args.setArg(\\n            OrigNameFld\\n            , origName\\n        );\\n    }\\n\\n    [PostHandlerFor(classStr(CustGroup_Extension), methodStr(CustGroup_Extension, update))]\\n    public static void CustGroup_Extension_Post_update(XppPrePostArgs args)\\n    {\\n        // Get custGroup buffer and its column Name after updated\\n        CustGroup newCustGroup = args.getThis();\\n        Description newName = newCustGroup.Name;\\n\\n        // Assess and revert\\n        if(Global::strContains(newName, \\"Kome\\"))\\n        {\\n            ttsbegin;\\n            {\\n                // Get the saved parm here and set it to the field value\\n                newCustGroup.Name = args.getArg(OrigNameFld); \\n                newCustGroup.doUpdate();\\n            }\\n            ttscommit;\\n\\n            Global::info(strFmt(\\"New description - \\\\\\"%1\\\\\\" - contains \\\\\\"Kome\\\\\\". Reverted to its original.\\", newName));\\n        }\\n    }\\n}\\n\\n```\\n\\nAnd, so, we can test it out by setting a new ```Description``` for a ```Customer group```...\\n\\n![Alt text](image-1.png)\\n\\n...upon clicking on button ```Save```, the original value will be updated and a message will be thrown.\\n\\n![Alt text](image-2.png)"},{"id":"/2024/01/04/KustoVsPBI","metadata":{"permalink":"/2024/01/04/KustoVsPBI","source":"@site/blog/2024-01-04-KustoVsPBI/index.md","title":"Using Kusto functions in Power BI datasource","description":"References","date":"2024-01-02T00:00:00.000Z","tags":[{"inline":true,"label":"Kusto","permalink":"/tags/kusto"},{"inline":true,"label":"Power BI","permalink":"/tags/power-bi"}],"readingTime":1.82,"hasTruncateMarker":true,"authors":[{"name":"Kome Hoang","title":"Maintainer of Automaly","url":"https://www.linkedin.com/in/khahgm7","imageURL":"https://github.com/khahgm7.png","key":"kome","page":null}],"frontMatter":{"date":"2024-01-02","title":"Using Kusto functions in Power BI datasource","categories":["Power BI"],"tags":["Kusto","Power BI"],"authors":"kome"},"unlisted":false,"lastUpdatedAt":1704706993000,"lastUpdatedBy":"Dynamics365","prevItem":{"title":"Using XppPrePostArgs to pass parameters through a method","permalink":"/2024/01/02/TrickXppPrePostArg"},"nextItem":{"title":"No data is inserted/modified in temporary table when processing an SRS report using Pre-process","permalink":"/2024/01/04/NoDataInTmpTableForPreProcessReport"}},"content":"## References\\n- [Use Azure Data Explorer data in Power BI](https://learn.microsoft.com/en-us/azure/data-explorer/power-bi-data-connector?tabs=web-ui)\\n- [.create function command](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/management/create-function)\\n- [Azure Data Explorer](https://dataexplorer.azure.com/home)\\n- [Kusto Query Language (KQL)](https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/)\\n\\n## How to\\n\\n### Let\'s create demo data for testing\\n\\nFor the purpose of testing and demonstrating, I will create a new table in my testing ADX cluster (everyone can create their own free cluster following [Create a free Azure Data Explorer cluster](https://learn.microsoft.com/en-us/azure/data-explorer/start-for-free-web-ui)). Let\'s call it ```UserAsset```.\\n\\nThe table will have two fields:\\n- ```User``` - type ```string```\\n- ```NumberOfLaptop``` - type ```integer```\\n\\n\x3c!-- truncate --\x3e\\n\\nThe script is as below.\\n\\n```sql\\n.create table UserAsset \\n(\\n    User: string\\n    , NumberOfLaptop: int\\n) \\n```\\n\\nThen, we will put some demo data into the table.\\n\\n```sql\\n.ingest inline into table UserAsset <|\\nMax,2\\nKome,1\\n```\\n\\nWe will have the table and its data like below.\\n\\n\\n```sql\\nUserAsset\\n| project\\n    User\\n    , NumberOfLaptop\\n    , IngestedOn = ingestion_time()\\n| order by NumberOfLaptop desc\\n```\\n\\n![Kusto table and data](image.png)\\n\\n### Get data from Azure Data Explorer (ADX) to Power BI (PBI)\\n\\nSimple enough, we then can use the very Kusto query (KQ) in PBI Desktop to get such data.\\n\\n![Add new datasource in PBID](image-1.png)\\n\\nWe can copy the query here.\\n\\n![Add query to datasource](image-2.png)\\n\\nUpon clicking OK and transform the data, we will have the data available. Notice that whole KQ will be put as plain text in the source.\\n\\n![Alt text](image-3.png)\\n\\n### Using Kusto function to simplify the process\\n\\nNow, we can create a function to get data from ADX to PBI Desktop.\\n\\n```sql\\n.create function GetDataForPBI() {\\n    UserAsset\\n    | project\\n        User\\n        , NumberOfLaptop\\n        , IngestedOn = ingestion_time()\\n    | order by NumberOfLaptop desc\\n}\\n```\\n\\n![Create function](image-4.png)\\n\\nThen, we can simply call the function from PBI to get the data instead of calling the whole query.\\n\\n![Getting data using function](image-5.png)\\n\\n### Enhacing data by altering the function\\n\\nWe can even passing parameters to the functions to alter the data. In this case, let\'s try adding some texts to User. My function would become as below:\\n- Taking a boolean input ```_addText```, it is defaulted to ```false```\\n- If ```_addText``` is true, add some text to ```User```\\n- Else, leave ```User``` as it is\\n\\n*Notice that we will need to use ```create-or-alter``` because the function is existing already.*\\n\\n```sql\\n.create-or-alter function GetDataForPBI(_addText:bool = false) {\\nUserAsset\\n| extend\\n    User = iff(\\n        _addText\\n        , strcat(\\n            User\\n            , \\"-AddedText\\"\\n        )\\n        , User\\n    )\\n| project\\n    User\\n    , NumberOfLaptop\\n    , IngestedOn = ingestion_time()\\n| order by NumberOfLaptop desc\\n}\\n```\\n\\nThen, we can call the function from PBI and add the parameter to see how the data is reflected.\\n\\n![Function with parameters](image-6.png)\\n\\nWe can even add new columns from ADX and the new data will be reflected on PBI. For example, I will add a column (with emoji) to indicate someone is owning more than one laptop.\\n\\nMy function will become as below.\\n\\n```sql\\n.create-or-alter function GetDataForPBI(_addText:bool = false) {\\n    UserAsset\\n    | extend\\n        User = iff(\\n            _addText\\n            , strcat(\\n                User\\n                , \\"-AddedText\\"\\n            )\\n            , User\\n        )\\n    | project\\n        User\\n        , NumberOfLaptop\\n        , IngestedOn = ingestion_time()\\n        , OwningMoreThanOneLaptop = iff(\\n            NumberOfLaptop > 1\\n            , \\"\ud83d\udcbb+\\"\\n            , \\"\\"\\n        )\\n    | order by NumberOfLaptop desc\\n}\\n```\\n\\nUpon refreshing the source, we can see the new column coming up.\\n\\n![New column from Kusto](image-7.png)"},{"id":"/2024/01/04/NoDataInTmpTableForPreProcessReport","metadata":{"permalink":"/2024/01/04/NoDataInTmpTableForPreProcessReport","source":"@site/blog/2024-01-04-NoDataInTmpTableForPreProcessReport/index.md","title":"No data is inserted/modified in temporary table when processing an SRS report using Pre-process","description":"References","date":"2024-01-02T00:00:00.000Z","tags":[{"inline":true,"label":"SRS","permalink":"/tags/srs"},{"inline":true,"label":"Pre-process","permalink":"/tags/pre-process"}],"readingTime":1.1766666666666667,"hasTruncateMarker":true,"authors":[{"name":"Kome Hoang","title":"Maintainer of Automaly","url":"https://www.linkedin.com/in/khahgm7","imageURL":"https://github.com/khahgm7.png","key":"kome","page":null}],"frontMatter":{"date":"2024-01-02","title":"No data is inserted/modified in temporary table when processing an SRS report using Pre-process","categories":["X++"],"tags":["SRS","Pre-process"],"authors":"kome"},"unlisted":false,"lastUpdatedAt":1704706993000,"lastUpdatedBy":"Dynamics365","prevItem":{"title":"Using Kusto functions in Power BI datasource","permalink":"/2024/01/04/KustoVsPBI"},"nextItem":{"title":"Set default model for Dynamics 365 Finance Operations project","permalink":"/2023/12/26/set-default-model-for-d365-project"}},"content":"## References\\n- [Use pre-processed RDP classes](https://learn.microsoft.com/en-us/dynamicsax-2012/appuser-itpro/tips-to-help-prevent-long-running-reports-from-timing-out#use-pre-processed-rdp-classes)\\n- [Microsoft Dynamics AX 2012 White Paper: Report Programming Model](https://www.microsoft.com/en-us/download/details.aspx?id=27725)\\n\\n## How to\\n\\nPre-process RDP has become very commonplace these days, especially to ones who work with SSRS reports on Dynamics 365 FO a lot.\\n\\nRecently, I faced an issue when no data was inserted into or modififed in my temporary table during run-time despite the fact that RDP class (and its related ones within the same framework) was executed successfully. Even debugging did not show me what was going wrong. There was simply no SQL statements in the trace that I captured.\\n\\nTurned out that I will need to take ownership of the temp table instance before manipulating any data in it.\\n\\nMy code used to be (when it did not work):\\n\\n```cs\\ninternal final class CSG_PostedServiveOrderWithoutInvDP extends SrsReportDataProviderPreProcessTempDB\\n{\\n    CSG_PostedServiveOrderWithoutInvTmp           tmpTable;\\n\\n    [SRSReportDataSetAttribute(tableStr(CSG_PostedServiveOrderWithoutInvTmp))]\\n    public CSG_PostedServiveOrderWithoutInvTmp getTmpTable()\\n    {\\n        select tmpTable;\\n        return tmpTable;\\n    }\\n\\n    public void processReport()\\n    {\\n        ttsbegin;\\n        this.populateTmpTable();\\n        ttscommit;\\n    }\\n\\n    private void populateTmpTable()\\n    {\\n        // Insert data to tmp table here.\\n    }\\n}\\n```\\n\x3c!-- truncate --\x3e\\nI would need to call out to ```SrsReportDataProviderPreProcessTempDB.takeOwnershipOfTempTable()``` to have it work.\\n\\nMy code then became:\\n\\n```cs\\ninternal final class CSG_PostedServiveOrderWithoutInvDP extends SrsReportDataProviderPreProcessTempDB\\n{\\n    CSG_PostedServiveOrderWithoutInvTmp           tmpTable;\\n\\n    [SRSReportDataSetAttribute(tableStr(CSG_PostedServiveOrderWithoutInvTmp))]\\n    public CSG_PostedServiveOrderWithoutInvTmp getTmpTable()\\n    {\\n        select tmpTable;\\n        return tmpTable;\\n    }\\n\\n    public void processReport()\\n    {\\n        ttsbegin;\\n        // Take ownership of each and all tmpTable before using them in the RDP\\n        this.takeOwnershipTmp(); \\n\\n        // Data manipulation then can be conducted without an issue\\n        this.populateTmpTable();\\n        ttscommit;\\n    }\\n\\n    private void takeOwnershipTmp()\\n    {\\n        // Take ownership of the current instance of tmpTable here\\n        this.takeOwnershipOfTempTable(tmpTable);\\n    }\\n\\n    private void populateTmpTable()\\n    {\\n        // Insert data to tmp table here.\\n    }\\n}\\n```\\n\\nThe code behind the ```SrsReportDataProviderPreProcessTempDB.takeOwnershipOfTempTable()``` is as below (for ones who might want to implement their own framework):\\n\\n```cs\\n/// <summary>\\n    /// Takes ownership of the given temp table.\\n    /// </summary>\\n    /// <param name=\\"_tempDbTable\\">\\n    /// The table to take ownership of.\\n    /// </param>\\n    public void takeOwnershipOfTempTable(Common _tempDbTable)\\n    {\\n        DictTable dictTable;\\n        TableId tableId;\\n        #SRSFramework\\n\\n        if (!this.parmUseDefaultTransactionOnly())\\n        {\\n            _tempDbTable.setConnection(this.parmUserConnection());\\n        }\\n\\n        tableId = _tempDbTable.TableId;\\n        dictTable = new DictTable(tableId);\\n        if(!dictTable)\\n        {\\n            throw error(strFmt(\\"@SYS4007193\\", tableId2name(tableId)));\\n        }\\n\\n        new ExecutePermission().assert();\\n        dictTable.callObject(#TempDBMethodName_TakeOwnership, _tempDbTable, true);\\n        CodeAccessPermission::revertAssert();\\n    }\\n```"},{"id":"/2023/12/26/set-default-model-for-d365-project","metadata":{"permalink":"/2023/12/26/set-default-model-for-d365-project","source":"@site/blog/2023-12-26-set-default-model-for-d365-project.mdx","title":"Set default model for Dynamics 365 Finance Operations project","description":"Open Run","date":"2023-12-26T00:00:00.000Z","tags":[{"inline":true,"label":"Development tools","permalink":"/tags/development-tools"}],"readingTime":0.18333333333333332,"hasTruncateMarker":false,"authors":[{"name":"Max Nguyen","title":"FinOps Ranger","url":"/about","imageURL":"https://github.com/Dynamics365.png","key":"max","page":null}],"frontMatter":{"date":"2023-12-26","title":"Set default model for Dynamics 365 Finance Operations project","categories":["X++","Development tools"],"tags":["Development tools"],"authors":"max"},"unlisted":false,"lastUpdatedAt":1714883722000,"lastUpdatedBy":"Dynamics365","prevItem":{"title":"No data is inserted/modified in temporary table when processing an SRS report using Pre-process","permalink":"/2024/01/04/NoDataInTmpTableForPreProcessReport"},"nextItem":{"title":"How to hide New and Delete buttons (command buttons) in form","permalink":"/2023/12/21/How-to-hide-New-and-Delete-buttons-in-form-1"}},"content":"Open **Run**\\n\\nVS2017 and prior `%UserProfile%/Documents/Visual Studio 2015\\\\settings\\\\`\\n\\nVS2019 and later `%UserProfile%/Documents/Visual Studio Dynamics 365` \\n\\nOpen `DynamicsDevConfig.XML`, change the default model in `DefaultModelForNewProjects` property\\n\\n```XML showLineNumbers title=\\"DynamicsDevConfig.XML\\"\\n<?xml version=\\"1.0\\" encoding=\\"utf-8\\"?>\\n<DynamicsDevConfig xmlns:i=\\"http://www.w3.org/2001/XMLSchema-instance\\" xmlns=\\"http://schemas.microsoft.com/dynamics/2012/03/development/configuration\\">\\n\\t<AddInPaths xmlns:d2p1=\\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\\">\\n\\t\\t<d2p1:string>T:\\\\Bin\\\\AddInExtensions</d2p1:string>\\n\\t........\\n\\t<DBSyncInBuild>true</DBSyncInBuild>\\n\\t<DatabaseServer>localhost</DatabaseServer>\\n\\t<DefaultCompany></DefaultCompany>\\n    // highlight-next-line\\n\\t<DefaultModelForNewProjects>FleetManagement</DefaultModelForNewProjects>\\n\\t<DefaultWebBrowser>Google Chrome</DefaultWebBrowser>\\n\\t<DisableBPCheck>false</DisableBPCheck>\\n\\t<DisableFormStaticCompile>false</DisableFormStaticCompile>\\n\\t<EmitTraceEvents>true</EmitTraceEvents>\\n\\t<EnableNativeDebugging>false</EnableNativeDebugging>\\n\\t<EnableOfflineAuthentication>true</EnableOfflineAuthentication>\\n\\t<EnableSymbolLoadingForSolutionOnly>true</EnableSymbolLoadingForSolutionOnly>\\n\\t<FallbackToNativeSync>false</FallbackToNativeSync>\\n\\t.......\\n</DynamicsDevConfig>\\n```"},{"id":"/2023/12/21/How-to-hide-New-and-Delete-buttons-in-form-1","metadata":{"permalink":"/2023/12/21/How-to-hide-New-and-Delete-buttons-in-form-1","source":"@site/blog/2023-12-21-How-to-hide-New-and-Delete-buttons-in-form-1/index.md","title":"How to hide New and Delete buttons (command buttons) in form","description":"We can change the form design property Show Delete Button, Show New Button  to No.","date":"2023-12-21T00:00:00.000Z","tags":[{"inline":true,"label":"Self-Update","permalink":"/tags/self-update"},{"inline":true,"label":"quality update","permalink":"/tags/quality-update"}],"readingTime":0.21,"hasTruncateMarker":false,"authors":[{"name":"Max Nguyen","title":"FinOps Ranger","url":"/about","imageURL":"https://github.com/Dynamics365.png","key":"max","page":null}],"frontMatter":{"date":"2023-12-21","title":"How to hide New and Delete buttons (command buttons) in form","categories":["D365Update"],"tags":["Self-Update","quality update"],"authors":"max"},"unlisted":false,"lastUpdatedAt":1714883722000,"lastUpdatedBy":"Dynamics365","prevItem":{"title":"Set default model for Dynamics 365 Finance Operations project","permalink":"/2023/12/26/set-default-model-for-d365-project"},"nextItem":{"title":"How to get FinOps Azure storage blob connection string","permalink":"/2022/10/27/how-to-get-d365-azure-blob-storage-str"}},"content":"We can change the form design property `Show Delete Button`, `Show New Button`  to `No`.\\n\\n![Alt text](image.png)\\n\\nOr using X++ code in form\'s init method\\n\\n```cs\\n[Form]\\npublic class DEV_TestForm extends FormRun\\n{\\n    public void init()\\n    {\\n        this.form().design().showNewButton(0);\\n        this.form().design().showDeleteButton(0);\\n        super();\\n    }\\n}\\n```\\n\\nFor COC Extension\\n\\n```cs\\n[ExtensionOf(formStr(SMAServiceOrderTable))]\\nfinal class SMAServiceOrderTable_Form_DEV_Extension\\n{\\n    public void init()\\n    {\\n        this.form().design().showNewButton(0);\\n        this.form().design().showDeleteButton(0);\\n        next init();\\n    }\\n}\\n```"},{"id":"/2022/10/27/how-to-get-d365-azure-blob-storage-str","metadata":{"permalink":"/2022/10/27/how-to-get-d365-azure-blob-storage-str","source":"@site/blog/2022-10-27-how-to-get-d365-azure-blob-storage-str/index.md","title":"How to get FinOps Azure storage blob connection string","description":"In Dynamics 365 for Finance and Operations Azure storage is used to","date":"2022-10-27T00:00:00.000Z","tags":[{"inline":true,"label":"Azure storage connection string","permalink":"/tags/azure-storage-connection-string"}],"readingTime":0.5366666666666666,"hasTruncateMarker":false,"authors":[{"name":"Max Nguyen","title":"FinOps Ranger","url":"/about","imageURL":"https://github.com/Dynamics365.png","key":"max","page":null}],"frontMatter":{"date":"2022-10-27","title":"How to get FinOps Azure storage blob connection string","categories":["Integration","Azure"],"tags":["Azure storage connection string"],"authors":"max"},"unlisted":false,"lastUpdatedAt":1703128432000,"lastUpdatedBy":"Dynamics365","prevItem":{"title":"How to hide New and Delete buttons (command buttons) in form","permalink":"/2023/12/21/How-to-hide-New-and-Delete-buttons-in-form-1"},"nextItem":{"title":"How to skip standard code in Dynamics 365 finance and operations","permalink":"/2020/04/09/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations"}},"content":"In Dynamics 365 for Finance and Operations Azure storage is used to \\n\\n* Store files for [Attachments](https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management)\\n* [Data import and export jobs](https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/data-entities/data-import-export-job)\\n*  When FinOps prints a report via [Document Reporting Services](https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/analytics/document-reporting-services?context=%2Fdynamics365%2Fcontext%2Fcommerce), SSRS Reporting Services generates an [EMF image](https://ax.docentric.com/printing-reports-with-custom-fonts-in-dynamics-365-for-finance-and-operations/) for each page of the generated document. FinOps then temporarily saves the generated EMF files to Azure Blob storage.\\n*  [Printing archive](https://learn.microsoft.com/en-us/dynamicsax-2012/appuser-itpro/print-a-report-from-the-archive)\\n\\nAnd more!\\n\\nIf you are using tier 1 Cloud-Hosted environment, you can find the azure storage from the Azure resource group in Azure portal.\\n\\nFor tier 1, UAT tier 2, and PROD Tier 3, you can create a runnable class and execute to get the Azure storage connection string.\\n\\n```cs\\nusing Microsoft.Dynamics.Clx.ServicesWrapper;\\nclass GetAzureBlob\\n{\\n    public static void main(Args _args)\\n    {\\n        info(\'AzureStorageConnectionString = \' + CloudInfrastructure::GetCsuStorageConnectionString());\\n        info(\'ClientCertificateThumbprint = \' + CloudInfrastructure::GetCsuClientCertificateThumbprint());\\n    }\\n}\\n```\\n\\nOnce you have the connection string, you can connect it to [MS Azure Storage Explorer](https://docs.microsoft.com/en-us/azure/vs-azure-tools-storage-manage-with-storage-explorer?tabs=windows), Power Automate, or consuming in any framwork/language for integration/backup purposes."},{"id":"/2020/04/09/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations","metadata":{"permalink":"/2020/04/09/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations","source":"@site/blog/2020-04-09-How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations/index.md","title":"How to skip standard code in Dynamics 365 finance and operations","description":"Disclaimers: Try at your own risk, this is consider as a bug and it will be fixed soon.","date":"2020-04-09T00:00:00.000Z","tags":[{"inline":true,"label":"Chain of Command","permalink":"/tags/chain-of-command"},{"inline":true,"label":"Dynamics 365 finance and operations","permalink":"/tags/dynamics-365-finance-and-operations"},{"inline":true,"label":"skip standard code","permalink":"/tags/skip-standard-code"}],"readingTime":1.7133333333333334,"hasTruncateMarker":false,"authors":[{"name":"Max Nguyen","title":"FinOps Ranger","url":"/about","imageURL":"https://github.com/Dynamics365.png","key":"max","page":null}],"frontMatter":{"date":"2020-04-09T00:00:00.000Z","title":"How to skip standard code in Dynamics 365 finance and operations","tags":["Chain of Command","Dynamics 365 finance and operations","skip standard code"],"authors":"max","key":"How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations"},"unlisted":false,"lastUpdatedAt":1701636614000,"lastUpdatedBy":"Luan Nguyen","prevItem":{"title":"How to get FinOps Azure storage blob connection string","permalink":"/2022/10/27/how-to-get-d365-azure-blob-storage-str"},"nextItem":{"title":"Set up a VHD for finance and operations apps","permalink":"/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine"}},"content":":::caution\\nDisclaimers: Try at your own risk, this is consider as a bug and it will be fixed soon.\\n:::\\n\\nAccording to this MS article about Chain Of Command https://docs.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/extensibility/method-wrapping-coc#wrapper-methods-must-always-call-next\\n\\n> \\"Wrapper methods must always call next Wrapper methods in an extension class must always call next, so that the next method in the chain and, finally, the original implementation are always called. This restriction helps guarantee that every method in the chain contributes to the result. In the current implementation of this restriction, the call to next must be in the first-level statements in the method body.\\"\\n\\nSo as described in the article, the Chain Of Command in Dynamics 365 finance and operations is used to add the logic before or after a method of a class is invoked and the original method will always be executed due to the compulsory of the next statement.\\nWhen doing some implementations, we found out that there is a tricky way to completely **ignore** the execution of the original method of the class that is extended.\\n\\nPlease see below for more details:\\nFor example, I created a project and add a new runnable class named Alex:\\n\\n```cs\\nclass TestClass\\n{\\n    public static void main(Args _args)\\n    {\\n        throw error (\\"Hello World\\");\\n    }\\n}\\n```\\n\\nWhen this class runs, a _Hello World_ info message will be displayed in the FinOps UI. Then I used chain of command to create Alex_Extension class that extends this class and \\"override\\" the main method of the Alex\'s class by putting the next call into another method and never call it like this:\\n\\n```cs\\n[ExtensionOf(classStr(TestClass))]\\nfinal class Alex_Extension\\n{\\n    public static void main(Args _args)\\n    {\\n        //Implement something here\\n        info (\\"Ok\\");\\n        void ignore()\\n        {\\n            next main(_args);\\n        }\\n    }\\n}\\n```\\n\\nWhen I run the _AlexExtension_, the original main method of the Alex class will be ignored and only the additional block of code that I wrote in the _AlexExtension_ class will be executed, so only the **OK** info will appear.\\n\\nNow we will try with a sample scenario from D365 Finance and Operation. In **General Ledger** Module, we have **General journals** form\\n\\n![Image](How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations.png)\\n\\nWhen you click the button for **Journal Print**, the menu item will be triggered and point to the controller name: *LedgerJournalController* with *LedgerJournalController* class and the report will be generated.\\n\\nI will use COC to \u201coverride\u201d the main method of *LedgerJournalController* class by applying the method above:\\n\\n```cs\\n[ExtensionOf(classStr(LedgerJournalController))]\\nfinal class Alex_LedgerJournalController_Extension\\n{\\n    public static void main(Args _args)\\n    {\\n        info(\\"ok\\");\\n        void ignore_first()\\n        {\\n            next main(_args);\\n        }\\n    }\\n} \u2003\\n```\\n\\nUsing this I will ignore the the main method of *LedgerJournalController* class and instead of generate the report, the result will be only the **OK** info line in the extension class:\\n\\n![Image](How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations-1.png)\\n\\nThis is a little bit tricky because we still call next in our extension class as per the requirement of COC, but as we never call the method that \\"wrap\\" the next call so it will not be executed. You can try this to simply ignore or rewrite a method of a class in FinOps.\\n\\nThank you for reading."},{"id":"/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine","metadata":{"permalink":"/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine","source":"@site/blog/2020-04-06-getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine/index.md","title":"Set up a VHD for finance and operations apps","description":"1. Download Dynamics 365 finance and operations VHD files","date":"2020-04-06T00:00:00.000Z","tags":[{"inline":true,"label":"onebox vhd","permalink":"/tags/onebox-vhd"},{"inline":true,"label":"Dynamics 365 finance and operations","permalink":"/tags/dynamics-365-finance-and-operations"},{"inline":true,"label":"upgrade","permalink":"/tags/upgrade"},{"inline":true,"label":"LCS","permalink":"/tags/lcs"},{"inline":true,"label":"OneBox","permalink":"/tags/one-box"}],"readingTime":4.27,"hasTruncateMarker":true,"authors":[{"name":"Max Nguyen","title":"FinOps Ranger","url":"/about","imageURL":"https://github.com/Dynamics365.png","key":"max","page":null}],"frontMatter":{"date":"2020-04-06T00:00:00.000Z","last_update":{"date":"12/12/2023","author":"max"},"title":"Set up a VHD for finance and operations apps","tags":["onebox vhd","Dynamics 365 finance and operations","upgrade","LCS","OneBox"],"categories":["FinOps","Troubleshooting","Onebox"],"authors":"max"},"unlisted":false,"lastUpdatedAt":1702339200000,"lastUpdatedBy":"max","prevItem":{"title":"How to skip standard code in Dynamics 365 finance and operations","permalink":"/2020/04/09/How-to-ignore-standard-code-in-Dynamics-365-finance-and-operations"},"nextItem":{"title":"Create Purchase Orders - Confirm - Product receipt - Post using X++ in Dynamics 365 Finance & Operations","permalink":"/2020/01/25/create-po-confirm-receipt-post"}},"content":"## 1. Download Dynamics 365 finance and operations VHD files\\n\\n* Go to the LCS main page and select **Shared asset library** or go to Shared Asset Library.\\n\\n* Select the asset type **Downloadable VHD**.\\n\\n* Find the VHD you are looking for based on the desired Finance and Operation version. The VHD is divided into multiple file parts that you need to download. For example, the asset files that start with \\"VHD - 10.0.5\\" are the different files you need in order to install version 10.0.5.\\n\\n* Download all files (parts) associated with the desired VHD to a local folder.\\n\\n* After the download is complete, run the executable file that you downloaded, accept the software license agreement, and choose a file path to extract the VHD to.\\n\\n* This creates a local VHD file that you can use to run a local virtual machine.\\n\\n* Sign in to the VM by using the following credentials:\\n\\n  * User name: **Administrator**\\n  * Password: **pass@word1**\\n\x3c!--truncate--\x3e\\n* Provision the administrator user.\\n\\n:::tip\\nFor security reasons the reply URL setup for AAD was changed, The `Admin user provisioning tool` is deleted from 10.0.24 **cloud hosted** VM. More info here https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/dev-tools/access-instances#frequently-asked-questions.\\n\\nYou still have it in the VHD machine.\\n:::\\n\\n## 2. Extend the Evaluattion license\\n\\n* Run cmd with Admin right.\\n* Run `slmgr -dli` to check the current period status.\\n\\n```powershell title=\\"slmgr -dli\\"\\nName: Windows(R), ServerDatacenterEval edition\\nDescription: Windows(R) Operating System, TIMEBASED_EVAL channel\\nPartial Product Key: H6F8M\\nLicense Status: Licensed\\nTimebased activation expiration: 259199 minute(s) (180 day(s))\\n```\\n\\n* Run `slmgr \u2013rearm` to extend the evaluation period.\\n* Run `slmgr \u2013dlv` to see how many extensions do you have left. You can only extend the license a limited number of times.\\n\\n## 3. Rename VM\\n\\n:::tip Update 2023\\nFrom the VHD 10.0.29 version, the VHD name named with the version of it own, before that the computer name always **MININT-F36S5EH**. So we don\'t have to remane the VM everytime we deploy a new VHD.\\n![VHD 10.0.29](DVHD10029.png \\"VHD 10.0.29\\")\\n:::\\n\\n:::info Reference\\nhttps://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/migration-upgrade/vso-machine-renaming\\n:::\\n\\n* Rename and restart the machine before you start development or connect to Azure DevOps.\\n* Update the server name in SQL Server\\n\\n  * The default credential for SQL server is **axdbadmin** and password **AOSWebSite@12**\\n  \\nYou can also see the password (`DataAccess.AxAdminSqlPwd`) in the `C:\\\\AOSService\\\\webroot\\\\web.config`\\n\\nTo decrypt run this command:\\n\\n```powershell\\nC:\\\\AOSService\\\\webroot\\\\bin\\\\Microsoft.Dynamics.AX.Framework.ConfigEncryptor.exe -decrypt C:\\\\AOSService\\\\webroot\\\\web.config\\n```\\n\\nTo encrypt run this command:\\n\\n`C:\\\\AOSService\\\\webroot\\\\bin\\\\Microsoft.Dynamics.AX.Framework.ConfigEncryptor.exe -encrypt C:\\\\AOSService\\\\webroot\\\\web.config`\\n\\nIf you see the error\\n\\n:::danger error\\n   No certificate found for id \'7366E25DC94FA8A400FA0037FFF3BB300D9482D4\'\\n:::\\n\\nPlease follow [this step](#7-for-vhd-that-was-released-for-versions-10024-and-later) first.\\n\\n* Run following query\\n\\n    ```sql title=\\"MININT-57EHFHJ\\"\\n    sp_dropserver [old_name]\\n    sp_addserver [new_name], local\\n    ```\\n\\n\\nIn these commands, be sure to replace old_name with the old name of the server and new_name with the new name. By default, the old name is `MININT-F36S5EH`, but you can run select @@servername to get the old name. Additionally, be sure to restart the SQL Server service after the commands have finished running.\\n\\n\\n* Restart SQL service\\n\\n* Open Reporting Services Configuration Manager for SQL Server 2016, then **Select Database**, select **Change Database**, and use the new server name.\\n\\n### Update financial reporting\\n\\nGo to LCS portal and download a one version package, we will need the scripts from it. Open a Microsoft Windows PowerShell command window as an admin, and run the following command. This command contains the default passwords that might have to be updated. Be sure to replace **new_name** with the new name.\\n\\n```powershell showLineNumbers\\ncd <update folder>\\\\MROneBox\\\\Scripts\\\\Update\\\\ConfigureMRDatabase.ps1 -NewAosDatabaseName AxDB -NewAosDatabaseServerName new_name -NewMRDatabaseName ManagementReporter -NewAxAdminUserPassword AOSWebSite@123 -NewMRAdminUserName MRUser -NewMRAdminUserPassword MRWebSite@123 -NewMRRuntimeUserName MRUSer -NewMRRuntimeUserPassword MRWebSite@123 -NewAxMRRuntimeUserName MRUser -NewAxMRRuntimeUserPassword MRWebSite@123\\n```\\n\\n```js showLineNumbers\\nconsole.log(\'Every repo must come with a mascot.\');\\n```\\n\\n```csharp showLineNumbers\\nCustTable custTable = CustTable::find(serviceOrderTable.CustAccount);\\nCSG_CorrigoProUpdate corrigoProUpdate;\\n\\nif((custTable.AccountNum == serviceOrderTable.CustAccount)\\n    && CSG_CorrigoProTable::Exist(custTable.CSGMasterAccount)\\n    && serviceOrderTable.CSGCustomerPO != \'\'\\n    && ((serviceOrderReason.StageId == \'Started\'\\n    || serviceOrderReason.StageId == \'Susp-Other\'\\n    || serviceOrderReason.StageId == \'Susp-Parts\'\\n    || serviceOrderReason.StageId == \'Susp-Sched\'\\n    || serviceOrderReason.StageId == \'Complete\'))\\n    && serviceOrderReason.Description != \'Travel Back\')\\n{\\n    ttsbegin;\\n    corrigoProUpdate.selectForUpdate();\\n    corrigoProUpdate.AccountNum = serviceOrderTable.CustAccount;\\n    corrigoProUpdate.CSGMasterAccount = custTable.CSGMasterAccount;\\n    corrigoProUpdate.ServiceOrderId = serviceOrderReason.ServiceOrderId;\\n    corrigoProUpdate.CustomerPO = serviceOrderTable.CSGCustomerPO;\\n    corrigoProUpdate.ObjectName = #ObjectName;\\n    corrigoProUpdate.StageId = serviceOrderReason.StageId;\\n    corrigoProUpdate.Progress = serviceOrderTable.Progress;\\n    corrigoProUpdate.Technician = HcmWorker::find(serviceOrderTable.WorkerResponsible).name();\\n\\n    //With condition already in the custom method docuRef.Name = \'Tech Notes\'\\n    corrigoProUpdate.Notes = DocuRef::csgFirstonly1Note(\'csg\', 287, serviceOrderTable.RecId, \'Tech Notes\');\\n        \\n    corrigoProUpdate.ServiceDateUtc = serviceOrderTable.ServiceDateTime;\\n    corrigoProUpdate.ActionDateUtc = serviceOrderReason.CSGDateTimeExecuted;\\n    corrigoProUpdate.insert();\\n    ttscommit;\\n}\\n```\\n\\n### Update the Azure Storage Emulator\\n\\n* From the Start menu, open Microsoft Azure Storage Emulator - v4.0, and run the following commands.\\n\\n    ```AzureStorageEmulator.exe start```\\n\\n  > If you got an error **_Port conflict with existing application_**, please check this [post](/docs/operation/troubleshooting/2020-04-05-azure-storage-emulator-port-conflict-with-existing-application).\\n\\n* This command verifies that the emulator is running.\\n\\n    ```AzureStorageEmulator.exe status```\\n\\n* Update the server name\\n\\n    ```AzureStorageEmulator.exe init -server new_name```\\n\\nFor more information about Azure storage emulator please follow https://docs.microsoft.com/en-us/azure/storage/common/storage-use-emulator\\n\\n## 4. Location of packages, source code, and other AOS configurations\\n\\nOn a VM, you can find most of the application configuration by opening the web.config file of AOSWebApplication.\\n\\n1. Start IIS.\\n\\n2. Go to _Sites > AOSWebApplication_.\\n\\n3. Right-click, and then click **Explore** to open File Explorer.\\n\\n4. Open the **web.config** file in Notepad or another text editor. The following keys are of interest to many developers and administrators:\\n\\n    * **Aos.MetadataDirectory** \u2013 This key points to the location of the packages folder that contains platform and application binaries, and also source code. (Source code is available only in development environments.) Typical values are: `c:\\\\packages`, `c:\\\\AosServicePackagesLocalDirectory`, and `J:AosServicePackagesLocalDirectory`.\\n\\n    * **DataAccess.Database** \u2013 This key holds the name of the database.\\n\\n    * **Aos.AppRoot** \u2013 This key points to the root folder of the Application Object Server (AOS) web application.\\n\\n## 5. Redeploying or restarting the runtime on the VM\\n\\nTo restart the local runtime and redeploy all the packages, follow these steps.\\n\\n1. Open File Explorer, and go to `C:\\\\CustomerServiceUnit`.\\n\\n2. Right-click **AOSDeploy.cmd**, and then click **Run as administrator**.\\n\\nThis process might take a while. The process is completed when the cmd.exe window closes. If you just want to restart AOS (without redeploying the runtime), run iisreset from an administrator Command Prompt window, or restart AOSWebApplication from IIS.\\n\\n## 6. Update to the latest version\\n\\nPlease check this [document](https://docs.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/deployment/install-deployable-package) for versions 10.0.24\\n\\n## 7. For (VHD) that was released for versions 10.0.24 and later\\n\\n### 7.1 Register a new application in Azure Active Directory\\n\\nTo register a new application in Microsoft Azure Active Directory (Azure AD), follow the steps outlined in [Register app or web API](https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app). The new app registration should be for a web application, and the following redirect URIs should be added:\\n\\n* `https://usnconeboxax1aos.cloud.onebox.dynamics.com/`\\n* `https://usnconeboxax1aos.cloud.onebox.dynamics.com/oauth/`\\n\\nOnce created, make note of the **Application (client) ID**.\\n\\n### 7.2 Run the setup script\\n\\nAfter you sign in with the **Administrator** account, right-click the desktop shortcut **Generate Self-Signed Certificates**, and select **Run as administrator**. When the script prompts for the application ID, provide the **Application (client) ID** created in Azure Active Directory.\\n\\nWhen the script finishes, the environment is ready for use. At this time, you can run the Admin Provisioning tool to set the administrator account, permissions, and tenant. Make sure that the email provided is for the Azure Active Directory tenant in which the application registration was created.\\n\\n## 8. For (VHD) that was released for versions 10.0.39\\n\\nYou will get this error when starting the Dynamics 365 client.\\n\\n:::danger error\\nAADSTS700016: Application with identifier \'b0cdba4e-ada9-4ef7-83ba-590322d2c529\' was not found in the directory \'Test_Test_ContosoAX\'. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You may have sent your authentication request to the wrong tenant.\\n:::\\n\\nYou can locate the **admin provisioning tool** from `C:\\\\AOSService\\\\PackagesLocalDirectory\\\\bin`, run it with admin right and polulate your email account, once it\'s done, you will be able to access the client.\\nMore about **admin provisioning tool** [here](/docs/operation/tools/2022-09-18-admin-provisioning-tools)."},{"id":"/2020/01/25/create-po-confirm-receipt-post","metadata":{"permalink":"/2020/01/25/create-po-confirm-receipt-post","source":"@site/blog/2020-01-25-create-po-confirm-receipt-post/index.md","title":"Create Purchase Orders - Confirm - Product receipt - Post using X++ in Dynamics 365 Finance & Operations","description":"The script will work for Dynamics 365 Finance & Operations version","date":"2020-01-25T00:00:00.000Z","tags":[{"inline":true,"label":"Create Purchase order X++","permalink":"/tags/create-purchase-order-x"},{"inline":true,"label":"Coding","permalink":"/tags/coding"},{"inline":true,"label":"integration","permalink":"/tags/integration"}],"readingTime":1.25,"hasTruncateMarker":false,"authors":[{"name":"Max Nguyen","title":"FinOps Ranger","url":"/about","imageURL":"https://github.com/Dynamics365.png","key":"max","page":null}],"frontMatter":{"date":"2020-01-25T00:00:00.000Z","title":"Create Purchase Orders - Confirm - Product receipt - Post using X++ in Dynamics 365 Finance & Operations","tags":["Create Purchase order X++","Coding","integration"],"categories":["FinOps","XPP","Integration"],"authors":"max"},"unlisted":false,"lastUpdatedAt":1703128432000,"lastUpdatedBy":"Dynamics365","prevItem":{"title":"Set up a VHD for finance and operations apps","permalink":"/2020/04/06/getting-onebox-vhd-dynamics-365-finance-and-operations-virtual-machine"}},"content":"> The script will work for Dynamics 365 Finance & Operations version\\n\\n```cs\\nclass MaxGeneratePO\\n{\\n    public static void main(Args _args)\\n    {\\n        int i = 0; // number of purchase orders\\n        NumberSeq numberSeq;\\n        PurchTable purchTable;\\n        PurchLine purchLine;\\n        InventDim inventDim;\\n\\n        while (i <= 3)\\n        {\\n            ttsBegin;\\n            MaxGeneratePO createPO = new MaxGeneratePO();\\n            numberSeq = NumberSeq::newGetNum(PurchParameters::numRefPurchId());\\n            numberSeq.used();\\n            purchTable.PurchId = numberSeq.num();\\n            purchTable.initValue();\\n            purchTable.initFromVendTable(VendTable::find(\'US-101\'));\\n\\n            if (!purchTable.validateWrite())\\n            {\\n                throw Exception::Error;\\n            }\\n\\n            purchTable.insert();\\n            inventDim.clear();\\n            purchLine.clear();\\n            purchLine.initValue();\\n\\n            purchLine.PurchId = purchTable.PurchId;\\n            purchLine.ItemId = \'D0002\';\\n            inventDim.InventSiteId = \\"1\\";\\n            inventDim.InventLocationId = \\"11\\";\\n            purchLine.InventDimId=InventDim::findOrCreate(inventDim).inventDimId ;\\n            purchLine.createLine(true, true, true, true, true, true);\\n\\n            purchLine.PurchQty = 5;\\n            purchLine.PurchUnit = \\"ea\\";\\n            purchLine.PurchPrice = createPO.randomAmount(); // get random amount nubmer\\n            purchLine.LineAmount = purchLine.calcLineAmount();\\n            purchLine.update();\\n            \\n            //PO confirm\\n            PurchFormLetter purchFormLetter;\\n            PurchFormLetter purchFormLetterPack;\\n            purchFormLetter = PurchFormLetter::construct(DocumentStatus::PurchaseOrder);\\n            purchFormLetter.update(purchTable,\\n                                strFmt(\\"ConNum_%1\\", purchTable.PurchId),\\n                                systemDateGet(),\\n                                PurchUpdate::All,\\n                                AccountOrder::None,\\n                                NoYes::No,\\n                                NoYes::no);\\n            //Product receipt\\n            createPO.proceed(purchTable.PurchId, purchLine.ItemId,purchLine.InventDimId,purchLine.PurchQty,strFmt(\\"RptNum_%1\\", purchTable.PurchId));\\n            //Post PO\\n            createPO.postPOInvoice(purchTable.PurchId, strFmt(\\"RptNum_%1\\", purchTable.PurchId));\\n\\n            info(strFmt(\\"Purchase order \'%1\' has been created\\", purchTable.PurchId));\\n            ttsCommit;\\n            i++;\\n        }\\n    }\\n\\n    public boolean proceed(PurchId _purchId, ItemId _itemId,inventDimId _inventDimId, PurchQty _qty, PackingSlipId _productReceiptNumber)\\n    {\\n        return\\n            this.generateProductReceipt(_purchId, this.addToPurchLineList(_purchId, _itemId, _inventDimId, _qty), _productReceiptNumber);\\n    }\\n\\n    public boolean generateProductReceipt(PurchId _purchId, List _purchLineList, PackingSlipId _productReceiptNumber)\\n    {\\n        boolean ret = true;\\n        PurchFormLetter purchFromLetter;\\n        PurchTable purchTable = PurchTable::find(_purchId);\\n\\n        try\\n        {\\n            ttsbegin;\\n            purchFromLetter = PurchFormLetter::construct(DocumentStatus::PackingSlip);\\n            purchFromLetter.createFromLines(true);\\n            purchFromLetter.parmLineList(_purchLineList.pack());\\n            purchFromLetter.update(purchTable, _productReceiptNumber,\\n                                DateTimeUtil::getToday(DateTimeUtil::getUserPreferredTimeZone()),\\n                                PurchUpdate::All);\\n            ttscommit;\\n        }\\n        catch\\n        {\\n            ret = false;\\n        }\\n        return ret;\\n    }\\n\\n    public List addToPurchLineList(PurchId _purchId, ItemId _itemId,inventDimId _inventDimId, PurchQty _qty)\\n    {\\n        List purchLineList = new List(Types::Record);\\n        PurchLine purchLine = PurchLine::findItemIdInventDimId(_purchId, _itemId, _inventDimId);\\n\\n        if(purchLine && _qty > 0)\\n        {\\n            purchLine.PurchReceivedNow = _qty;\\n            purchline.modifiedField(fieldNum(PurchLine, PurchReceivedNow));\\n            purchLineList.addEnd(purchLine);\\n        }\\n        return purchLineList;\\n    }\\n\\n    public void postPOInvoice(PurchId purchId, PackingSlipId packingSlipId)\\n    {\\n        TmpFrmVirtual               tmpFrmVirtualVend;\\n        PurchFormLetter_Invoice     purchFormLetter;\\n        VendPackingSlipJour         vendPackingSlipJour;\\n        SysQueryRun                 chooseLinesQuery;\\n        SysQueryRun                 chooseLinesPendingInvoiceQuery;\\n        container                   conTmpFrmVirtual;\\n        List                        selectedList    = new List(Types::Record);\\n\\n        select firstonly vendPackingSlipJour\\n                    where vendPackingSlipJour.PurchId == purchId\\n            && vendPackingSlipJour.PackingSlipId == packingSlipId;\\n\\n        if (vendPackingSlipJour)\\n        {\\n            tmpFrmVirtualVend.clear();\\n            tmpFrmVirtualVend.TableNum  = vendPackingSlipJour.TableId;\\n            tmpFrmVirtualVend.RecordNo  = vendPackingSlipJour.RecId;\\n            tmpFrmVirtualVend.NoYes     = NoYes::Yes;\\n            tmpFrmVirtualVend.Id        = vendPackingSlipJour.PurchId;\\n            tmpFrmVirtualVend.insert();\\n        }\\n\\n        chooseLinesQuery = new SysQueryRun(queryStr(PurchUpdate));\\n        chooseLinesQuery.query().addDataSource(tableNum(VendInvoiceInfoTable)).enabled(false);\\n\\n        // chooseLinesPendingInvoiceQuery needs to be initialized, although it will not be used\\n        chooseLinesPendingInvoiceQuery = new SysQueryRun(queryStr(PurchUpdatePendingInvoice));\\n        chooseLinesPendingInvoiceQuery.query().dataSourceTable(tableNum(PurchTable)).addRange(fieldNum(PurchTable,PurchId)).value(queryValue(\'\'));\\n           \\n        purchFormLetter = PurchFormLetter::construct(DocumentStatus::Invoice);\\n        purchFormLetter.chooseLinesQuery (chooseLinesQuery);\\n        purchFormLetter.parmQueryChooseLinesPendingInvoice(chooseLinesPendingInvoiceQuery);\\n        purchFormLetter.purchTable (PurchTable::find(PurchId));\\n        purchFormLetter.transDate (systemDateGet());\\n        purchFormLetter.parmParmTableNum (strFmt(\\"%1\\",packingSlipId)); //This is invoice number\\n        purchFormLetter.printFormLetter (NoYes::No);\\n        purchFormLetter.sumBy (AccountOrder::Auto);\\n        purchFormLetter.specQty (PurchUpdate::PackingSlip);\\n      \\n        while select tmpFrmVirtualVend\\n        {\\n            selectedList.addEnd(tmpFrmVirtualVend);\\n            conTmpFrmVirtual = selectedList.pack();\\n        }\\n        purchFormLetter.selectFromJournal(conTmpFrmVirtual);\\n        purchFormLetter.reArrangeNow(true);\\n        purchFormLetter.run();\\n    }\\n\\n    public int randomAmount()\\n    {\\n        RandomGenerate randomGenerate;\\n        randomGenerate = RandomGenerate::construct();\\n        randomGenerate.parmSeed(new Random().nextInt());\\n        return RandomGenerate.randomInt(100, 800);\\n    }\\n\\n}\\n```\\n\\nThank you for reading."}]}}')}}]);